"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SYSLOG_SERVICE_NAME = exports.SyslogService = void 0;

require("source-map-support/register");

var _syslogDecoder = _interopRequireDefault(require("./transformer/syslog-decoder"));

var _constants = require("../constants");

var _baseService = require("../base-service");

const SYSLOG_SERVICE_NAME = 'com.apple.syslog_relay';
exports.SYSLOG_SERVICE_NAME = SYSLOG_SERVICE_NAME;
const START_MESSAGE = 'start';

class SyslogService extends _baseService.BaseServiceSocket {
  constructor(socketClient) {
    super(socketClient);
    this._decoder = new _syslogDecoder.default(5 * _constants.KB);

    this._socketClient.pipe(this._decoder);

    this._assignClientFailureHandlers(this._decoder);
  }

  start(onData) {
    this._decoder.on('data', onData);

    this._socketClient.write(START_MESSAGE);
  }

}

exports.SyslogService = SyslogService;
var _default = SyslogService;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zeXNsb2cvaW5kZXguanMiXSwibmFtZXMiOlsiU1lTTE9HX1NFUlZJQ0VfTkFNRSIsIlNUQVJUX01FU1NBR0UiLCJTeXNsb2dTZXJ2aWNlIiwiQmFzZVNlcnZpY2VTb2NrZXQiLCJjb25zdHJ1Y3RvciIsInNvY2tldENsaWVudCIsIl9kZWNvZGVyIiwiU3lzbG9nRGVjb2RlciIsIktCIiwiX3NvY2tldENsaWVudCIsInBpcGUiLCJfYXNzaWduQ2xpZW50RmFpbHVyZUhhbmRsZXJzIiwic3RhcnQiLCJvbkRhdGEiLCJvbiIsIndyaXRlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUlBLE1BQU1BLG1CQUFtQixHQUFHLHdCQUE1Qjs7QUFDQSxNQUFNQyxhQUFhLEdBQUcsT0FBdEI7O0FBRUEsTUFBTUMsYUFBTixTQUE0QkMsOEJBQTVCLENBQThDO0FBQzVDQyxFQUFBQSxXQUFXLENBQUVDLFlBQUYsRUFBZ0I7QUFDekIsVUFBTUEsWUFBTjtBQUVBLFNBQUtDLFFBQUwsR0FBZ0IsSUFBSUMsc0JBQUosQ0FBa0IsSUFBSUMsYUFBdEIsQ0FBaEI7O0FBQ0EsU0FBS0MsYUFBTCxDQUFtQkMsSUFBbkIsQ0FBd0IsS0FBS0osUUFBN0I7O0FBQ0EsU0FBS0ssNEJBQUwsQ0FBa0MsS0FBS0wsUUFBdkM7QUFDRDs7QUFXRE0sRUFBQUEsS0FBSyxDQUFFQyxNQUFGLEVBQVU7QUFDYixTQUFLUCxRQUFMLENBQWNRLEVBQWQsQ0FBaUIsTUFBakIsRUFBeUJELE1BQXpCOztBQUNBLFNBQUtKLGFBQUwsQ0FBbUJNLEtBQW5CLENBQXlCZCxhQUF6QjtBQUNEOztBQXJCMkM7OztlQXlCL0JDLGEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3lzbG9nRGVjb2RlciBmcm9tICcuL3RyYW5zZm9ybWVyL3N5c2xvZy1kZWNvZGVyJztcbmltcG9ydCB7IEtCIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7IEJhc2VTZXJ2aWNlU29ja2V0IH0gZnJvbSAnLi4vYmFzZS1zZXJ2aWNlJztcblxuXG4vL1dlIGp1c3QgbmVlZCB0byB3cml0ZSBhbnkgZGF0YSB0byB0aGUgY2xpZW50LiBJdCBkb2Vzbid0IG1hdHRlciB3aGF0IHdlIHNlbmRcbmNvbnN0IFNZU0xPR19TRVJWSUNFX05BTUUgPSAnY29tLmFwcGxlLnN5c2xvZ19yZWxheSc7XG5jb25zdCBTVEFSVF9NRVNTQUdFID0gJ3N0YXJ0JztcblxuY2xhc3MgU3lzbG9nU2VydmljZSBleHRlbmRzIEJhc2VTZXJ2aWNlU29ja2V0IHtcbiAgY29uc3RydWN0b3IgKHNvY2tldENsaWVudCkge1xuICAgIHN1cGVyKHNvY2tldENsaWVudCk7XG5cbiAgICB0aGlzLl9kZWNvZGVyID0gbmV3IFN5c2xvZ0RlY29kZXIoNSAqIEtCKTtcbiAgICB0aGlzLl9zb2NrZXRDbGllbnQucGlwZSh0aGlzLl9kZWNvZGVyKTtcbiAgICB0aGlzLl9hc3NpZ25DbGllbnRGYWlsdXJlSGFuZGxlcnModGhpcy5fZGVjb2Rlcik7XG4gIH1cbiAgLyoqIFRoZSBjYWxsYmFjayBmdW5jdGlvbiB3aGljaCB3aWxsIGJlIGNhbGxlZCBkdXJpbmcgbG9nIGxpc3RlbmluZ1xuICAgKiBAbmFtZSBMb2dDYWxsYmFja1xuICAgKiBAZnVuY3Rpb25cbiAgICogQHBhcmFtIHtzdHJpbmd9IGxvZyBUaGUgbG9nIHRoYXQgaXMgc2VudCBmcm9tIHRoZSBwaG9uZVxuICAqL1xuXG4gIC8qKlxuICAgKiBTdGFydCByZWNpZXZpbmcgbG9ncyBmcm9tIHRoZSBwaG9uZS4gVGhlIGNhbGxiYWNrIHdoZW4gYSBsb2cgaXMgcmVjaWV2ZWRcbiAgICogQHBhcmFtIHtMb2dDYWxsYmFja30gb25EYXRhXG4gICAqL1xuICBzdGFydCAob25EYXRhKSB7XG4gICAgdGhpcy5fZGVjb2Rlci5vbignZGF0YScsIG9uRGF0YSk7XG4gICAgdGhpcy5fc29ja2V0Q2xpZW50LndyaXRlKFNUQVJUX01FU1NBR0UpO1xuICB9XG59XG5cbmV4cG9ydCB7IFN5c2xvZ1NlcnZpY2UsIFNZU0xPR19TRVJWSUNFX05BTUUgfTtcbmV4cG9ydCBkZWZhdWx0IFN5c2xvZ1NlcnZpY2U7XG4iXSwiZmlsZSI6ImxpYi9zeXNsb2cvaW5kZXguanMiLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
