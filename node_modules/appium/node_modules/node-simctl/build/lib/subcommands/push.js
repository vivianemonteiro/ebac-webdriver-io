"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _rimraf = _interopRequireDefault(require("rimraf"));

var _uuid = require("uuid");

var _path = _interopRequireDefault(require("path"));

var _os = _interopRequireDefault(require("os"));

var _fs = _interopRequireDefault(require("fs"));

var _bluebird = _interopRequireDefault(require("bluebird"));

const commands = {};

const rimrafAsync = _bluebird.default.promisify(_rimraf.default);

const writeFileAsync = _bluebird.default.promisify(_fs.default.writeFile);

commands.pushNotification = async function pushNotification(payload) {
  const dstPath = _path.default.resolve(_os.default.tmpdir(), `${(0, _uuid.v4)()}.json`);

  try {
    await writeFileAsync(dstPath, JSON.stringify(payload), 'utf8');
    await this.exec('push', {
      args: [this.requireUdid('push'), dstPath]
    });
  } finally {
    await rimrafAsync(dstPath);
  }
};

var _default = commands;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zdWJjb21tYW5kcy9wdXNoLmpzIl0sIm5hbWVzIjpbImNvbW1hbmRzIiwicmltcmFmQXN5bmMiLCJCIiwicHJvbWlzaWZ5IiwicmltcmFmIiwid3JpdGVGaWxlQXN5bmMiLCJmcyIsIndyaXRlRmlsZSIsInB1c2hOb3RpZmljYXRpb24iLCJwYXlsb2FkIiwiZHN0UGF0aCIsInBhdGgiLCJyZXNvbHZlIiwib3MiLCJ0bXBkaXIiLCJKU09OIiwic3RyaW5naWZ5IiwiZXhlYyIsImFyZ3MiLCJyZXF1aXJlVWRpZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQSxNQUFNQSxRQUFRLEdBQUcsRUFBakI7O0FBQ0EsTUFBTUMsV0FBVyxHQUFHQyxrQkFBRUMsU0FBRixDQUFZQyxlQUFaLENBQXBCOztBQUNBLE1BQU1DLGNBQWMsR0FBR0gsa0JBQUVDLFNBQUYsQ0FBWUcsWUFBR0MsU0FBZixDQUF2Qjs7QUFzQkFQLFFBQVEsQ0FBQ1EsZ0JBQVQsR0FBNEIsZUFBZUEsZ0JBQWYsQ0FBaUNDLE9BQWpDLEVBQTBDO0FBQ3BFLFFBQU1DLE9BQU8sR0FBR0MsY0FBS0MsT0FBTCxDQUFhQyxZQUFHQyxNQUFILEVBQWIsRUFBMkIsR0FBRSxlQUFTLE9BQXRDLENBQWhCOztBQUNBLE1BQUk7QUFDRixVQUFNVCxjQUFjLENBQUNLLE9BQUQsRUFBVUssSUFBSSxDQUFDQyxTQUFMLENBQWVQLE9BQWYsQ0FBVixFQUFtQyxNQUFuQyxDQUFwQjtBQUNBLFVBQU0sS0FBS1EsSUFBTCxDQUFVLE1BQVYsRUFBa0I7QUFDdEJDLE1BQUFBLElBQUksRUFBRSxDQUFDLEtBQUtDLFdBQUwsQ0FBaUIsTUFBakIsQ0FBRCxFQUEyQlQsT0FBM0I7QUFEZ0IsS0FBbEIsQ0FBTjtBQUdELEdBTEQsU0FLVTtBQUNSLFVBQU1ULFdBQVcsQ0FBQ1MsT0FBRCxDQUFqQjtBQUNEO0FBQ0YsQ0FWRDs7ZUFZZVYsUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCByaW1yYWYgZnJvbSAncmltcmFmJztcbmltcG9ydCB7IHY0IGFzIHV1aWRWNCB9IGZyb20gJ3V1aWQnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgb3MgZnJvbSAnb3MnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcblxuY29uc3QgY29tbWFuZHMgPSB7fTtcbmNvbnN0IHJpbXJhZkFzeW5jID0gQi5wcm9taXNpZnkocmltcmFmKTtcbmNvbnN0IHdyaXRlRmlsZUFzeW5jID0gQi5wcm9taXNpZnkoZnMud3JpdGVGaWxlKTtcblxuLyoqXG4gKiBTZW5kIGEgc2ltdWxhdGVkIHB1c2ggbm90aWZpY2F0aW9uXG4gKlxuICogQHNpbmNlIFhjb2RlIDExLjQgU0RLXG4gKiBAcGFyYW0ge09iamVjdH0gcGF5bG9hZCAtIFRoZSBvYmplY3QgdGhhdCBkZXNjcmliZXMgQXBwbGUgcHVzaCBub3RpZmljYXRpb24gY29udGVudC5cbiAqIEl0IG11c3QgY29udGFpbiBhIHRvcC1sZXZlbCBcIlNpbXVsYXRvciBUYXJnZXQgQnVuZGxlXCIga2V5IHdpdGggYSBzdHJpbmcgdmFsdWUgbWF0Y2hpbmdcbiAqIHRoZSB0YXJnZXQgYXBwbGljYXRpb27igJhzIGJ1bmRsZSBpZGVudGlmaWVyIGFuZCBcImFwc1wiIGtleSB3aXRoIHZhbGlkIEFwcGxlIFB1c2ggTm90aWZpY2F0aW9uIHZhbHVlcy5cbiAqIEZvciBleGFtcGxlOlxuICoge1xuICogICBcIlNpbXVsYXRvciBUYXJnZXQgQnVuZGxlXCI6IFwiY29tLmFwcGxlLlByZWZlcmVuY2VzXCIsXG4gKiAgIFwiYXBzXCI6IHtcbiAqICAgICBcImFsZXJ0XCI6IFwiVGhpcyBpcyBhIHNpbXVsYXRlZCBub3RpZmljYXRpb24hXCIsXG4gKiAgICAgXCJiYWRnZVwiOiAzLFxuICogICAgIFwic291bmRcIjogXCJkZWZhdWx0XCJcbiAqICAgfVxuICogfVxuICogQHRocm93cyB7RXJyb3J9IGlmIHRoZSBjdXJyZW50IFNESyB2ZXJzaW9uIGRvZXMgbm90IHN1cHBvcnQgdGhlIGNvbW1hbmRcbiAqIG9yIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBwdXNoaW5nIHRoZSBub3RpZmljYXRpb25cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgYHVkaWRgIGluc3RhbmNlIHByb3BlcnR5IGlzIHVuc2V0XG4gKi9cbmNvbW1hbmRzLnB1c2hOb3RpZmljYXRpb24gPSBhc3luYyBmdW5jdGlvbiBwdXNoTm90aWZpY2F0aW9uIChwYXlsb2FkKSB7XG4gIGNvbnN0IGRzdFBhdGggPSBwYXRoLnJlc29sdmUob3MudG1wZGlyKCksIGAke3V1aWRWNCgpfS5qc29uYCk7XG4gIHRyeSB7XG4gICAgYXdhaXQgd3JpdGVGaWxlQXN5bmMoZHN0UGF0aCwgSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksICd1dGY4Jyk7XG4gICAgYXdhaXQgdGhpcy5leGVjKCdwdXNoJywge1xuICAgICAgYXJnczogW3RoaXMucmVxdWlyZVVkaWQoJ3B1c2gnKSwgZHN0UGF0aF0sXG4gICAgfSk7XG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgcmltcmFmQXN5bmMoZHN0UGF0aCk7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNvbW1hbmRzO1xuIl0sImZpbGUiOiJsaWIvc3ViY29tbWFuZHMvcHVzaC5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
