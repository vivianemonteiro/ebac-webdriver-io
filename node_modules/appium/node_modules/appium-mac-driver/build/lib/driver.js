"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.MacDriver = void 0;

require("source-map-support/register");

var _appiumBaseDriver = require("appium-base-driver");

var _appiumSupport = require("appium-support");

var _appiumForMac = require("./appium-for-mac");

var _desiredCaps = _interopRequireDefault(require("./desired-caps"));

var _logger = _interopRequireDefault(require("./logger"));

var _index = _interopRequireDefault(require("./commands/index"));

var _lodash = _interopRequireDefault(require("lodash"));

var _utils = require("./utils");

const NO_PROXY_LIST = [['GET', new RegExp('^/session/[^/]+/log/types')], ['POST', new RegExp('^/session/[^/]+/execute')], ['POST', new RegExp('^/session/[^/]+/log')]];

class MacDriver extends _appiumBaseDriver.BaseDriver {
  constructor(opts = {}, shouldValidateCaps = true) {
    super(opts, shouldValidateCaps);
    this.jwpProxyActive = false;
    this.opts.address = opts.address || _appiumForMac.DEFAULT_A4M_HOST;
    this.desiredCapConstraints = _desiredCaps.default;

    for (const [cmd, fn] of _lodash.default.toPairs(_index.default)) {
      MacDriver.prototype[cmd] = fn;
    }
  }

  async createSession(...args) {
    if (!_appiumSupport.system.isMac()) {
      throw new Error('AppiumForMac tests only run on the Mac');
    }

    try {
      let [sessionId, caps] = await super.createSession(...args);
      await this.startAppiumForMacSession();

      if (caps.app) {
        _logger.default.info(`Automatically navigating to app '${caps.app}'`);

        await this.a4mDriver.sendCommand('/url', 'POST', {
          url: caps.app
        });
      }

      return [sessionId, caps];
    } catch (e) {
      await this.deleteSession();
      throw e;
    }
  }

  async startAppiumForMacSession() {
    let a4mAppPath = this.opts.a4mAppPath;

    if (!a4mAppPath) {
      _logger.default.debug(`The path to AppiumForMac server has not been provided explicitly. ` + `Trying to autodetect it`);

      a4mAppPath = await (0, _utils.findAppPath)(_appiumForMac.A4M_APP_BUNDLE_ID);

      if (a4mAppPath) {
        _logger.default.info(`Autodetected AppiumForMac server's location at '${a4mAppPath}'`);
      } else {
        a4mAppPath = _appiumForMac.REQ_A4M_APP_PATH;

        _logger.default.info(`Cannot autodetect AppiumForMac server's location. ` + `Using the default server path at '${a4mAppPath}'. Consider ` + `providing a custom path to 'a4mAppPath' capability if such behaviour ` + `is undesired`);
      }
    }

    this.opts.a4mAppPath = a4mAppPath;

    _lodash.default.defaults(this.opts, {
      a4mHost: _appiumForMac.DEFAULT_A4M_HOST,
      a4mPort: _appiumForMac.DEFAULT_A4M_PORT
    });

    this.a4mDriver = new _appiumForMac.AppiumForMac(this.opts);
    await this.a4mDriver.start();
    await this.a4mDriver.startSession(this.caps);
    this.proxyReqRes = this.a4mDriver.proxyReqRes.bind(this.a4mDriver);
    this.jwpProxyActive = true;
  }

  async deleteSession() {
    _logger.default.debug('Deleting AppiumForMac session');

    if (this.a4mDriver && this.jwpProxyActive) {
      await this.a4mDriver.deleteSession();
      await this.a4mDriver.stop();
      this.a4mDriver = null;
    }

    this.jwpProxyActive = false;
    await super.deleteSession();
  }

  proxyActive() {
    return true;
  }

  getProxyAvoidList() {
    return NO_PROXY_LIST;
  }

  canProxy() {
    return true;
  }

  get driverData() {
    return {
      A4MPort: this.opts.port
    };
  }

}

exports.MacDriver = MacDriver;
var _default = MacDriver;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9kcml2ZXIuanMiXSwibmFtZXMiOlsiTk9fUFJPWFlfTElTVCIsIlJlZ0V4cCIsIk1hY0RyaXZlciIsIkJhc2VEcml2ZXIiLCJjb25zdHJ1Y3RvciIsIm9wdHMiLCJzaG91bGRWYWxpZGF0ZUNhcHMiLCJqd3BQcm94eUFjdGl2ZSIsImFkZHJlc3MiLCJERUZBVUxUX0E0TV9IT1NUIiwiZGVzaXJlZENhcENvbnN0cmFpbnRzIiwiY21kIiwiZm4iLCJfIiwidG9QYWlycyIsImNvbW1hbmRzIiwicHJvdG90eXBlIiwiY3JlYXRlU2Vzc2lvbiIsImFyZ3MiLCJzeXN0ZW0iLCJpc01hYyIsIkVycm9yIiwic2Vzc2lvbklkIiwiY2FwcyIsInN0YXJ0QXBwaXVtRm9yTWFjU2Vzc2lvbiIsImFwcCIsImxvZ2dlciIsImluZm8iLCJhNG1Ecml2ZXIiLCJzZW5kQ29tbWFuZCIsInVybCIsImUiLCJkZWxldGVTZXNzaW9uIiwiYTRtQXBwUGF0aCIsImRlYnVnIiwiQTRNX0FQUF9CVU5ETEVfSUQiLCJSRVFfQTRNX0FQUF9QQVRIIiwiZGVmYXVsdHMiLCJhNG1Ib3N0IiwiYTRtUG9ydCIsIkRFRkFVTFRfQTRNX1BPUlQiLCJBcHBpdW1Gb3JNYWMiLCJzdGFydCIsInN0YXJ0U2Vzc2lvbiIsInByb3h5UmVxUmVzIiwiYmluZCIsInN0b3AiLCJwcm94eUFjdGl2ZSIsImdldFByb3h5QXZvaWRMaXN0IiwiY2FuUHJveHkiLCJkcml2ZXJEYXRhIiwiQTRNUG9ydCIsInBvcnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBSUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0EsTUFBTUEsYUFBYSxHQUFHLENBQ3BCLENBQUMsS0FBRCxFQUFRLElBQUlDLE1BQUosQ0FBVywyQkFBWCxDQUFSLENBRG9CLEVBRXBCLENBQUMsTUFBRCxFQUFTLElBQUlBLE1BQUosQ0FBVyx5QkFBWCxDQUFULENBRm9CLEVBR3BCLENBQUMsTUFBRCxFQUFT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Y0FBTCxHQUFzQixJQUF0QjtBQUNEOztBQUVELFFBQU15QixhQUFOLEdBQXVCO0FBQ3JCTixvQkFBT1EsS0FBUCxDQUFhLCtCQUFiOztBQUVBLFFBQUksS0FBS04sU0FBTCxJQUFrQixLQUFLckIsY0FBM0IsRUFBMkM7QUFDekMsWUFBTSxLQUFLcUIsU0FBTCxDQUFlSSxhQUFmLEVBQU47QUFDQSxZQUFNLEtBQUtKLFNBQUwsQ0FBZWtCLElBQWYsRUFBTjtBQUNBLFdBQUtsQixTQUFMLEdBQWlCLElBQWpCO0FBQ0Q7O0FBQ0QsU0FBS3JCLGNBQUwsR0FBc0IsS0FBdEI7QUFDQSxVQUFNLE1BQU15QixhQUFOLEVBQU47QUFDRDs7QUFFRGUsRUFBQUEsV0FBVyxHQUFJO0FBRWIsV0FBTyxJQUFQO0FBQ0Q7O0FBRURDLEVBQUFBLGlCQUFpQixHQUFJO0FBQ25CLFdBQU9oRCxhQUFQO0FBQ0Q7O0FBRURpRCxFQUFBQSxRQUFRLEdBQUk7QUFFVixXQUFPLElBQVA7QUFDRDs7QUFFRCxNQUFJQyxVQUFKLEdBQWtCO0FBQ2hCLFdBQU87QUFBQ0MsTUFBQUEsT0FBTyxFQUFFLEtBQUs5QyxJQUFMLENBQVUrQztBQUFwQixLQUFQO0FBQ0Q7O0FBMUZnQzs7O2VBOEZwQmxELFMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCYXNlRHJpdmVyIH0gZnJvbSAnYXBwaXVtLWJhc2UtZHJpdmVyJztcbmltcG9ydCB7IHN5c3RlbSB9IGZyb20gJ2FwcGl1bS1zdXBwb3J0JztcbmltcG9ydCB7XG4gIEFwcGl1bUZvck1hYywgREVGQVVMVF9BNE1fSE9TVCwgQTRNX0FQUF9CVU5ETEVfSUQsXG4gIERFRkFVTFRfQTRNX1BPUlQsIFJFUV9BNE1fQVBQX1BBVEgsXG59IGZyb20gJy4vYXBwaXVtLWZvci1tYWMnO1xuaW1wb3J0IGRlc2lyZWRDYXBDb25zdHJhaW50cyBmcm9tICcuL2Rlc2lyZWQtY2Fwcyc7XG5pbXBvcnQgbG9nZ2VyIGZyb20gJy4vbG9nZ2VyJztcbmltcG9ydCBjb21tYW5kcyBmcm9tICcuL2NvbW1hbmRzL2luZGV4JztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBmaW5kQXBwUGF0aCB9IGZyb20gJy4vdXRpbHMnO1xuXG5cbmNvbnN0IE5PX1BST1hZX0xJU1QgPSBbXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2xvZy90eXBlcycpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2V4ZWN1dGUnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9sb2cnKV0sXG5dO1xuXG4vLyBBcHBpdW0gaW5zdGFudGlhdGVzIHRoaXMgY2xhc3NcbmNsYXNzIE1hY0RyaXZlciBleHRlbmRzIEJhc2VEcml2ZXIge1xuICBjb25zdHJ1Y3RvciAob3B0cyA9IHt9LCBzaG91bGRWYWxpZGF0ZUNhcHMgPSB0cnVlKSB7XG4gICAgc3VwZXIob3B0cywgc2hvdWxkVmFsaWRhdGVDYXBzKTtcbiAgICB0aGlzLmp3cFByb3h5QWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5vcHRzLmFkZHJlc3MgPSBvcHRzLmFkZHJlc3MgfHwgREVGQVVMVF9BNE1fSE9TVDtcblxuICAgIHRoaXMuZGVzaXJlZENhcENvbnN0cmFpbnRzID0gZGVzaXJlZENhcENvbnN0cmFpbnRzO1xuXG4gICAgZm9yIChjb25zdCBbY21kLCBmbl0gb2YgXy50b1BhaXJzKGNvbW1hbmRzKSkge1xuICAgICAgTWFjRHJpdmVyLnByb3RvdHlwZVtjbWRdID0gZm47XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgY3JlYXRlU2Vzc2lvbiAoLi4uYXJncykge1xuICAgIGlmICghc3lzdGVtLmlzTWFjKCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQXBwaXVtRm9yTWFjIHRlc3RzIG9ubHkgcnVuIG9uIHRoZSBNYWMnKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGxldCBbc2Vzc2lvbklkLCBjYXBzXSA9IGF3YWl0IHN1cGVyLmNyZWF0ZVNlc3Npb24oLi4uYXJncyk7XG4gICAgICBhd2FpdCB0aGlzLnN0YXJ0QXBwaXVtRm9yTWFjU2Vzc2lvbigpO1xuICAgICAgaWYgKGNhcHMuYXBwKSB7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBBdXRvbWF0aWNhbGx5IG5hdmlnYXRpbmcgdG8gYXBwICcke2NhcHMuYXBwfSdgKTtcbiAgICAgICAgYXdhaXQgdGhpcy5hNG1Ecml2ZXIuc2VuZENvbW1hbmQoJy91cmwnLCAnUE9TVCcsIHt1cmw6IGNhcHMuYXBwfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gW3Nlc3Npb25JZCwgY2Fwc107XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgYXdhaXQgdGhpcy5kZWxldGVTZXNzaW9uKCk7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHN0YXJ0QXBwaXVtRm9yTWFjU2Vzc2lvbiAoKSB7XG4gICAgbGV0IGE0bUFwcFBhdGggPSB0aGlzLm9wdHMuYTRtQXBwUGF0aDtcbiAgICBpZiAoIWE0bUFwcFBhdGgpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgVGhlIHBhdGggdG8gQXBwaXVtRm9yTWFjIHNlcnZlciBoYXMgbm90IGJlZW4gcHJvdmlkZWQgZXhwbGljaXRseS4gYCArXG4gICAgICAgIGBUcnlpbmcgdG8gYXV0b2RldGVjdCBpdGApO1xuICAgICAgYTRtQXBwUGF0aCA9IGF3YWl0IGZpbmRBcHBQYXRoKEE0TV9BUFBfQlVORExFX0lEKTtcbiAgICAgIGlmIChhNG1BcHBQYXRoKSB7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBBdXRvZGV0ZWN0ZWQgQXBwaXVtRm9yTWFjIHNlcnZlcidzIGxvY2F0aW9uIGF0ICcke2E0bUFwcFBhdGh9J2ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYTRtQXBwUGF0aCA9IFJFUV9BNE1fQVBQX1BBVEg7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBDYW5ub3QgYXV0b2RldGVjdCBBcHBpdW1Gb3JNYWMgc2VydmVyJ3MgbG9jYXRpb24uIGAgK1xuICAgICAgICAgIGBVc2luZyB0aGUgZGVmYXVsdCBzZXJ2ZXIgcGF0aCBhdCAnJHthNG1BcHBQYXRofScuIENvbnNpZGVyIGAgK1xuICAgICAgICAgIGBwcm92aWRpbmcgYSBjdXN0b20gcGF0aCB0byAnYTRtQXBwUGF0aCcgY2FwYWJpbGl0eSBpZiBzdWNoIGJlaGF2aW91ciBgICtcbiAgICAgICAgICBgaXMgdW5kZXNpcmVkYCk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMub3B0cy5hNG1BcHBQYXRoID0gYTRtQXBwUGF0aDtcbiAgICBfLmRlZmF1bHRzKHRoaXMub3B0cywge1xuICAgICAgYTRtSG9zdDogREVGQVVMVF9BNE1fSE9TVCxcbiAgICAgIGE0bVBvcnQ6IERFRkFVTFRfQTRNX1BPUlQsXG4gICAgfSk7XG4gICAgdGhpcy5hNG1Ecml2ZXIgPSBuZXcgQXBwaXVtRm9yTWFjKHRoaXMub3B0cyk7XG5cbiAgICBhd2FpdCB0aGlzLmE0bURyaXZlci5zdGFydCgpO1xuICAgIGF3YWl0IHRoaXMuYTRtRHJpdmVyLnN0YXJ0U2Vzc2lvbih0aGlzLmNhcHMpO1xuICAgIHRoaXMucHJveHlSZXFSZXMgPSB0aGlzLmE0bURyaXZlci5wcm94eVJlcVJlcy5iaW5kKHRoaXMuYTRtRHJpdmVyKTtcbiAgICAvLyBub3cgdGhhdCBldmVyeXRoaW5nIGhhcyBzdGFydGVkIHN1Y2Nlc3NmdWxseSwgdHVybiBvbiBwcm94eWluZyBzbyBhbGxcbiAgICAvLyBzdWJzZXF1ZW50IHNlc3Npb24gcmVxdWVzdHMgZ28gc3RyYWlnaHQgdG8vZnJvbSBBcHBpdW1Gb3JNYWNcbiAgICB0aGlzLmp3cFByb3h5QWN0aXZlID0gdHJ1ZTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVNlc3Npb24gKCkge1xuICAgIGxvZ2dlci5kZWJ1ZygnRGVsZXRpbmcgQXBwaXVtRm9yTWFjIHNlc3Npb24nKTtcblxuICAgIGlmICh0aGlzLmE0bURyaXZlciAmJiB0aGlzLmp3cFByb3h5QWN0aXZlKSB7XG4gICAgICBhd2FpdCB0aGlzLmE0bURyaXZlci5kZWxldGVTZXNzaW9uKCk7XG4gICAgICBhd2FpdCB0aGlzLmE0bURyaXZlci5zdG9wKCk7XG4gICAgICB0aGlzLmE0bURyaXZlciA9IG51bGw7XG4gICAgfVxuICAgIHRoaXMuandwUHJveHlBY3RpdmUgPSBmYWxzZTtcbiAgICBhd2FpdCBzdXBlci5kZWxldGVTZXNzaW9uKCk7XG4gIH1cblxuICBwcm94eUFjdGl2ZSAoKSB7XG4gICAgLy8gd2UgYWx3YXlzIGhhdmUgYW4gYWN0aXZlIHByb3h5IHRvIHRoZSBBcHBpdW1Gb3JNYWMgc2VydmVyXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBnZXRQcm94eUF2b2lkTGlzdCAoKSB7XG4gICAgcmV0dXJuIE5PX1BST1hZX0xJU1Q7XG4gIH1cblxuICBjYW5Qcm94eSAoKSB7XG4gICAgLy8gd2UgY2FuIGFsd2F5cyBwcm94eSB0byB0aGUgQXBwaXVtRm9yTWFjIHNlcnZlclxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZ2V0IGRyaXZlckRhdGEgKCkge1xuICAgIHJldHVybiB7QTRNUG9ydDogdGhpcy5vcHRzLnBvcnR9O1xuICB9XG59XG5cbmV4cG9ydCB7IE1hY0RyaXZlciB9O1xuZXhwb3J0IGRlZmF1bHQgTWFjRHJpdmVyO1xuIl0sImZpbGUiOiJsaWIvZHJpdmVyLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
