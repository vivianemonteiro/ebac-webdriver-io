"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.helpers = exports.commands = void 0;

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _appiumBaseDriver = require("appium-base-driver");

let commands = {},
    helpers = {},
    extensions = {};
exports.helpers = helpers;
exports.commands = commands;

helpers.getElements = function getElements(elIds) {
  for (let elId of elIds) {
    if (!_lodash.default.has(this.elMap, elId)) {
      throw new _appiumBaseDriver.errors.StaleElementReferenceError();
    }
  }

  return elIds.map(e => this.elMap[e]);
};

helpers.getElement = function getElement(elId) {
  return this.getElements([elId])[0];
};

commands.getName = async function getName(elementId) {
  let el = this.getElement(elementId);
  return el.tagName;
};

commands.elementDisplayed = async function elementDisplayed(elementId) {
  let el = this.getElement(elementId);
  return el.isVisible();
};

commands.elementEnabled = async function elementEnabled(elementId) {
  let el = this.getElement(elementId);
  return el.isEnabled();
};

commands.elementSelected = async function elementSelected(elementId) {
  let el = this.getElement(elementId);
  return el.isSelected();
};

commands.setValue = async function setValue(keys, elementId) {
  let value = keys;

  if (keys instanceof Array) {
    value = keys.join('');
  }

  let el = this.getElement(elementId);

  if (el.type !== 'MockInputField') {
    throw new _appiumBaseDriver.errors.InvalidElementStateError();
  }

  el.setAttr('value', value);
};

commands.getText = async function getText(elementId) {
  let el = this.getElement(elementId);
  return el.getAttr('value');
};

commands.clear = async function clear(elementId) {
  await this.setValue('', elementId);
};

commands.click = async function click(elementId) {
  this.assertNoAlert();
  let el = this.getElement(elementId);

  if (!el.isVisible()) {
    throw new _appiumBaseDriver.errors.InvalidElementStateError();
  }

  el.click();
  this.focusedElId = elementId;
};

commands.getAttribute = async function getAttribute(attr, elementId) {
  let el = this.getElement(elementId);
  return el.getAttr(attr);
};

commands.getLocation = function getLocation(elementId) {
  let el = this.getElement(elementId);
  return el.getLocation();
};

commands.getSize = function getSize(elementId) {
  let el = this.getElement(elementId);
  return el.getSize();
};

commands.equalsElement = function equalsElement(el1Id, el2Id) {
  let el1 = this.getElement(el1Id);
  let el2 = this.getElement(el2Id);
  return el1.equals(el2);
};

commands.getLocationInView = commands.getLocation;

commands.getCssProperty = async function getCssProperty(prop, elementId) {
  this.assertWebviewContext();
  let el = this.getElement(elementId);
  return el.getCss(prop);
};

Object.assign(extensions, commands, helpers);
var _default = extensions;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9lbGVtZW50LmpzIl0sIm5hbWVzIjpbImNvbW1hbmRzIiwiaGVscGVycyIsImV4dGVuc2lvbnMiLCJnZXRFbGVtZW50cyIsImVsSWRzIiwiZWxJZCIsIl8iLCJoYXMiLCJlbE1hcCIsImVycm9ycyIsIlN0YWxlRWxlbWVudFJlZmVyZW5jZUVycm9yIiwibWFwIiwiZSIsImdldEVsZW1lbnQiLCJnZXROYW1lIiwiZWxlbWVudElkIiwiZWwiLCJ0YWdOYW1lIiwiZWxlbWVudERpc3BsYXllZCIsImlzVmlzaWJsZSIsImVsZW1lbnRFbmFibGVkIiwiaXNFbmFibGVkIiwiZWxlbWVudFNlbGVjdGVkIiwiaXNTZWxlY3RlZCIsInNldFZhbHVlIiwia2V5cyIsInZhbHVlIiwiQXJyYXkiLCJqb2luIiwidHlwZSIsIkludmFsaWRFbGVtZW50U3RhdGVFcnJvciIsInNldEF0dHIiLCJnZXRUZXh0IiwiZ2V0QXR0ciIsImNsZWFyIiwiY2xpY2siLCJhc3NlcnROb0FsZXJ0IiwiZm9jdXNlZEVsSWQiLCJnZXRBdHRyaWJ1dGUiLCJhdHRyIiwiZ2V0TG9jYXRpb24iLCJnZXRTaXplIiwiZXF1YWxzRWxlbWVudCIsImVsMUlkIiwiZWwySWQiLCJlbDEiLCJlbDIiLCJlcXVhbHMiLCJnZXRMb2NhdGlvbkluVmlldyIsImdldENzc1Byb3BlcnR5IiwicHJvcCIsImFzc2VydFdlYnZpZXdDb250ZXh0IiwiZ2V0Q3NzIiwiT2JqZWN0IiwiYXNzaWduIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUVBLElBQUlBLFFBQVEsR0FBRyxFQUFmO0FBQUEsSUFBbUJDLE9BQU8sR0FBRyxFQUE3QjtBQUFBLElBQWlDQyxVQUFVLEdBQUcsRUFBOUM7Ozs7QUFFQUQsT0FBTyxDQUFDRSxXQUFSLEdBQXNCLFNBQVNBLFdBQVQsQ0FBc0JDLEtBQXRCLEVBQTZCO0FBQ2pELE9BQUssSUFBSUMsSUFBVCxJQUFpQkQsS0FBakIsRUFBd0I7QUFDdEIs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aUQsY0FBVCxHQUEwQixlQUFlQSxjQUFmLENBQStCQyxJQUEvQixFQUFxQ25DLFNBQXJDLEVBQWdEO0FBQ3hFLE9BQUtvQyxvQkFBTDtBQUNBLE1BQUluQyxFQUFFLEdBQUcsS0FBS0gsVUFBTCxDQUFnQkUsU0FBaEIsQ0FBVDtBQUNBLFNBQU9DLEVBQUUsQ0FBQ29DLE1BQUgsQ0FBVUYsSUFBVixDQUFQO0FBQ0QsQ0FKRDs7QUFNQUcsTUFBTSxDQUFDQyxNQUFQLENBQWNwRCxVQUFkLEVBQTBCRixRQUExQixFQUFvQ0MsT0FBcEM7ZUFFZUMsVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBlcnJvcnMgfSBmcm9tICdhcHBpdW0tYmFzZS1kcml2ZXInO1xuXG5sZXQgY29tbWFuZHMgPSB7fSwgaGVscGVycyA9IHt9LCBleHRlbnNpb25zID0ge307XG5cbmhlbHBlcnMuZ2V0RWxlbWVudHMgPSBmdW5jdGlvbiBnZXRFbGVtZW50cyAoZWxJZHMpIHtcbiAgZm9yIChsZXQgZWxJZCBvZiBlbElkcykge1xuICAgIGlmICghXy5oYXModGhpcy5lbE1hcCwgZWxJZCkpIHtcbiAgICAgIHRocm93IG5ldyBlcnJvcnMuU3RhbGVFbGVtZW50UmVmZXJlbmNlRXJyb3IoKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGVsSWRzLm1hcCgoZSkgPT4gdGhpcy5lbE1hcFtlXSk7XG59O1xuXG5oZWxwZXJzLmdldEVsZW1lbnQgPSBmdW5jdGlvbiBnZXRFbGVtZW50IChlbElkKSB7XG4gIHJldHVybiB0aGlzLmdldEVsZW1lbnRzKFtlbElkXSlbMF07XG59O1xuXG5jb21tYW5kcy5nZXROYW1lID0gYXN5bmMgZnVuY3Rpb24gZ2V0TmFtZSAoZWxlbWVudElkKSB7XG4gIGxldCBlbCA9IHRoaXMuZ2V0RWxlbWVudChlbGVtZW50SWQpO1xuICByZXR1cm4gZWwudGFnTmFtZTtcbn07XG5cbmNvbW1hbmRzLmVsZW1lbnREaXNwbGF5ZWQgPSBhc3luYyBmdW5jdGlvbiBlbGVtZW50RGlzcGxheWVkIChlbGVtZW50SWQpIHtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIHJldHVybiBlbC5pc1Zpc2libGUoKTtcbn07XG5cbmNvbW1hbmRzLmVsZW1lbnRFbmFibGVkID0gYXN5bmMgZnVuY3Rpb24gZWxlbWVudEVuYWJsZWQgKGVsZW1lbnRJZCkge1xuICBsZXQgZWwgPSB0aGlzLmdldEVsZW1lbnQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGVsLmlzRW5hYmxlZCgpO1xufTtcblxuY29tbWFuZHMuZWxlbWVudFNlbGVjdGVkID0gYXN5bmMgZnVuY3Rpb24gZWxlbWVudFNlbGVjdGVkIChlbGVtZW50SWQpIHtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIHJldHVybiBlbC5pc1NlbGVjdGVkKCk7XG59O1xuXG5jb21tYW5kcy5zZXRWYWx1ZSA9IGFzeW5jIGZ1bmN0aW9uIHNldFZhbHVlIChrZXlzLCBlbGVtZW50SWQpIHtcbiAgbGV0IHZhbHVlID0ga2V5cztcbiAgaWYgKGtleXMgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgIHZhbHVlID0ga2V5cy5qb2luKCcnKTtcbiAgfVxuICBsZXQgZWwgPSB0aGlzLmdldEVsZW1lbnQoZWxlbWVudElkKTtcbiAgaWYgKGVsLnR5cGUgIT09ICdNb2NrSW5wdXRGaWVsZCcpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkludmFsaWRFbGVtZW50U3RhdGVFcnJvcigpO1xuICB9XG4gIGVsLnNldEF0dHIoJ3ZhbHVlJywgdmFsdWUpO1xufTtcblxuY29tbWFuZHMuZ2V0VGV4dCA9IGFzeW5jIGZ1bmN0aW9uIGdldFRleHQgKGVsZW1lbnRJZCkge1xuICBsZXQgZWwgPSB0aGlzLmdldEVsZW1lbnQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGVsLmdldEF0dHIoJ3ZhbHVlJyk7XG59O1xuXG5jb21tYW5kcy5jbGVhciA9IGFzeW5jIGZ1bmN0aW9uIGNsZWFyIChlbGVtZW50SWQpIHtcbiAgYXdhaXQgdGhpcy5zZXRWYWx1ZSgnJywgZWxlbWVudElkKTtcbn07XG5cbmNvbW1hbmRzLmNsaWNrID0gYXN5bmMgZnVuY3Rpb24gY2xpY2sgKGVsZW1lbnRJZCkge1xuICB0aGlzLmFzc2VydE5vQWxlcnQoKTtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIGlmICghZWwuaXNWaXNpYmxlKCkpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkludmFsaWRFbGVtZW50U3RhdGVFcnJvcigpO1xuICB9XG4gIGVsLmNsaWNrKCk7XG4gIHRoaXMuZm9jdXNlZEVsSWQgPSBlbGVtZW50SWQ7XG59O1xuXG5jb21tYW5kcy5nZXRBdHRyaWJ1dGUgPSBhc3luYyBmdW5jdGlvbiBnZXRBdHRyaWJ1dGUgKGF0dHIsIGVsZW1lbnRJZCkge1xuICBsZXQgZWwgPSB0aGlzLmdldEVsZW1lbnQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGVsLmdldEF0dHIoYXR0cik7XG59O1xuXG5jb21tYW5kcy5nZXRMb2NhdGlvbiA9IGZ1bmN0aW9uIGdldExvY2F0aW9uIChlbGVtZW50SWQpIHtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIHJldHVybiBlbC5nZXRMb2NhdGlvbigpO1xufTtcblxuY29tbWFuZHMuZ2V0U2l6ZSA9IGZ1bmN0aW9uIGdldFNpemUgKGVsZW1lbnRJZCkge1xuICBsZXQgZWwgPSB0aGlzLmdldEVsZW1lbnQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGVsLmdldFNpemUoKTtcbn07XG5cbmNvbW1hbmRzLmVxdWFsc0VsZW1lbnQgPSBmdW5jdGlvbiBlcXVhbHNFbGVtZW50IChlbDFJZCwgZWwySWQpIHtcbiAgbGV0IGVsMSA9IHRoaXMuZ2V0RWxlbWVudChlbDFJZCk7XG4gIGxldCBlbDIgPSB0aGlzLmdldEVsZW1lbnQoZWwySWQpO1xuICByZXR1cm4gZWwxLmVxdWFscyhlbDIpO1xufTtcblxuY29tbWFuZHMuZ2V0TG9jYXRpb25JblZpZXcgPSBjb21tYW5kcy5nZXRMb2NhdGlvbjtcblxuY29tbWFuZHMuZ2V0Q3NzUHJvcGVydHkgPSBhc3luYyBmdW5jdGlvbiBnZXRDc3NQcm9wZXJ0eSAocHJvcCwgZWxlbWVudElkKSB7XG4gIHRoaXMuYXNzZXJ0V2Vidmlld0NvbnRleHQoKTtcbiAgbGV0IGVsID0gdGhpcy5nZXRFbGVtZW50KGVsZW1lbnRJZCk7XG4gIHJldHVybiBlbC5nZXRDc3MocHJvcCk7XG59O1xuXG5PYmplY3QuYXNzaWduKGV4dGVuc2lvbnMsIGNvbW1hbmRzLCBoZWxwZXJzKTtcbmV4cG9ydCB7IGNvbW1hbmRzLCBoZWxwZXJzIH07XG5leHBvcnQgZGVmYXVsdCBleHRlbnNpb25zO1xuIl0sImZpbGUiOiJsaWIvY29tbWFuZHMvZWxlbWVudC5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
