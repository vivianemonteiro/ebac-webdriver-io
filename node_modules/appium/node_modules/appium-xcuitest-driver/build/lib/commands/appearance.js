"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.commands = void 0;

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _appiumSupport = require("appium-support");

const commands = {};
exports.commands = commands;

commands.mobileSetAppearance = async function mobileSetAppearance(opts = {}) {
  const {
    style
  } = opts;

  if (!style) {
    throw new Error(`The 'style' option is expected to be present`);
  }

  if (_appiumSupport.util.compareVersions(this.opts.platformVersion, '<', '12.0')) {
    throw new Error('Changing appearance is only supported since iOS 12');
  }

  if (this.isSimulator()) {
    try {
      return void (await this.opts.device.setAppearance(style));
    } catch (ign) {}
  }

  await this.mobileSiriCommand({
    text: `Turn ${_lodash.default.toLower(style) === 'dark' ? 'on' : 'off'} dark mode`
  });
};

commands.mobileGetAppearance = async function mobileGetAppearance() {
  if (_appiumSupport.util.compareVersions(this.opts.platformVersion, '<', '12.0')) {
    return 'unsupported';
  }

  let style;

  if (this.isSimulator()) {
    try {
      style = await this.opts.device.getAppearance();
    } catch (ign) {}
  }

  if (!style) {
    style = (await this.proxyCommand('/wda/device/info', 'GET')).userInterfaceStyle || 'unknown';
  }

  return {
    style
  };
};

var _default = commands;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9hcHBlYXJhbmNlLmpzIl0sIm5hbWVzIjpbImNvbW1hbmRzIiwibW9iaWxlU2V0QXBwZWFyYW5jZSIsIm9wdHMiLCJzdHlsZSIsIkVycm9yIiwidXRpbCIsImNvbXBhcmVWZXJzaW9ucyIsInBsYXRmb3JtVmVyc2lvbiIsImlzU2ltdWxhdG9yIiwiZGV2aWNlIiwic2V0QXBwZWFyYW5jZSIsImlnbiIsIm1vYmlsZVNpcmlDb21tYW5kIiwidGV4dCIsIl8iLCJ0b0xvd2VyIiwibW9iaWxlR2V0QXBwZWFyYW5jZSIsImdldEFwcGVhcmFuY2UiLCJwcm94eUNvbW1hbmQiLCJ1c2VySW50ZXJmYWNlU3R5bGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBR0EsTUFBTUEsUUFBUSxHQUFHLEVBQWpCOzs7QUFrQkFBLFFBQVEsQ0FBQ0MsbUJBQVQsR0FBK0IsZUFBZUEsbUJBQWYsQ0FBb0NDLElBQUksR0FBRyxFQUEzQyxFQUErQztBQUM1RSxRQUFNO0FBQ0pDLElBQUFBO0FBREksTUFFRkQsSUFGSjs7QUFHQSxNQUFJLENBQUNDLEtBQUwsRUFBWTtBQUNWLFVBQU0sSUFBSUMsS0FBSixDQUFXLDhDQUFYLENBQU47QUFDRDs7QUFDRCxNQUFJQyxvQkFBS0MsZUFBTCxDQUFxQixLQUFLSixJQUFMLENBQVVLLGVBQS9CLEVBQWdELEdBQWhELEVBQXFELE1BQXJELENBQUosRUFBa0U7QUFDaEUsVUFBTSxJQUFJSCxLQUFKLENBQVUsb0RBQVYsQ0FBTjtBQUNEOztBQUVELE1BQUksS0FBS0ksV0FBTCxFQUFKLEVBQXdCO0FBQ3RCLFFBQUk7QUFDRixhQUFPLE1BQU0sTUFBTSxLQUFLTixJQUFMLENBQVVPLE1BQVYsQ0FBaUJDLGFBQWpCLENBQStCUCxLQUEvQixDQUFaLENBQVA7QUFDRCxLQUZELENBRUUsT0FBT1EsR0FBUCxFQUFZLENBQUU7QUFDakI7O0FBR0QsUUFBTSxLQUFLQyxpQkFBTCxDQUF1QjtBQUMzQkMsSUFBQUEsSUFBSSxFQUFHLFFBQU9DLGdCQUFFQyxPQUFGLENBQVVaLEtBQVYsTUFBcUIsTUFBckIsR0FBOEIsSUFBOUIsR0FBcUMsS0FBTTtBQUQ5QixHQUF2QixDQUFOO0FBR0QsQ0FyQkQ7O0FBdUNBSCxRQUFRLENBQUNnQixtQkFBVCxHQUErQixlQUFlQSxtQkFBZixHQUFzQztBQUNuRSxNQUFJWCxvQkFBS0MsZUFBTCxDQUFxQixLQUFLSixJQUFMLENBQVVLLGVBQS9CLEVBQWdELEdBQWhELEVBQXFELE1BQXJELENBQUosRUFBa0U7QUFDaEUsV0FBTyxhQUFQO0FBQ0Q7O0FBRUQsTUFBSUosS0FBSjs7QUFDQSxNQUFJLEtBQUtLLFdBQUwsRUFBSixFQUF3QjtBQUN0QixRQUFJO0FBQ0ZMLE1BQUFBLEtBQUssR0FBRyxNQUFNLEtBQUtELElBQUwsQ0FBVU8sTUFBVixDQUFpQlEsYUFBakIsRUFBZDtBQUNELEtBRkQsQ0FFRSxPQUFPTixHQUFQLEVBQVksQ0FBRTtBQUNqQjs7QUFDRCxNQUFJLENBQUNSLEtBQUwsRUFBWTtBQUNWQSxJQUFBQSxLQUFLLEdBQUcsQ0FBQyxNQUFNLEtBQUtlLFlBQUwsQ0FBa0Isa0JBQWxCLEVBQXNDLEtBQXRDLENBQVAsRUFBcURDLGtCQUFyRCxJQUEyRSxTQUFuRjtBQUNEOztBQUNELFNBQU87QUFDTGhCLElBQUFBO0FBREssR0FBUDtBQUdELENBakJEOztlQXFCZUgsUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyB1dGlsIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuXG5cbmNvbnN0IGNvbW1hbmRzID0ge307XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU2V0QXBwZWFyYW5jZU9wdGlvbnNcbiAqXG4gKiBAcHJvcGVydHkge3N0cmluZ30gc3R5bGUgLSBDdXJyZW50bHkgdHdvIHN0eWxlcyBhcmUgc3VwcG9ydGVkOlxuICogLSBkYXJrXG4gKiAtIGxpZ2h0XG4gKi9cblxuLyoqXG4gKiBTZXQgdGhlIGRldmljZSdzIFVJIGFwcGVhcmFuY2Ugc3R5bGVcbiAqXG4gKiBAc2luY2UgaU9TIDEyLjBcbiAqIEBwYXJhbSB7U2V0QXBwZWFyYW5jZU9wdGlvbnN9IG9wdHNcbiAqIEB0aHJvd3Mge0Vycm9yfSBpZiB0aGUgY3VycmVudCBwbGF0Zm9ybSBkb2VzIG5vdCBzdXBwb3J0IFVJXG4gKiBhcHBlYXJhbmNlIGNoYW5nZXNcbiAqL1xuY29tbWFuZHMubW9iaWxlU2V0QXBwZWFyYW5jZSA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZVNldEFwcGVhcmFuY2UgKG9wdHMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgc3R5bGUsXG4gIH0gPSBvcHRzO1xuICBpZiAoIXN0eWxlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgJ3N0eWxlJyBvcHRpb24gaXMgZXhwZWN0ZWQgdG8gYmUgcHJlc2VudGApO1xuICB9XG4gIGlmICh1dGlsLmNvbXBhcmVWZXJzaW9ucyh0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uLCAnPCcsICcxMi4wJykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0NoYW5naW5nIGFwcGVhcmFuY2UgaXMgb25seSBzdXBwb3J0ZWQgc2luY2UgaU9TIDEyJyk7XG4gIH1cblxuICBpZiAodGhpcy5pc1NpbXVsYXRvcigpKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB2b2lkIChhd2FpdCB0aGlzLm9wdHMuZGV2aWNlLnNldEFwcGVhcmFuY2Uoc3R5bGUpKTtcbiAgICB9IGNhdGNoIChpZ24pIHt9XG4gIH1cbiAgLy8gRmFsbCBiYWNrIHRvIHRoZSB1Z2x5IFNpcmkgd29ya2Fyb3VuZCBpZiB0aGUgc2ltdWxhdG9yIGlzIHRvbyBvbGRcbiAgLy8gb3IgdGhpcyBpcyBhIHJlYWwgZGV2aWNlXG4gIGF3YWl0IHRoaXMubW9iaWxlU2lyaUNvbW1hbmQoe1xuICAgIHRleHQ6IGBUdXJuICR7Xy50b0xvd2VyKHN0eWxlKSA9PT0gJ2RhcmsnID8gJ29uJyA6ICdvZmYnfSBkYXJrIG1vZGVgLFxuICB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQXBwZWFyYW5jZVxuICogQHByb3BlcnR5IHtzdHJpbmd9IHN0eWxlIC0gVGhlIGRldmljZSdzIFVJIGFwcGVhcmFuY2UgdmFsdWUuXG4gKiBUaGlzIGNvdWxkIGJlIG9uZSBvZjpcbiAqIC0gYGxpZ2h0YFxuICogLSBgZGFya2BcbiAqIC0gYHVua25vd25gXG4gKiAtIGB1bnN1cHBvcnRlZGBcbiAqL1xuXG4vKipcbiAqIEdldCB0aGUgZGV2aWNlJ3MgVUkgYXBwZWFyYW5jZSBzdHlsZS5cbiAqXG4gKiBAc2luY2UgWGNvZGUgU0RLIDExXG4gKiBAcmV0dXJucyB7QXBwZWFyYW5jZX1cbiAqL1xuY29tbWFuZHMubW9iaWxlR2V0QXBwZWFyYW5jZSA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZUdldEFwcGVhcmFuY2UgKCkge1xuICBpZiAodXRpbC5jb21wYXJlVmVyc2lvbnModGhpcy5vcHRzLnBsYXRmb3JtVmVyc2lvbiwgJzwnLCAnMTIuMCcpKSB7XG4gICAgcmV0dXJuICd1bnN1cHBvcnRlZCc7XG4gIH1cblxuICBsZXQgc3R5bGU7XG4gIGlmICh0aGlzLmlzU2ltdWxhdG9yKCkpIHtcbiAgICB0cnkge1xuICAgICAgc3R5bGUgPSBhd2FpdCB0aGlzLm9wdHMuZGV2aWNlLmdldEFwcGVhcmFuY2UoKTtcbiAgICB9IGNhdGNoIChpZ24pIHt9XG4gIH1cbiAgaWYgKCFzdHlsZSkge1xuICAgIHN0eWxlID0gKGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvd2RhL2RldmljZS9pbmZvJywgJ0dFVCcpKS51c2VySW50ZXJmYWNlU3R5bGUgfHwgJ3Vua25vd24nO1xuICB9XG4gIHJldHVybiB7XG4gICAgc3R5bGUsXG4gIH07XG59O1xuXG5cbmV4cG9ydCB7IGNvbW1hbmRzIH07XG5leHBvcnQgZGVmYXVsdCBjb21tYW5kcztcbiJdLCJmaWxlIjoibGliL2NvbW1hbmRzL2FwcGVhcmFuY2UuanMiLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
