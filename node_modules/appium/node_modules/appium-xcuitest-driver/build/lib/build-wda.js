"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _appiumWebdriveragent = require("appium-webdriveragent");

var _utils = require("./utils");

var _simulatorManagement = require("./simulator-management");

var _asyncbox = require("asyncbox");

const DEFAULT_SIM_NAME = 'iPhone 12';

async function build() {
  const xcodeVersion = await (0, _utils.getAndCheckXcodeVersion)();
  const iosVersion = await (0, _utils.getAndCheckIosSdkVersion)();
  const deviceName = (0, _utils.translateDeviceName)(iosVersion, DEFAULT_SIM_NAME);
  const device = await (0, _simulatorManagement.getExistingSim)({
    platformVersion: iosVersion,
    deviceName
  });
  const wda = new _appiumWebdriveragent.WebDriverAgent(xcodeVersion, {
    iosSdkVersion: iosVersion,
    platformVersion: iosVersion,
    showXcodeLog: true,
    device
  });
  await wda.xcodebuild.start(true);
}

if (require.main === module) {
  (0, _asyncbox.asyncify)(build);
}

var _default = build;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9idWlsZC13ZGEuanMiXSwibmFtZXMiOlsiREVGQVVMVF9TSU1fTkFNRSIsImJ1aWxkIiwieGNvZGVWZXJzaW9uIiwiaW9zVmVyc2lvbiIsImRldmljZU5hbWUiLCJkZXZpY2UiLCJwbGF0Zm9ybVZlcnNpb24iLCJ3ZGEiLCJXZWJEcml2ZXJBZ2VudCIsImlvc1Nka1ZlcnNpb24iLCJzaG93WGNvZGVMb2ciLCJ4Y29kZWJ1aWxkIiwic3RhcnQiLCJyZXF1aXJlIiwibWFpbiIsIm1vZHVsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsTUFBTUEsZ0JBQWdCLEdBQUcsV0FBekI7O0FBR0EsZUFBZUMsS0FBZixHQUF3QjtBQUN0QixRQUFNQyxZQUFZLEdBQUcsTUFBTSxxQ0FBM0I7QUFDQSxRQUFNQyxVQUFVLEdBQUcsTUFBTSxzQ0FBekI7QUFDQSxRQUFNQyxVQUFVLEdBQUcsZ0NBQW9CRCxVQUFwQixFQUFnQ0gsZ0JBQWhDLENBQW5CO0FBQ0EsUUFBTUssTUFBTSxHQUFHLE1BQU0seUNBQWU7QUFDbENDLElBQUFBLGVBQWUsRUFBRUgsVUFEaUI7QUFFbENDLElBQUFBO0FBRmtDLEdBQWYsQ0FBckI7QUFJQSxRQUFNRyxHQUFHLEdBQUcsSUFBSUMsb0NBQUosQ0FBbUJOLFlBQW5CLEVBQWlDO0FBQzNDTyxJQUFBQSxhQUFhLEVBQUVOLFVBRDRCO0FBRTNDRyxJQUFBQSxlQUFlLEVBQUVILFVBRjBCO0FBRzNDTyxJQUFBQSxZQUFZLEVBQUUsSUFINkI7QUFJM0NMLElBQUFBO0FBSjJDLEdBQWpDLENBQVo7QUFNQSxRQUFNRSxHQUFHLENBQUNJLFVBQUosQ0FBZUMsS0FBZixDQUFxQixJQUFyQixDQUFOO0FBQ0Q7O0FBRUQsSUFBSUMsT0FBTyxDQUFDQyxJQUFSLEtBQWlCQyxNQUFyQixFQUE2QjtBQUMzQiwwQkFBU2QsS0FBVDtBQUNEOztlQUVjQSxLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgV2ViRHJpdmVyQWdlbnQgfSBmcm9tICdhcHBpdW0td2ViZHJpdmVyYWdlbnQnO1xuaW1wb3J0IHsgdHJhbnNsYXRlRGV2aWNlTmFtZSwgZ2V0QW5kQ2hlY2tYY29kZVZlcnNpb24sIGdldEFuZENoZWNrSW9zU2RrVmVyc2lvbiB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgZ2V0RXhpc3RpbmdTaW0gfSBmcm9tICcuL3NpbXVsYXRvci1tYW5hZ2VtZW50JztcbmltcG9ydCB7IGFzeW5jaWZ5IH0gZnJvbSAnYXN5bmNib3gnO1xuXG5jb25zdCBERUZBVUxUX1NJTV9OQU1FID0gJ2lQaG9uZSAxMic7XG5cbi8vIFRPRE86IGFsbG93IHBhc3NpbmcgaW4gYWxsIHRoZSB2YXJpb3VzIGJ1aWxkIHBhcmFtcyBhcyBDTEkgYXJnc1xuYXN5bmMgZnVuY3Rpb24gYnVpbGQgKCkge1xuICBjb25zdCB4Y29kZVZlcnNpb24gPSBhd2FpdCBnZXRBbmRDaGVja1hjb2RlVmVyc2lvbigpO1xuICBjb25zdCBpb3NWZXJzaW9uID0gYXdhaXQgZ2V0QW5kQ2hlY2tJb3NTZGtWZXJzaW9uKCk7XG4gIGNvbnN0IGRldmljZU5hbWUgPSB0cmFuc2xhdGVEZXZpY2VOYW1lKGlvc1ZlcnNpb24sIERFRkFVTFRfU0lNX05BTUUpO1xuICBjb25zdCBkZXZpY2UgPSBhd2FpdCBnZXRFeGlzdGluZ1NpbSh7XG4gICAgcGxhdGZvcm1WZXJzaW9uOiBpb3NWZXJzaW9uLFxuICAgIGRldmljZU5hbWVcbiAgfSk7XG4gIGNvbnN0IHdkYSA9IG5ldyBXZWJEcml2ZXJBZ2VudCh4Y29kZVZlcnNpb24sIHtcbiAgICBpb3NTZGtWZXJzaW9uOiBpb3NWZXJzaW9uLFxuICAgIHBsYXRmb3JtVmVyc2lvbjogaW9zVmVyc2lvbixcbiAgICBzaG93WGNvZGVMb2c6IHRydWUsXG4gICAgZGV2aWNlLFxuICB9KTtcbiAgYXdhaXQgd2RhLnhjb2RlYnVpbGQuc3RhcnQodHJ1ZSk7XG59XG5cbmlmIChyZXF1aXJlLm1haW4gPT09IG1vZHVsZSkge1xuICBhc3luY2lmeShidWlsZCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGJ1aWxkO1xuIl0sImZpbGUiOiJsaWIvYnVpbGQtd2RhLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
