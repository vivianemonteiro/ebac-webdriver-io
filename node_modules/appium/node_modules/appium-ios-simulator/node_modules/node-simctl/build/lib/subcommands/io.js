"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _rimraf = _interopRequireDefault(require("rimraf"));

var _uuid = require("uuid");

var _path = _interopRequireDefault(require("path"));

var _os = _interopRequireDefault(require("os"));

var _fs = _interopRequireDefault(require("fs"));

var _bluebird = _interopRequireDefault(require("bluebird"));

const commands = {};

const rimrafAsync = _bluebird.default.promisify(_rimraf.default);

const readFileAsync = _bluebird.default.promisify(_fs.default.readFile);

commands.getScreenshot = async function getScreenshot() {
  const udid = this.requireUdid('io screenshot');

  const pathToScreenshotPng = _path.default.resolve(_os.default.tmpdir(), `${(0, _uuid.v4)()}.png`);

  try {
    await this.exec('io', {
      args: [udid, 'screenshot', pathToScreenshotPng]
    });
    return (await readFileAsync(pathToScreenshotPng)).toString('base64');
  } finally {
    await rimrafAsync(pathToScreenshotPng);
  }
};

var _default = commands;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zdWJjb21tYW5kcy9pby5qcyJdLCJuYW1lcyI6WyJjb21tYW5kcyIsInJpbXJhZkFzeW5jIiwiQiIsInByb21pc2lmeSIsInJpbXJhZiIsInJlYWRGaWxlQXN5bmMiLCJmcyIsInJlYWRGaWxlIiwiZ2V0U2NyZWVuc2hvdCIsInVkaWQiLCJyZXF1aXJlVWRpZCIsInBhdGhUb1NjcmVlbnNob3RQbmciLCJwYXRoIiwicmVzb2x2ZSIsIm9zIiwidG1wZGlyIiwiZXhlYyIsImFyZ3MiLCJ0b1N0cmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQSxNQUFNQSxRQUFRLEdBQUcsRUFBakI7O0FBQ0EsTUFBTUMsV0FBVyxHQUFHQyxrQkFBRUMsU0FBRixDQUFZQyxlQUFaLENBQXBCOztBQUNBLE1BQU1DLGFBQWEsR0FBR0gsa0JBQUVDLFNBQUYsQ0FBWUcsWUFBR0MsUUFBZixDQUF0Qjs7QUFZQVAsUUFBUSxDQUFDUSxhQUFULEdBQXlCLGVBQWVBLGFBQWYsR0FBZ0M7QUFDdkQsUUFBTUMsSUFBSSxHQUFHLEtBQUtDLFdBQUwsQ0FBaUIsZUFBakIsQ0FBYjs7QUFDQSxRQUFNQyxtQkFBbUIsR0FBR0MsY0FBS0MsT0FBTCxDQUFhQyxZQUFHQyxNQUFILEVBQWIsRUFBMkIsR0FBRSxlQUFTLE1BQXRDLENBQTVCOztBQUNBLE1BQUk7QUFDRixVQUFNLEtBQUtDLElBQUwsQ0FBVSxJQUFWLEVBQWdCO0FBQ3BCQyxNQUFBQSxJQUFJLEVBQUUsQ0FBQ1IsSUFBRCxFQUFPLFlBQVAsRUFBcUJFLG1CQUFyQjtBQURjLEtBQWhCLENBQU47QUFHQSxXQUFPLENBQUMsTUFBTU4sYUFBYSxDQUFDTSxtQkFBRCxDQUFwQixFQUEyQ08sUUFBM0MsQ0FBb0QsUUFBcEQsQ0FBUDtBQUNELEdBTEQsU0FLVTtBQUNSLFVBQU1qQixXQUFXLENBQUNVLG1CQUFELENBQWpCO0FBQ0Q7QUFDRixDQVhEOztlQWFlWCxRIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHJpbXJhZiBmcm9tICdyaW1yYWYnO1xuaW1wb3J0IHsgdjQgYXMgdXVpZFY0IH0gZnJvbSAndXVpZCc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBvcyBmcm9tICdvcyc7XG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuXG5jb25zdCBjb21tYW5kcyA9IHt9O1xuY29uc3QgcmltcmFmQXN5bmMgPSBCLnByb21pc2lmeShyaW1yYWYpO1xuY29uc3QgcmVhZEZpbGVBc3luYyA9IEIucHJvbWlzaWZ5KGZzLnJlYWRGaWxlKTtcblxuLyoqXG4gKiBHZXRzIGJhc2U2NCBzY3JlZW5zaG90IGZvciBkZXZpY2VcbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlLlxuICpcbiAqIEBzaW5jZSBYY29kZSBTREsgOC4xXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEJhc2U2NC1lbmNvZGVkIFNpbXVsYXRvciBzY3JlZW5zaG90LlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBgdWRpZGAgaW5zdGFuY2UgcHJvcGVydHkgaXMgdW5zZXRcbiAqL1xuY29tbWFuZHMuZ2V0U2NyZWVuc2hvdCA9IGFzeW5jIGZ1bmN0aW9uIGdldFNjcmVlbnNob3QgKCkge1xuICBjb25zdCB1ZGlkID0gdGhpcy5yZXF1aXJlVWRpZCgnaW8gc2NyZWVuc2hvdCcpO1xuICBjb25zdCBwYXRoVG9TY3JlZW5zaG90UG5nID0gcGF0aC5yZXNvbHZlKG9zLnRtcGRpcigpLCBgJHt1dWlkVjQoKX0ucG5nYCk7XG4gIHRyeSB7XG4gICAgYXdhaXQgdGhpcy5leGVjKCdpbycsIHtcbiAgICAgIGFyZ3M6IFt1ZGlkLCAnc2NyZWVuc2hvdCcsIHBhdGhUb1NjcmVlbnNob3RQbmddLFxuICAgIH0pO1xuICAgIHJldHVybiAoYXdhaXQgcmVhZEZpbGVBc3luYyhwYXRoVG9TY3JlZW5zaG90UG5nKSkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IHJpbXJhZkFzeW5jKHBhdGhUb1NjcmVlbnNob3RQbmcpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb21tYW5kcztcbiJdLCJmaWxlIjoibGliL3N1YmNvbW1hbmRzL2lvLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
