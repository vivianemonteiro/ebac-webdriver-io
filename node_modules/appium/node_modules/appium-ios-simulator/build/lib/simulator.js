"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getDeviceString = getDeviceString;
exports.getSimulator = getSimulator;

require("source-map-support/register");

var _simulatorXcode = _interopRequireDefault(require("./simulator-xcode-6"));

var _simulatorXcode2 = _interopRequireDefault(require("./simulator-xcode-7"));

var _simulatorXcode3 = _interopRequireDefault(require("./simulator-xcode-7.3"));

var _simulatorXcode4 = _interopRequireDefault(require("./simulator-xcode-8"));

var _simulatorXcode5 = _interopRequireDefault(require("./simulator-xcode-9"));

var _simulatorXcode6 = _interopRequireDefault(require("./simulator-xcode-9.3"));

var _simulatorXcode7 = _interopRequireDefault(require("./simulator-xcode-10"));

var _simulatorXcode8 = _interopRequireDefault(require("./simulator-xcode-11"));

var _simulatorXcode9 = _interopRequireDefault(require("./simulator-xcode-11.4"));

var _utils = require("./utils");

var _appiumXcode = _interopRequireDefault(require("appium-xcode"));

var _logger = require("./logger");

function handleUnsupportedXcode(xcodeVersion) {
  if (xcodeVersion.major < 6) {
    throw new Error(`Tried to use an iOS simulator with xcode ` + `version ${xcodeVersion.versionString} but only Xcode version ` + `6.0.0 and up are supported`);
  }
}

async function getSimulator(udid, opts = {}) {
  let {
    platform = 'iOS',
    checkExistence = true,
    devicesSetPath
  } = opts;
  const xcodeVersion = await _appiumXcode.default.getVersion(true);

  if (checkExistence) {
    const simulatorInfo = await (0, _utils.getSimulatorInfo)(udid, {
      devicesSetPath
    });

    if (!simulatorInfo) {
      throw new Error(`No sim found with udid '${udid}'`);
    }

    platform = simulatorInfo.platform;
  }

  (0, _logger.setLoggingPlatform)(platform);

  _logger.log.info(`Constructing ${platform} simulator for Xcode version ${xcodeVersion.versionString} ` + `with udid '${udid}'`);

  let SimClass;

  switch (xcodeVersion.major) {
    case 1:
    case 2:
    case 3:
    case 4:
    case 5:
      handleUnsupportedXcode(xcodeVersion);
      break;

    case 6:
      SimClass = _simulatorXcode.default;
      break;

    case 7:
      if (xcodeVersion.minor < 3) {
        SimClass = _simulatorXcode2.default;
      } else {
        SimClass = _simulatorXcode3.default;
      }

      break;

    case 8:
      SimClass = _simulatorXcode4.default;
      break;

    case 9:
      if (xcodeVersion.minor < 3) {
        SimClass = _simulatorXcode5.default;
      } else {
        SimClass = _simulatorXcode6.default;
      }

      break;

    case 10:
      SimClass = _simulatorXcode7.default;
      break;

    case 11:
    case 12:
    default:
      if (xcodeVersion.major > 11 || xcodeVersion.minor >= 4) {
        SimClass = _simulatorXcode9.default;
      } else {
        SimClass = _simulatorXcode8.default;
      }

      break;
  }

  const result = new SimClass(udid, xcodeVersion);

  if (devicesSetPath) {
    result.devicesSetPath = devicesSetPath;
  }

  return result;
}

async function getDeviceString(opts) {
  let xcodeVersion = await _appiumXcode.default.getVersion(true);
  handleUnsupportedXcode(xcodeVersion);

  _logger.log.info(`Retrieving device name string for Xcode version ${xcodeVersion.versionString}`);

  if (xcodeVersion.major >= 8) {
    return await _simulatorXcode2.default.getDeviceString(opts);
  } else if (xcodeVersion.major === 7) {
    return await _simulatorXcode2.default.getDeviceString(opts);
  } else if (xcodeVersion.major === 6) {
    return await _simulatorXcode.default.getDeviceString(opts);
  }
}require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zaW11bGF0b3IuanMiXSwibmFtZXMiOlsiaGFuZGxlVW5zdXBwb3J0ZWRYY29kZSIsInhjb2RlVmVyc2lvbiIsIm1ham9yIiwiRXJyb3IiLCJ2ZXJzaW9uU3RyaW5nIiwiZ2V0U2ltdWxhdG9yIiwidWRpZCIsIm9wdHMiLCJwbGF0Zm9ybSIsImNoZWNrRXhpc3RlbmNlIiwiZGV2aWNlc1NldFBhdGgiLCJ4Y29kZSIsImdldFZlcnNpb24iLCJzaW11bGF0b3JJbmZvIiwibG9nIiwiaW5mbyIsIlNpbUNsYXNzIiwiU2ltdWxhdG9yWGNvZGU2IiwibWlub3IiLCJTaW11bGF0b3JYY29kZTciLCJTaW11bGF0b3JYY29kZTczIiwiU2ltdWxhdG9yWGNvZGU4IiwiU2ltdWxhdG9yWGNvZGU5IiwiU2ltdWxhdG9yWGNvZGU5MyIsIlNpbXVsYXRvclhjb2RlMTAiLCJTaW11bGF0b3JYY29kZTExXzQiLCJTaW11bGF0b3JYY29kZTExIiwicmVzdWx0IiwiZ2V0RGV2aWNlU3RyaW5nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQSxTQUFTQSxzQkFBVCxDQUFpQ0MsWUFBakMsRUFBK0M7QUFDN0MsTUFBSUEsWUFBWSxDQUFDQyxLQUFiLEdBQXFCLENBQXpCLEVBQTRCO0FBQzFCLFVBQU0sSUFBSUMsS0FBSixDQUFXLDJDQUFELEdBQ0MsV0FBVUYsWUFBWSxDQUFDRyxhQUFjLDBCQUR0QyxHQUVDLDRCQUZYLENBQU47QUFHRDtBQUNGOztBQXNCRCxlQUFlQyxZQUFmLENBQTZCQyxJQUE3QixFQUFtQ0MsSUFBSSxHQUFHLEVBQTFDLEVBQThDO0FBQzVDLE1BQUk7QUFDRkMsSUFBQUEsUUFBUSxHQUFHLEtBRFQ7QUFFRkMsSUFBQUEsY0FBYyxHQUFHLElBRmY7QUFHRkMsSUFBQUE7QUFIRSxNQUlBSCxJQUpKO0FBTUEsUUFBTU4s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QjtBQUNuQyxXQUFPLE1BQU1lLHdCQUFnQlcsZUFBaEIsQ0FBZ0NyQixJQUFoQyxDQUFiO0FBQ0Q7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTaW11bGF0b3JYY29kZTYgZnJvbSAnLi9zaW11bGF0b3IteGNvZGUtNic7XG5pbXBvcnQgU2ltdWxhdG9yWGNvZGU3IGZyb20gJy4vc2ltdWxhdG9yLXhjb2RlLTcnO1xuaW1wb3J0IFNpbXVsYXRvclhjb2RlNzMgZnJvbSAnLi9zaW11bGF0b3IteGNvZGUtNy4zJztcbmltcG9ydCBTaW11bGF0b3JYY29kZTggZnJvbSAnLi9zaW11bGF0b3IteGNvZGUtOCc7XG5pbXBvcnQgU2ltdWxhdG9yWGNvZGU5IGZyb20gJy4vc2ltdWxhdG9yLXhjb2RlLTknO1xuaW1wb3J0IFNpbXVsYXRvclhjb2RlOTMgZnJvbSAnLi9zaW11bGF0b3IteGNvZGUtOS4zJztcbmltcG9ydCBTaW11bGF0b3JYY29kZTEwIGZyb20gJy4vc2ltdWxhdG9yLXhjb2RlLTEwJztcbmltcG9ydCBTaW11bGF0b3JYY29kZTExIGZyb20gJy4vc2ltdWxhdG9yLXhjb2RlLTExJztcbmltcG9ydCBTaW11bGF0b3JYY29kZTExXzQgZnJvbSAnLi9zaW11bGF0b3IteGNvZGUtMTEuNCc7XG5pbXBvcnQgeyBnZXRTaW11bGF0b3JJbmZvIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeGNvZGUgZnJvbSAnYXBwaXVtLXhjb2RlJztcbmltcG9ydCB7IGxvZywgc2V0TG9nZ2luZ1BsYXRmb3JtIH0gZnJvbSAnLi9sb2dnZXInO1xuXG5cbmZ1bmN0aW9uIGhhbmRsZVVuc3VwcG9ydGVkWGNvZGUgKHhjb2RlVmVyc2lvbikge1xuICBpZiAoeGNvZGVWZXJzaW9uLm1ham9yIDwgNikge1xuICAgIHRocm93IG5ldyBFcnJvcihgVHJpZWQgdG8gdXNlIGFuIGlPUyBzaW11bGF0b3Igd2l0aCB4Y29kZSBgICtcbiAgICAgICAgICAgICAgICAgICAgYHZlcnNpb24gJHt4Y29kZVZlcnNpb24udmVyc2lvblN0cmluZ30gYnV0IG9ubHkgWGNvZGUgdmVyc2lvbiBgICtcbiAgICAgICAgICAgICAgICAgICAgYDYuMC4wIGFuZCB1cCBhcmUgc3VwcG9ydGVkYCk7XG4gIH1cbn1cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBTaW11bGF0b3JMb29rdXBPcHRpb25zXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHBsYXRmb3JtIFtpT1NdIC0gVGhlIG5hbWUgb2YgdGhlIHNpbXVsYXRvciBwbGF0Zm9ybVxuICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gY2hlY2tFeGlzdGVuY2UgW3RydWVdIC0gU2V0IGl0IHRvIGBmYWxzZWAgaW4gb3JkZXIgdG9cbiAqIHNraXAgc2ltdWxhdG9yIGV4aXN0ZW5jZSB2ZXJpZmljYXRpb25cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gZGV2aWNlc1NldFBhdGggLSBUaGUgZnVsbCBwYXRoIHRvIHRoZSBkZXZpY2VzIHNldCB3aGVyZVxuICogdGhlIGN1cnJlbnQgc2ltdWxhdG9yIGlzIGxvY2F0ZWQuIGBudWxsYCB2YWx1ZSBtZWFucyB0aGF0IHRoZSBkZWZhdWx0IHBhdGggaXNcbiAqIHVzZWQsIHdoaWNoIGlzIHVzdWFsbHkgYH4vTGlicmFyeS9EZXZlbG9wZXIvQ29yZVNpbXVsYXRvci9EZXZpY2VzYFxuICovXG5cbi8qKlxuICogRmluZHMgYW5kIHJldHVybnMgdGhlIGNvcnJlc3BvbmRpbmcgU2ltdWxhdG9yIGluc3RhbmNlIGZvciB0aGUgZ2l2ZW4gSUQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgSUQgb2YgYW4gZXhpc3RpbmcgU2ltdWxhdG9yLlxuICogQHBhcmFtIHs/U2ltdWxhdG9yTG9va3VwT3B0aW9uc30gb3B0c1xuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBTaW11bGF0b3Igd2l0aCBnaXZlbiB1ZGlkIGRvZXMgbm90IGV4aXN0IGluIGRldmljZXMgbGlzdC5cbiAqICAgSWYgeW91IHdhbnQgdG8gY3JlYXRlIGEgbmV3IHNpbXVsYXRvciwgeW91IGNhbiB1c2UgdGhlIGBjcmVhdGVEZXZpY2UoKWAgbWV0aG9kIG9mXG4gKiAgIFtub2RlLXNpbWN0bF0oZ2l0aHViLmNvbS9hcHBpdW0vbm9kZS1zaW1jdGwpLlxuICogQHJldHVybiB7b2JqZWN0fSBTaW11bGF0b3Igb2JqZWN0IGFzc29jaWF0ZWQgd2l0aCB0aGUgdWRpZCBwYXNzZWQgaW4uXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldFNpbXVsYXRvciAodWRpZCwgb3B0cyA9IHt9KSB7XG4gIGxldCB7XG4gICAgcGxhdGZvcm0gPSAnaU9TJyxcbiAgICBjaGVja0V4aXN0ZW5jZSA9IHRydWUsXG4gICAgZGV2aWNlc1NldFBhdGgsXG4gIH0gPSBvcHRzO1xuXG4gIGNvbnN0IHhjb2RlVmVyc2lvbiA9IGF3YWl0IHhjb2RlLmdldFZlcnNpb24odHJ1ZSk7XG4gIGlmIChjaGVja0V4aXN0ZW5jZSkge1xuICAgIGNvbnN0IHNpbXVsYXRvckluZm8gPSBhd2FpdCBnZXRTaW11bGF0b3JJbmZvKHVkaWQsIHtcbiAgICAgIGRldmljZXNTZXRQYXRoXG4gICAgfSk7XG5cbiAgICBpZiAoIXNpbXVsYXRvckluZm8pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gc2ltIGZvdW5kIHdpdGggdWRpZCAnJHt1ZGlkfSdgKTtcbiAgICB9XG5cbiAgICBwbGF0Zm9ybSA9IHNpbXVsYXRvckluZm8ucGxhdGZvcm07XG4gIH1cblxuICAvLyBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgcmlnaHQgbG9nZ2luZyBwcmVmaXhcbiAgc2V0TG9nZ2luZ1BsYXRmb3JtKHBsYXRmb3JtKTtcblxuICBsb2cuaW5mbyhgQ29uc3RydWN0aW5nICR7cGxhdGZvcm19IHNpbXVsYXRvciBmb3IgWGNvZGUgdmVyc2lvbiAke3hjb2RlVmVyc2lvbi52ZXJzaW9uU3RyaW5nfSBgICtcbiAgICAgICAgICAgYHdpdGggdWRpZCAnJHt1ZGlkfSdgKTtcbiAgbGV0IFNpbUNsYXNzO1xuICBzd2l0Y2ggKHhjb2RlVmVyc2lvbi5tYWpvcikge1xuICAgIC8vIEVhcmx5LCB1bnN1cHBvcnRlZCBYY29kZXNcbiAgICBjYXNlIDE6XG4gICAgY2FzZSAyOlxuICAgIGNhc2UgMzpcbiAgICBjYXNlIDQ6XG4gICAgY2FzZSA1OlxuICAgICAgaGFuZGxlVW5zdXBwb3J0ZWRYY29kZSh4Y29kZVZlcnNpb24pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSA2OlxuICAgICAgU2ltQ2xhc3MgPSBTaW11bGF0b3JYY29kZTY7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDc6XG4gICAgICBpZiAoeGNvZGVWZXJzaW9uLm1pbm9yIDwgMykge1xuICAgICAgICBTaW1DbGFzcyA9IFNpbXVsYXRvclhjb2RlNztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFNpbUNsYXNzID0gU2ltdWxhdG9yWGNvZGU3MztcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgODpcbiAgICAgIFNpbUNsYXNzID0gU2ltdWxhdG9yWGNvZGU4O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSA5OlxuICAgICAgaWYgKHhjb2RlVmVyc2lvbi5taW5vciA8IDMpIHtcbiAgICAgICAgU2ltQ2xhc3MgPSBTaW11bGF0b3JYY29kZTk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBTaW1DbGFzcyA9IFNpbXVsYXRvclhjb2RlOTM7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIDEwOlxuICAgICAgU2ltQ2xhc3MgPSBTaW11bGF0b3JYY29kZTEwO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAxMTpcbiAgICBjYXNlIDEyOlxuICAgIGRlZmF1bHQ6XG4gICAgICBpZiAoeGNvZGVWZXJzaW9uLm1ham9yID4gMTEgfHwgeGNvZGVWZXJzaW9uLm1pbm9yID49IDQpIHtcbiAgICAgICAgU2ltQ2xhc3MgPSBTaW11bGF0b3JYY29kZTExXzQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBTaW1DbGFzcyA9IFNpbXVsYXRvclhjb2RlMTE7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgfVxuXG4gIGNvbnN0IHJlc3VsdCA9IG5ldyBTaW1DbGFzcyh1ZGlkLCB4Y29kZVZlcnNpb24pO1xuICBpZiAoZGV2aWNlc1NldFBhdGgpIHtcbiAgICByZXN1bHQuZGV2aWNlc1NldFBhdGggPSBkZXZpY2VzU2V0UGF0aDtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIFRha2VzIGEgc2V0IG9mIG9wdGlvbnMgYW5kIGZpbmRzIHRoZSBjb3JyZWN0IGRldmljZSBzdHJpbmcgaW4gb3JkZXIgZm9yIEluc3RydW1lbnRzIHRvXG4gKiBpZGVudGlmeSB0aGUgY29ycmVjdCBzaW11bGF0b3IuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IG9wdHMgLSBUaGUgb3B0aW9ucyBhdmFpbGFibGUgYXJlOlxuICogICAtIGBkZXZpY2VOYW1lYCAtIGEgbmFtZSBmb3IgdGhlIGRldmljZS4gSWYgdGhlIGdpdmVuIGRldmljZSBuYW1lIHN0YXJ0cyB3aXRoIGA9YCwgdGhlIG5hbWUsIGxlc3MgdGhlIGVxdWFscyBzaWduLCBpcyByZXR1cm5lZC5cbiAqICAgLSBgcGxhdGZvcm1WZXJzaW9uYCAtIHRoZSB2ZXJzaW9uIG9mIGlPUyB0byB1c2UuIERlZmF1bHRzIHRvIHRoZSBjdXJyZW50IFhjb2RlJ3MgbWF4aW11bSBTREsgdmVyc2lvbi5cbiAqICAgLSBgZm9yY2VJcGhvbmVgIC0gZm9yY2UgdGhlIGNvbmZpZ3VyYXRpb24gb2YgdGhlIGRldmljZSBzdHJpbmcgdG8gaVBob25lLiBEZWZhdWx0cyB0byBgZmFsc2VgLlxuICogICAtIGBmb3JjZUlwYWRgIC0gZm9yY2UgdGhlIGNvbmZpZ3VyYXRpb24gb2YgdGhlIGRldmljZSBzdHJpbmcgdG8gaVBhZC4gRGVmYXVsdHMgdG8gYGZhbHNlYC5cbiAqICAgSWYgYm90aCBgZm9yY2VJcGhvbmVgIGFuZCBgZm9yY2VJcGFkYCBhcmUgdHJ1ZSwgdGhlIGRldmljZSB3aWxsIGJlIGZvcmNlZCB0byBpUGhvbmUuXG4gKlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgZm91bmQgZGV2aWNlIHN0cmluZywgZm9yIGV4YW1wbGU6XG4gKiAgICdpUGhvbmUgNSAoOC40KScgd2l0aCBYY29kZSA3K1xuICogICAnaVBob25lIDUgKDguNCBTaW11bGF0b3IpJyB3aXRoIFhjb2RlIDYrXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldERldmljZVN0cmluZyAob3B0cykge1xuICBsZXQgeGNvZGVWZXJzaW9uID0gYXdhaXQgeGNvZGUuZ2V0VmVyc2lvbih0cnVlKTtcblxuICBoYW5kbGVVbnN1cHBvcnRlZFhjb2RlKHhjb2RlVmVyc2lvbik7XG5cbiAgbG9nLmluZm8oYFJldHJpZXZpbmcgZGV2aWNlIG5hbWUgc3RyaW5nIGZvciBYY29kZSB2ZXJzaW9uICR7eGNvZGVWZXJzaW9uLnZlcnNpb25TdHJpbmd9YCk7XG4gIGlmICh4Y29kZVZlcnNpb24ubWFqb3IgPj0gOCkge1xuICAgIHJldHVybiBhd2FpdCBTaW11bGF0b3JYY29kZTcuZ2V0RGV2aWNlU3RyaW5nKG9wdHMpO1xuICB9IGVsc2UgaWYgKHhjb2RlVmVyc2lvbi5tYWpvciA9PT0gNykge1xuICAgIHJldHVybiBhd2FpdCBTaW11bGF0b3JYY29kZTcuZ2V0RGV2aWNlU3RyaW5nKG9wdHMpO1xuICB9IGVsc2UgaWYgKHhjb2RlVmVyc2lvbi5tYWpvciA9PT0gNikge1xuICAgIHJldHVybiBhd2FpdCBTaW11bGF0b3JYY29kZTYuZ2V0RGV2aWNlU3RyaW5nKG9wdHMpO1xuICB9XG59XG5cbmV4cG9ydCB7IGdldFNpbXVsYXRvciwgZ2V0RGV2aWNlU3RyaW5nIH07XG4iXSwiZmlsZSI6ImxpYi9zaW11bGF0b3IuanMiLCJzb3VyY2VSb290IjoiLi4vLi4ifQ==
