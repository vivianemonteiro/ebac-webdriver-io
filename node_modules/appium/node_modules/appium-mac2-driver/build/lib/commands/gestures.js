"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _appiumSupport = require("appium-support");

var _appiumBaseDriver = require("appium-base-driver");

const commands = {};

function extractUuid(options = {}, keyNames = ['elementId', 'element']) {
  for (const name of keyNames) {
    if (options[name]) {
      const result = _appiumSupport.util.unwrapElement(options[name]);

      if (result) {
        return result;
      }
    }
  }

  return null;
}

function requireUuid(options = {}, keyNames = ['elementId', 'element']) {
  const result = extractUuid(options, keyNames);

  if (!result) {
    throw new _appiumBaseDriver.errors.InvalidArgumentError(`${keyNames[0]} field is mandatory`);
  }

  return result;
}

commands.macosSetValue = async function macosSetValue(opts = {}) {
  const uuid = requireUuid(opts);
  const {
    value,
    text,
    keyModifierFlags
  } = opts;
  return await this.wda.proxy.command(`/element/${uuid}/value`, 'POST', {
    value,
    text,
    keyModifierFlags
  });
};

commands.macosClick = async function macosClick(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  const url = uuid ? `/element/${uuid}/click` : '/wda/click';
  return await this.wda.proxy.command(url, 'POST', {
    x,
    y,
    keyModifierFlags
  });
};

commands.macosScroll = async function macosScroll(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    deltaX,
    deltaY,
    keyModifierFlags
  } = opts;
  const url = uuid ? `/wda/element/${uuid}/scroll` : '/wda/scroll';
  return await this.wda.proxy.command(url, 'POST', {
    deltaX,
    deltaY,
    x,
    y,
    keyModifierFlags
  });
};

commands.macosSwipe = async function macosSwipe(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    direction,
    velocity,
    keyModifierFlags
  } = opts;
  const url = uuid ? `/wda/element/${uuid}/swipe` : `/wda/swipe`;
  return await this.wda.proxy.command(url, 'POST', {
    x,
    y,
    direction,
    velocity,
    keyModifierFlags
  });
};

commands.macosRightClick = async function macosRightClick(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  const url = uuid ? `/wda/element/${uuid}/rightClick` : '/wda/rightClick';
  return await this.wda.proxy.command(url, 'POST', {
    x,
    y,
    keyModifierFlags
  });
};

commands.macosHover = async function macosHover(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  const url = uuid ? `/wda/element/${uuid}/hover` : '/wda/hover';
  return await this.wda.proxy.command(url, 'POST', {
    x,
    y,
    keyModifierFlags
  });
};

commands.macosDoubleClick = async function macosDoubleClick(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  const url = uuid ? `/wda/element/${uuid}/doubleClick` : '/wda/doubleClick';
  return await this.wda.proxy.command(url, 'POST', {
    x,
    y,
    keyModifierFlags
  });
};

commands.macosClickAndDrag = async function macosClickAndDrag(opts = {}) {
  const sourceUuid = extractUuid(opts, ['sourceElementId', 'sourceElement']);
  const destUuid = extractUuid(opts, ['destinationElementId', 'destinationElement']);
  const {
    startX,
    startY,
    endX,
    endY,
    duration,
    keyModifierFlags
  } = opts;
  const url = sourceUuid && destUuid ? `/wda/element/${sourceUuid}/clickAndDrag` : '/wda/clickAndDrag';

  const dest = destUuid && _appiumSupport.util.wrapElement(destUuid);

  return await this.wda.proxy.command(url, 'POST', {
    startX,
    startY,
    endX,
    endY,
    duration,
    dest,
    keyModifierFlags
  });
};

commands.macosClickAndDragAndHold = async function macosClickAndDragAndHold(opts = {}) {
  const sourceUuid = extractUuid(opts, ['sourceElementId', 'sourceElement']);
  const destUuid = extractUuid(opts, ['destinationElementId', 'destinationElement']);
  const {
    startX,
    startY,
    endX,
    endY,
    duration,
    holdDuration,
    velocity,
    keyModifierFlags
  } = opts;
  const url = sourceUuid && destUuid ? `/wda/element/${sourceUuid}/clickAndDragAndHold` : '/wda/clickAndDragAndHold';

  const dest = destUuid && _appiumSupport.util.wrapElement(destUuid);

  return await this.wda.proxy.command(url, 'POST', {
    startX,
    startY,
    endX,
    endY,
    duration,
    holdDuration,
    velocity,
    dest,
    keyModifierFlags
  });
};

commands.macosKeys = async function macosKeys(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    keys
  } = opts;
  const url = uuid ? `/wda/element/${uuid}/keys` : '/wda/keys';
  return await this.wda.proxy.command(url, 'POST', {
    keys
  });
};

commands.macosPressAndHold = async function macosPressAndHold(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    duration,
    keyModifierFlags
  } = opts;
  const url = uuid ? `/wda/element/${uuid}/press` : '/wda/press';
  return await this.wda.proxy.command(url, 'POST', {
    x,
    y,
    duration,
    keyModifierFlags
  });
};

commands.macosTap = async function macosTap(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  const url = uuid ? `/wda/element/${uuid}/tap` : '/wda/tap';
  return await this.wda.proxy.command(url, 'POST', {
    x,
    y,
    keyModifierFlags
  });
};

commands.macosDoubleTap = async function macosDoubleTap(opts = {}) {
  const uuid = extractUuid(opts);
  const {
    x,
    y,
    keyModifierFlags
  } = opts;
  const url = uuid ? `/wda/element/${uuid}/doubleTap` : '/wda/doubleTap';
  return await this.wda.proxy.command(url, 'POST', {
    x,
    y,
    keyModifierFlags
  });
};

commands.macosPressAndDrag = async function macosPressAndDrag(opts = {}) {
  const sourceUuid = extractUuid(opts, ['sourceElementId', 'sourceElement']);
  const destUuid = extractUuid(opts, ['destinationElementId', 'destinationElement']);
  const {
    startX,
    startY,
    endX,
    endY,
    duration,
    keyModifierFlags
  } = opts;
  const url = sourceUuid && destUuid ? `/wda/element/${sourceUuid}/pressAndDrag` : '/wda/pressAndDrag';

  const dest = destUuid && _appiumSupport.util.wrapElement(destUuid);

  return await this.wda.proxy.command(url, 'POST', {
    startX,
    startY,
    endX,
    endY,
    duration,
    dest,
    keyModifierFlags
  });
};

commands.macosPressAndDragAndHold = async function macosPressAndDragAndHold(opts = {}) {
  const sourceUuid = extractUuid(opts, ['sourceElementId', 'sourceElement']);
  const destUuid = extractUuid(opts, ['destinationElementId', 'destinationElement']);
  const {
    startX,
    startY,
    endX,
    endY,
    duration,
    holdDuration,
    velocity,
    keyModifierFlags
  } = opts;
  const url = sourceUuid && destUuid ? `/wda/element/${sourceUuid}/pressAndDragAndHold` : '/wda/pressAndDragAndHold';

  const dest = destUuid && _appiumSupport.util.wrapElement(destUuid);

  return await this.wda.proxy.command(url, 'POST', {
    startX,
    startY,
    endX,
    endY,
    duration,
    holdDuration,
    velocity,
    dest,
    keyModifierFlags
  });
};

var _default = commands;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9nZXN0dXJlcy5qcyJdLCJuYW1lcyI6WyJjb21tYW5kcyIsImV4dHJhY3RVdWlkIiwib3B0aW9ucyIsImtleU5hbWVzIiwibmFtZSIsInJlc3VsdCIsInV0aWwiLCJ1bndyYXBFbGVtZW50IiwicmVxdWlyZVV1aWQiLCJlcnJvcnMiLCJJbnZhbGlkQXJndW1lbnRFcnJvciIsIm1hY29zU2V0VmFsdWUiLCJvcHRzIiwidXVpZCIsInZhbHVlIiwidGV4dCIsImtleU1vZGlmaWVyRmxhZ3MiLCJ3ZGEiLCJwcm94eSIsImNvbW1hbmQiLCJtYWNvc0NsaWNrIiwieCIsInkiLCJ1cmwiLCJtYWNvc1Njcm9sbCIsImRlbHRhWCIsImRlbHRhWSIsIm1hY29zU3dpcGUiLCJkaXJlY3Rpb24iLCJ2ZWxvY2l0eSIsIm1hY29zUmlnaHRDbGljayIsIm1hY29zSG92ZXIiLCJtYWNvc0RvdWJsZUNsaWNrIiwibWFjb3NDbGlja0FuZERyYWciLCJzb3VyY2VVdWlkIiwiZGVzdFV1aWQiLCJzdGFydFgiLCJzdGFydFkiLCJlbmRYIiwiZW5kWSIsImR1cmF0aW9uIiwiZGVzdCIsIndyYXBFbGVtZW50IiwibWFjb3NDbGlja0FuZERyYWdBbmRIb2xkIiwiaG9sZER1cmF0aW9uIiwibWFjb3NLZXlzIiwia2V5cyIsIm1hY29zUHJlc3NBbmRIb2xkIiwibWFjb3NUYXAiLCJtYWNvc0RvdWJsZVRhcCIsIm1hY29zUHJlc3NBbmREcmFnIiwibWFjb3NQcmVzc0FuZERyYWdBbmRIb2xkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQSxNQUFNQSxRQUFRLEdBQUcsRUFBakI7O0FBRUEsU0FBU0MsV0FBVCxDQUFzQkMsT0FBTyxHQUFHLEVBQWhDLEVBQW9DQyxRQUFRLEdBQUcsQ0FBQyxXQUFELEVBQWMsU0FBZCxDQUEvQyxFQUF5RTtBQUN2RSxPQUFLLE1BQU1DLElBQVgsSUFBbUJELFFBQW5CLEVBQTZCO0FBQzNCLFFBQUlELE9BQU8sQ0FBQ0UsSUFBRCxDQUFYLEVBQW1CO0FBQ2pCLFlBQU1DLE1BQU0sR0FBR0Msb0JBQUtDLGFBQUwsQ0FBbUJMLE9BQU8sQ0FBQ0UsSUFBRCxDQUExQixDQUFmOztBQUNBLFVBQUlDLE1BQUosRUFBWTtBQUNWLGVBQU9BLE1BQVA7QUFDRDtBQUNGO0FBQ0Y7O0FBQ0QsU0FBTyxJQUFQO0FBQ0Q7O0FBRUQsU0FBU0csV0FBVCxDQUFzQk4sT0FBTyxHQUFHLEVBQWhDLEVBQW9DQyxRQUFRLEdBQUcsQ0FBQyxXQUFELEVBQWMsU0FBZCxDQUEvQyxFQUF5RTtBQUN2RSxRQUFNRSxNQUFNLEdBQUdKLFdBQVcsQ0FBQ0MsT0FBRCxFQUFVQyxRQUFWLENBQTFCOztBQUNBLE1BQUksQ0FBQ0UsTUFBTCxFQUFhO0FBQ1gsVUFBTSxJQUFJSSx5QkFBT0Msb0JBQVgsQ0FBaUMsR0FBRVAsUUFBUSxDQUFDLENBQUQsQ0FBSSxxQkFBL0MsQ0FBTjtBQUNEOztBQUNELFNBQU9FLE1BQVA7QUFDRDs7QUFvQkRMLFFBQVEsQ0FBQ1csYUFBVCxHQUF5QixlQUFlQSxhQUFmLENBQThCQyxJQUFJLEdBQUcsRUFBckMsRUFBeUM7QUFDaEUsUUFBTUMsSUFBSSxHQUFHTCxXQUFXLENBQUNJLElBQUQsQ0FBeEI7QUFDQSxRQUFNO0FBQUVFLElBQUFBLEtBQUY7QUFBU0MsSUFBQUEsSUFBVDtBQUFlQyxJQUFBQTtBQUFmLE1BQW9DSixJQUExQztBQUNBLFNBQU8sTUFBTSxLQUFLSyxHQUFMLENBQVNDLEtBQVQsQ0FBZUMsT0FBZixDQUF3QixZQUFXTixJQUFLLFFBQXhDLEVBQWlELE1BQWpELEVBQXlEO0FBQ3BFQyxJQUFBQSxLQURvRTtBQUM3REMsSUFBQUEsSUFENkQ7QUFFcEVDLElBQUFBO0FBRm9FLEdBQXpELENBQWI7QUFJRCxDQVBEOztBQTRCQWhCLFFBQVEsQ0FBQ29CLFVBQVQsR0FBc0IsZUFBZUEsVUFBZixDQUEyQlIsSUFBSSxHQUFHLEVBQWxDLEVBQXNDO0FBQzFELFFBQU1DLElBQUksR0FBR1osV0FBVyxDQUFDVyxJQUFELENBQXhCO0FBQ0EsUUFBTTtBQUFFUyxJQUFBQSxDQUFGO0FBQUtDLElBQUFBLENBQUw7QUFBUU4sSUFBQUE7QUFBUixNQUE2QkosSUFBbkM7QUFDQSxRQUFNVyxHQUFHLEdBQUdWLElBQUksR0FBSSxZQUFXQSxJQUFLLFFBQXBCLEdBQThCLFlBQTlDO0FBQ0EsU0FBTyxNQUFNLEtBQUtJLEdBQUwsQ0FBU0MsS0FBVCxDQUFlQyxPQUFmLENBQXVCSSxHQUF2QixFQUE0QixNQUE1QixFQUFvQztBQUMvQ0YsSUFBQUEsQ0FEK0M7QUFDNUNDLElBQUFBLENBRDRDO0FBRS9DTixJQUFBQTtBQUYrQyxHQUFwQyxDQUFiO0FBSUQsQ0FSRDs7QUErQkFoQixRQUFRLENBQUN3QixXQUFULEdBQXVCLGVBQWVBLFdBQWYsQ0FBNEJaLElBQUksR0FBRyxFQUFuQyxFQUF1QztBQUM1RCxRQUFNQyxJQUFJLEdBQUdaLFdBQVcsQ0FBQ1csSUFBRCxDQUF4QjtBQUNBLFFBQU07QUFDSlMsSUFBQUEsQ0FESTtBQUNEQyxJQUFBQSxDQURDO0FBRUpHLElBQUFBLE1BRkk7QUFFSUMsSUFBQUEsTUFGSjtBQUdKVixJQUFBQTtBQUhJLE1BSUZKLElBSko7QUFLQSxRQUFNVyxHQUFHLEdBQUdWLElBQUksR0FBSSxnQkFBZUEsSUFBSyxTQUF4QixHQUFtQyxhQUFuRDtBQUNBLFNBQU8sTUFBTSxLQUFLSSxHQUFMLENBQVNDLEtBQVQsQ0FBZUMsT0FBZixDQUF1QkksR0FBdkIsRUFBNEIsTUFBNUIsRUFBb0M7QUFDL0NFLElBQUFBLE1BRCtDO0FBQ3ZDQyxJQUFBQSxNQUR1QztBQUUvQ0wsSUFBQUEsQ0FGK0M7QUFFNUNDLElBQUFBLENBRjRDO0FBRy9DTixJQUFBQTtBQUgrQyxHQUFwQyxDQUFiO0FBS0QsQ0FiRDs7QUF3Q0FoQixRQUFRLENBQUMyQixVQUFULEdBQXNCLGVBQWVBLFVBQWYsQ0FBMkJmLElBQUksR0FBRyxFQUFsQyxFQUFzQztBQUMxRCxRQUFNQyxJQUFJLEdBQUdaLFdBQVcsQ0FBQ1csSUFBRCxDQUF4QjtBQUNBLFFBQU07QUFDSlMsSUFBQUEsQ0FESTtBQUNEQyxJQUFBQSxDQURDO0FBRUpNLElBQUFBLFNBRkk7QUFHSkMsSUFBQUEsUUFISTtBQUlKYixJQUFBQTtBQUpJLE1BS0ZKLElBTEo7QUFNQSxRQUFNVyxHQUFHLEdBQUdWLElBQUksR0FBSSxnQkFBZUEsSUFBSyxRQUF4QixHQUFtQyxZQUFuRDtBQUNBLFNBQU8sTUFBTSxLQUFLSSxHQUFMLENBQVNDLEtBQVQsQ0FBZUMsT0FBZixDQUF1QkksR0FBdkIsRUFBNEIsTUFBNUIsRUFBb0M7QUFDL0NGLElBQUFBLENBRCtDO0FBQzVDQyxJQUFBQSxDQUQ0QztBQUUvQ00sSUFBQUEsU0FGK0M7QUFHL0NDLElBQUFBLFFBSCtDO0FBSS9DYixJQUFBQTtBQUorQyxHQUFwQyxDQUFiO0FBTUQsQ0FmRDs7QUFvQ0FoQixRQUFRLENBQUM4QixlQUFULEdBQTJCLGVBQWVBLGVBQWYsQ0FBZ0NsQixJQUFJLEdBQUcsRUFBdkMsRUFBMkM7QUFDcEUsUUFBTUMsSUFBSSxHQUFHWixXQUFXLENBQUNXLElBQUQsQ0FBeEI7QUFDQSxRQUFNO0FBQUVTLElBQUFBLENBQUY7QUFBS0MsSUFBQUEsQ0FBTDtBQUFRTixJQUFBQTtBQUFSLE1BQTZCSixJQUFuQztBQUNBLFFBQU1XLEdBQUcsR0FBR1YsSUFBSSxHQUFJLGdCQUFlQSxJQUFLLGFBQXhCLEdBQXVDLGlCQUF2RDtBQUNBLFNBQU8sTUFBTSxLQUFLSSxHQUFMLENBQVNDLEtBQVQsQ0FBZUMsT0FBZixDQUF1QkksR0FBdkIsRUFBNEIsTUFBNUIsRUFBb0M7QUFDL0NGLElBQUFBLENBRCtDO0FBQzVDQyxJQUFBQSxDQUQ0QztBQUUvQ04sSUFBQUE7QUFGK0MsR0FBcEMsQ0FBYjtBQUlELENBUkQ7O0FBNkJBaEIsUUFBUSxDQUFDK0IsVUFBVCxHQUFzQixlQUFlQSxVQUFmLENBQTJCbkIsSUFBSSxHQUFHLEVBQWxDLEVBQXNDO0FBQzFELFFBQU1DLElBQUksR0FBR1osV0FBVyxDQUFDVyxJQUFELENBQXhCO0FBQ0EsUUFBTTtBQUFFUyxJQUFBQSxDQUFGO0FBQUtDLElBQUFBLENBQUw7QUFBUU4sSUFBQUE7QUFBUixNQUE2QkosSUFBbkM7QUFDQSxRQUFNVyxHQUFHLEdBQUdWLElBQUksR0FBSSxnQkFBZUEsSUFBSyxRQUF4QixHQUFrQyxZQUFsRDtBQUNBLFNBQU8sTUFBTSxLQUFLSSxHQUFMLENBQVNDLEtBQVQsQ0FBZUMsT0FBZixDQUF1QkksR0FBdkIsRUFBNEIsTUFBNUIsRUFBb0M7QUFDL0NGLElBQUFBLENBRCtDO0FBQzVDQyxJQUFBQSxDQUQ0QztBQUUvQ04sSUFBQUE7QUFGK0MsR0FBcEMsQ0FBYjtBQUlELENBUkQ7O0FBNkJBaEIsUUFBUSxDQUFDZ0MsZ0JBQVQsR0FBNEIsZUFBZUEsZ0JBQWYsQ0FBaUNwQixJQUFJLEdBQUcsRUFBeEMsRUFBNEM7QUFDdEUsUUFBTUMsSUFBSSxHQUFHWixXQUFXLENBQUNXLElBQUQsQ0FBeEI7QUFDQSxRQUFNO0FBQUVTLElBQUFBLENBQUY7QUFBS0MsSUFBQUEsQ0FBTDtBQUFRTixJQUFBQTtBQUFSLE1BQTZCSixJQUFuQztBQUNBLFFBQU1XLEdBQUcsR0FBR1YsSUFBSSxHQUFJLGdCQUFlQSxJQUFLLGNBQXhCLEdBQXdDLGtCQUF4RDtBQUNBLFNBQU8sTUFBTSxLQUFLSSxHQUFMLENBQVNDLEtBQVQsQ0FBZUMsT0FBZixDQUF1QkksR0FBdkIsRUFBNEIsTUFBNUIsRUFBb0M7QUFDL0NGLElBQUFBLENBRCtDO0FBQzVDQyxJQUFBQSxDQUQ0QztBQUUvQ04sSUFBQUE7QUFGK0MsR0FBcEMsQ0FBYjtBQUlELENBUkQ7O0FBa0NBaEIsUUFBUSxDQUFDaUMsaUJBQVQsR0FBNkIsZUFBZUEsaUJBQWYsQ0FBa0NyQixJQUFJLEdBQUcsRUFBekMsRUFBNkM7QUFDeEUsUUFBTXNCLFVBQVUsR0FBR2pDLFdBQVcsQ0FBQ1csSUFBRCxFQUFPLENBQUMsaUJBQUQsRUFBb0IsZUFBcEIsQ0FBUCxDQUE5QjtBQUNBLFFBQU11QixRQUFRLEdBQUdsQyxXQUFXLENBQUNXLElBQUQsRUFBTyxDQUFDLHNCQUFELEVBQXlCLG9CQUF6QixDQUFQLENBQTVCO0FBQ0EsUUFBTTtBQUNKd0IsSUFBQUEsTUFESTtBQUNJQyxJQUFBQSxNQURKO0FBRUpDLElBQUFBLElBRkk7QUFFRUMsSUFBQUEsSUFGRjtBQUdKQyxJQUFBQSxRQUhJO0FBSUp4QixJQUFBQTtBQUpJLE1BS0ZKLElBTEo7QUFNQSxRQUFNVyxHQUFHLEdBQUdXLFVBQVUsSUFBSUMsUUFBZCxHQUNQLGdCQUFlRCxVQUFXLGVBRG5CLEdBRVIsbUJBRko7O0FBR0EsUUFBTU8sSUFBSSxHQUFHTixRQUFRLElBQUk3QixvQkFBS29DLFdBQUwsQ0FBaUJQLFFBQWpCLENBQXpCOztBQUNBLFNBQU8sTUFBTSxLQUFLbEIsR0FBTCxDQUFTQyxLQUFULENBQWVDLE9BQWYsQ0FBdUJJLEdBQXZCLEVBQTRCLE1BQTVCLEVBQW9DO0FBQy9DYSxJQUFBQSxNQUQrQztBQUN2Q0MsSUFBQUEsTUFEdUM7QUFFL0NDLElBQUFBLElBRitDO0FBRXpDQyxJQUFBQSxJQUZ5QztBQUcvQ0MsSUFBQUEsUUFIK0M7QUFJL0NDLElBQUFBLElBSitDO0FBSy9DekIsSUFBQUE7QUFMK0MsR0FBcEMsQ0FBYjtBQU9ELENBcEJEOztBQWtEQWhCLFFBQVEsQ0FBQzJDLHdCQUFULEdBQW9DLGVBQWVBLHdCQUFmLENBQXlDL0IsSUFBSSxHQUFHLEVBQWhELEVBQW9EO0FBQ3RGLFFBQU1zQixVQUFVLEdBQUdqQyxXQUFXLENBQUNXLElBQUQsRUFBTyxDQUFDLGlCQUFELEVBQW9CLGVBQXBCLENBQVAsQ0FBOUI7QUFDQSxRQUFNdUIsUUFBUSxHQUFHbEMsV0FBVyxDQUFDVyxJQUFELEVBQU8sQ0FBQyxzQkFBRCxFQUF5QixvQkFBekIsQ0FBUCxDQUE1QjtBQUNBLFFBQU07QUFDSndCLElBQUFBLE1BREk7QUFDSUMsSUFBQUEsTUFESjtBQUVKQyxJQUFBQSxJQUZJO0FBRUVDLElBQUFBLElBRkY7QUFHSkMsSUFBQUEsUUFISTtBQUdNSSxJQUFBQSxZQUhOO0FBSUpmLElBQUFBLFFBSkk7QUFLSmIsSUFBQUE7QUFMSSxNQU1GSixJQU5KO0FBT0EsUUFBTVcsR0FBRyxHQUFHVyxVQUFVLElBQUlDLFFBQWQsR0FDUCxnQkFBZUQsVUFBVyxzQkFEbkIsR0FFUiwwQkFGSjs7QUFHQSxRQUFNTyxJQUFJLEdBQUdOLFFBQVEsSUFBSTdCLG9CQUFLb0MsV0FBTCxDQUFpQlAsUUFBakIsQ0FBekI7O0FBQ0EsU0FBTyxNQUFNLEtBQUtsQixHQUFMLENBQVNDLEtBQVQsQ0FBZUMsT0FBZixDQUF1QkksR0FBdkIsRUFBNEIsTUFBNUIsRUFBb0M7QUFDL0NhLElBQUFBLE1BRCtDO0FBQ3ZDQyxJQUFBQSxNQUR1QztBQUUvQ0MsSUFBQUEsSUFGK0M7QUFFekNDLElBQUFBLElBRnlDO0FBRy9DQyxJQUFBQSxRQUgrQztBQUdyQ0ksSUFBQUEsWUFIcUM7QUFJL0NmLElBQUFBLFFBSitDO0FBSy9DWSxJQUFBQSxJQUwrQztBQU0vQ3pCLElBQUFBO0FBTitDLEdBQXBDLENBQWI7QUFRRCxDQXRCRDs7QUFrREFoQixRQUFRLENBQUM2QyxTQUFULEdBQXFCLGVBQWVBLFNBQWYsQ0FBMEJqQyxJQUFJLEdBQUcsRUFBakMsRUFBcUM7QUFDeEQsUUFBTUMsSUFBSSxHQUFHWixXQUFXLENBQUNXLElBQUQsQ0FBeEI7QUFDQSxRQUFNO0FBQUVrQyxJQUFBQTtBQUFGLE1BQVdsQyxJQUFqQjtBQUNBLFFBQU1XLEdBQUcsR0FBR1YsSUFBSSxHQUFJLGdCQUFlQSxJQUFLLE9BQXhCLEdBQWlDLFdBQWpEO0FBQ0EsU0FBTyxNQUFNLEtBQUtJLEdBQUwsQ0FBU0MsS0FBVCxDQUFlQyxPQUFmLENBQXVCSSxHQUF2QixFQUE0QixNQUE1QixFQUFvQztBQUFFdUIsSUFBQUE7QUFBRixHQUFwQyxDQUFiO0FBQ0QsQ0FMRDs7QUEyQkE5QyxRQUFRLENBQUMrQyxpQkFBVCxHQUE2QixlQUFlQSxpQkFBZixDQUFrQ25DLElBQUksR0FBRyxFQUF6QyxFQUE2QztBQUN4RSxRQUFNQyxJQUFJLEdBQUdaLFdBQVcsQ0FBQ1csSUFBRCxDQUF4QjtBQUNBLFFBQU07QUFBRVMsSUFBQUEsQ0FBRjtBQUFLQyxJQUFBQSxDQUFMO0FBQVFrQixJQUFBQSxRQUFSO0FBQWtCeEIsSUFBQUE7QUFBbEIsTUFBdUNKLElBQTdDO0FBQ0EsUUFBTVcsR0FBRyxHQUFHVixJQUFJLEdBQUksZ0JBQWVBLElBQUssUUFBeEIsR0FBa0MsWUFBbEQ7QUFDQSxTQUFPLE1BQU0sS0FBS0ksR0FBTCxDQUFTQyxLQUFULENBQWVDLE9BQWYsQ0FBdUJJLEdBQXZCLEVBQTRCLE1BQTVCLEVBQW9DO0FBQy9DRixJQUFBQSxDQUQrQztBQUM1Q0MsSUFBQUEsQ0FENEM7QUFFL0NrQixJQUFBQSxRQUYrQztBQUcvQ3hCLElBQUFBO0FBSCtDLEdBQXBDLENBQWI7QUFLRCxDQVREOztBQThCQWhCLFFBQVEsQ0FBQ2dELFFBQVQsR0FBb0IsZUFBZUEsUUFBZixDQUF5QnBDLElBQUksR0FBRyxFQUFoQyxFQUFvQztBQUN0RCxRQUFNQyxJQUFJLEdBQUdaLFdBQVcsQ0FBQ1csSUFBRCxDQUF4QjtBQUNBLFFBQU07QUFBRVMsSUFBQUEsQ0FBRjtBQUFLQyxJQUFBQSxDQUFMO0FBQVFOLElBQUFBO0FBQVIsTUFBNkJKLElBQW5DO0FBQ0EsUUFBTVcsR0FBRyxHQUFHVixJQUFJLEdBQUksZ0JBQWVBLElBQUssTUFBeEIsR0FBZ0MsVUFBaEQ7QUFDQSxTQUFPLE1BQU0sS0FBS0ksR0FBTCxDQUFTQyxLQUFULENBQWVDLE9BQWYsQ0FBdUJJLEdBQXZCLEVBQTRCLE1BQTVCLEVBQW9DO0FBQy9DRixJQUFBQSxDQUQrQztBQUM1Q0MsSUFBQUEsQ0FENEM7QUFFL0NOLElBQUFBO0FBRitDLEdBQXBDLENBQWI7QUFJRCxDQVJEOztBQTZCQWhCLFFBQVEsQ0FBQ2lELGNBQVQsR0FBMEIsZUFBZUEsY0FBZixDQUErQnJDLElBQUksR0FBRyxFQUF0QyxFQUEwQztBQUNsRSxRQUFNQyxJQUFJLEdBQUdaLFdBQVcsQ0FBQ1csSUFBRCxDQUF4QjtBQUNBLFFBQU07QUFBRVMsSUFBQUEsQ0FBRjtBQUFLQyxJQUFBQSxDQUFMO0FBQVFOLElBQUFBO0FBQVIsTUFBNkJKLElBQW5DO0FBQ0EsUUFBTVcsR0FBRyxHQUFHVixJQUFJLEdBQUksZ0JBQWVBLElBQUssWUFBeEIsR0FBc0MsZ0JBQXREO0FBQ0EsU0FBTyxNQUFNLEtBQUtJLEdBQUwsQ0FBU0MsS0FBVCxDQUFlQyxPQUFmLENBQXVCSSxHQUF2QixFQUE0QixNQUE1QixFQUFvQztBQUMvQ0YsSUFBQUEsQ0FEK0M7QUFDNUNDLElBQUFBLENBRDRDO0FBRS9DTixJQUFBQTtBQUYrQyxHQUFwQyxDQUFiO0FBSUQsQ0FSRDs7QUFrQ0FoQixRQUFRLENBQUNrRCxpQkFBVCxHQUE2QixlQUFlQSxpQkFBZixDQUFrQ3RDLElBQUksR0FBRyxFQUF6QyxFQUE2QztBQUN4RSxRQUFNc0IsVUFBVSxHQUFHakMsV0FBVyxDQUFDVyxJQUFELEVBQU8sQ0FBQyxpQkFBRCxFQUFvQixlQUFwQixDQUFQLENBQTlCO0FBQ0EsUUFBTXVCLFFBQVEsR0FBR2xDLFdBQVcsQ0FBQ1csSUFBRCxFQUFPLENBQUMsc0JBQUQsRUFBeUIsb0JBQXpCLENBQVAsQ0FBNUI7QUFDQSxRQUFNO0FBQ0p3QixJQUFBQSxNQURJO0FBQ0lDLElBQUFBLE1BREo7QUFFSkMsSUFBQUEsSUFGSTtBQUVFQyxJQUFBQSxJQUZGO0FBR0pDLElBQUFBLFFBSEk7QUFJSnhCLElBQUFBO0FBSkksTUFLRkosSUFMSjtBQU1BLFFBQU1XLEdBQUcsR0FBR1csVUFBVSxJQUFJQyxRQUFkLEdBQ1AsZ0JBQWVELFVBQVcsZUFEbkIsR0FFUixtQkFGSjs7QUFHQSxRQUFNTyxJQUFJLEdBQUdOLFFBQVEsSUFBSTdCLG9CQUFLb0MsV0FBTCxDQUFpQlAsUUFBakIsQ0FBekI7O0FBQ0EsU0FBTyxNQUFNLEtBQUtsQixHQUFMLENBQVNDLEtBQVQsQ0FBZUMsT0FBZixDQUF1QkksR0FBdkIsRUFBNEIsTUFBNUIsRUFBb0M7QUFDL0NhLElBQUFBLE1BRCtDO0FBQ3ZDQyxJQUFBQSxNQUR1QztBQUUvQ0MsSUFBQUEsSUFGK0M7QUFFekNDLElBQUFBLElBRnlDO0FBRy9DQyxJQUFBQSxRQUgrQztBQUkvQ0MsSUFBQUEsSUFKK0M7QUFLL0N6QixJQUFBQTtBQUwrQyxHQUFwQyxDQUFiO0FBT0QsQ0FwQkQ7O0FBa0RBaEIsUUFBUSxDQUFDbUQsd0JBQVQsR0FBb0MsZUFBZUEsd0JBQWYsQ0FBeUN2QyxJQUFJLEdBQUcsRUFBaEQsRUFBb0Q7QUFDdEYsUUFBTXNCLFVBQVUsR0FBR2pDLFdBQVcsQ0FBQ1csSUFBRCxFQUFPLENBQUMsaUJBQUQsRUFBb0IsZUFBcEIsQ0FBUCxDQUE5QjtBQUNBLFFBQU11QixRQUFRLEdBQUdsQyxXQUFXLENBQUNXLElBQUQsRUFBTyxDQUFDLHNCQUFELEVBQXlCLG9CQUF6QixDQUFQLENBQTVCO0FBQ0EsUUFBTTtBQUNKd0IsSUFBQUEsTUFESTtBQUNJQyxJQUFBQSxNQURKO0FBRUpDLElBQUFBLElBRkk7QUFFRUMsSUFBQUEsSUFGRjtBQUdKQyxJQUFBQSxRQUhJO0FBR01JLElBQUFBLFlBSE47QUFJSmYsSUFBQUEsUUFKSTtBQUtKYixJQUFBQTtBQUxJLE1BTUZKLElBTko7QUFPQSxRQUFNVyxHQUFHLEdBQUdXLFVBQVUsSUFBSUMsUUFBZCxHQUNQLGdCQUFlRCxVQUFXLHNCQURuQixHQUVSLDBCQUZKOztBQUdBLFFBQU1PLElBQUksR0FBR04sUUFBUSxJQUFJN0Isb0JBQUtvQyxXQUFMLENBQWlCUCxRQUFqQixDQUF6Qjs7QUFDQSxTQUFPLE1BQU0sS0FBS2xCLEdBQUwsQ0FBU0MsS0FBVCxDQUFlQyxPQUFmLENBQXVCSSxHQUF2QixFQUE0QixNQUE1QixFQUFvQztBQUMvQ2EsSUFBQUEsTUFEK0M7QUFDdkNDLElBQUFBLE1BRHVDO0FBRS9DQyxJQUFBQSxJQUYrQztBQUV6Q0MsSUFBQUEsSUFGeUM7QUFHL0NDLElBQUFBLFFBSCtDO0FBR3JDSSxJQUFBQSxZQUhxQztBQUkvQ2YsSUFBQUEsUUFKK0M7QUFLL0NZLElBQUFBLElBTCtDO0FBTS9DekIsSUFBQUE7QUFOK0MsR0FBcEMsQ0FBYjtBQVFELENBdEJEOztlQXdCZWhCLFEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1dGlsIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuaW1wb3J0IHsgZXJyb3JzIH0gZnJvbSAnYXBwaXVtLWJhc2UtZHJpdmVyJztcblxuY29uc3QgY29tbWFuZHMgPSB7fTtcblxuZnVuY3Rpb24gZXh0cmFjdFV1aWQgKG9wdGlvbnMgPSB7fSwga2V5TmFtZXMgPSBbJ2VsZW1lbnRJZCcsICdlbGVtZW50J10pIHtcbiAgZm9yIChjb25zdCBuYW1lIG9mIGtleU5hbWVzKSB7XG4gICAgaWYgKG9wdGlvbnNbbmFtZV0pIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHV0aWwudW53cmFwRWxlbWVudChvcHRpb25zW25hbWVdKTtcbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIHJlcXVpcmVVdWlkIChvcHRpb25zID0ge30sIGtleU5hbWVzID0gWydlbGVtZW50SWQnLCAnZWxlbWVudCddKSB7XG4gIGNvbnN0IHJlc3VsdCA9IGV4dHJhY3RVdWlkKG9wdGlvbnMsIGtleU5hbWVzKTtcbiAgaWYgKCFyZXN1bHQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkludmFsaWRBcmd1bWVudEVycm9yKGAke2tleU5hbWVzWzBdfSBmaWVsZCBpcyBtYW5kYXRvcnlgKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU2V0VmFsdWVPcHRpb25zXG4gKiBAcHJvcGVydHkgeyFzdHJpbmd9IGVsZW1lbnRJZCB1dWlkIG9mIHRoZSBlbGVtZW50IHRvIHNldCB2YWx1ZSBmb3JcbiAqIEBwcm9wZXJ0eSB7Kn0gdmFsdWUgdmFsdWUgdG8gc2V0LiBDb3VsZCBhbHNvIGJlIGFuIGFycmF5XG4gKiBAcHJvcGVydHkge3N0cmluZ30gdGV4dCB0ZXh0IHRvIHNldC4gSWYgYm90aCB2YWx1ZSBhbmQgdGV4dCBhcmUgc2V0XG4gKiB0aGVuIGB2YWx1ZWAgaXMgcHJlZmVycmVkXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGtleU1vZGlmaWVyRmxhZ3MgaWYgc2V0IHRoZW4gdGhlIGdpdmVuIGtleSBtb2RpZmllcnMgd2lsbCBiZVxuICogYXBwbGllZCB3aGlsZSB0aGUgZWxlbWVudCB2YWx1ZSBpcyBiZWluZyBzZXQuIFNlZVxuICogaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24veGN0ZXN0L3hjdWlrZXltb2RpZmllcmZsYWdzXG4gKiBmb3IgbW9yZSBkZXRhaWxzXG4gKi9cblxuLyoqXG4gKiBTZXQgdmFsdWUgdG8gdGhlIGdpdmVuIGVsZW1lbnRcbiAqXG4gKiBAcGFyYW0ge1NldFZhbHVlT3B0aW9uc30gb3B0c1xuICovXG5jb21tYW5kcy5tYWNvc1NldFZhbHVlID0gYXN5bmMgZnVuY3Rpb24gbWFjb3NTZXRWYWx1ZSAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHV1aWQgPSByZXF1aXJlVXVpZChvcHRzKTtcbiAgY29uc3QgeyB2YWx1ZSwgdGV4dCwga2V5TW9kaWZpZXJGbGFncyB9ID0gb3B0cztcbiAgcmV0dXJuIGF3YWl0IHRoaXMud2RhLnByb3h5LmNvbW1hbmQoYC9lbGVtZW50LyR7dXVpZH0vdmFsdWVgLCAnUE9TVCcsIHtcbiAgICB2YWx1ZSwgdGV4dCxcbiAgICBrZXlNb2RpZmllckZsYWdzLFxuICB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQ2xpY2tPcHRpb25zXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGVsZW1lbnRJZCB1dWlkIG9mIHRoZSBlbGVtZW50IHRvIGNsaWNrLiBFaXRoZXIgdGhpcyBwcm9wZXJ0eVxuICogb3IvYW5kIHggYW5kIHkgbXVzdCBiZSBzZXQuIElmIGJvdGggYXJlIHNldCB0aGVuIHggYW5kIHkgYXJlIGNvbnNpZGVyZWQgYXMgcmVsYXRpdmVcbiAqIGVsZW1lbnQgY29vcmRpbmF0ZXMuIElmIG9ubHkgeCBhbmQgeSBhcmUgc2V0IHRoZW4gdGhlc2UgYXJlIHBhcnNlZCBhc1xuICogYWJzb2x1dGUgY29vcmRpbmF0ZXMuXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHggY2xpY2sgWCBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHkgY2xpY2sgWSBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGtleU1vZGlmaWVyRmxhZ3MgaWYgc2V0IHRoZW4gdGhlIGdpdmVuIGtleSBtb2RpZmllcnMgd2lsbCBiZVxuICogYXBwbGllZCB3aGlsZSBjbGljayBpcyBwZXJmb3JtZWQuIFNlZVxuICogaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24veGN0ZXN0L3hjdWlrZXltb2RpZmllcmZsYWdzXG4gKiBmb3IgbW9yZSBkZXRhaWxzXG4gKi9cblxuLyoqXG4gKiBQZXJmb3JtIGNsaWNrIGdlc3R1cmUgb24gYW4gZWxlbWVudCBvciBieSByZWxhdGl2ZS9hYnNvbHV0ZSBjb29yZGluYXRlc1xuICpcbiAqIEBwYXJhbSB7Q2xpY2tPcHRpb25zfSBvcHRzXG4gKi9cbmNvbW1hbmRzLm1hY29zQ2xpY2sgPSBhc3luYyBmdW5jdGlvbiBtYWNvc0NsaWNrIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7IHgsIHksIGtleU1vZGlmaWVyRmxhZ3MgfSA9IG9wdHM7XG4gIGNvbnN0IHVybCA9IHV1aWQgPyBgL2VsZW1lbnQvJHt1dWlkfS9jbGlja2AgOiAnL3dkYS9jbGljayc7XG4gIHJldHVybiBhd2FpdCB0aGlzLndkYS5wcm94eS5jb21tYW5kKHVybCwgJ1BPU1QnLCB7XG4gICAgeCwgeSxcbiAgICBrZXlNb2RpZmllckZsYWdzLFxuICB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU2Nyb2xsT3B0aW9uc1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSBlbGVtZW50SWQgdXVpZCBvZiB0aGUgZWxlbWVudCB0byBiZSBzY3JvbGxlZC4gRWl0aGVyIHRoaXMgcHJvcGVydHlcbiAqIG9yL2FuZCB4IGFuZCB5IG11c3QgYmUgc2V0LiBJZiBib3RoIGFyZSBzZXQgdGhlbiB4IGFuZCB5IGFyZSBjb25zaWRlcmVkIGFzIHJlbGF0aXZlXG4gKiBlbGVtZW50IGNvb3JkaW5hdGVzLiBJZiBvbmx5IHggYW5kIHkgYXJlIHNldCB0aGVuIHRoZXNlIGFyZSBwYXJzZWQgYXNcbiAqIGFic29sdXRlIGNvb3JkaW5hdGVzLlxuICogQHByb3BlcnR5IHs/bnVtYmVyfSB4IHNjcm9sbCBYIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0geSBzY3JvbGwgWSBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgeyFudW1iZXJ9IGRlbHRhWCBob3Jpem9udGFsIGRlbHRhIGFzIGZsb2F0IG51bWJlclxuICogQHByb3BlcnR5IHshbnVtYmVyfSBkZWx0YVkgdmVydGljYWwgZGVsdGEgYXMgZmxvYXQgbnVtYmVyXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGtleU1vZGlmaWVyRmxhZ3MgaWYgc2V0IHRoZW4gdGhlIGdpdmVuIGtleSBtb2RpZmllcnMgd2lsbCBiZVxuICogYXBwbGllZCB3aGlsZSBzY3JvbGwgaXMgcGVyZm9ybWVkLiBTZWVcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3Vpa2V5bW9kaWZpZXJmbGFnc1xuICogZm9yIG1vcmUgZGV0YWlsc1xuICovXG5cbi8qKlxuICogUGVyZm9ybSBzY3JvbGwgZ2VzdHVyZSBvbiBhbiBlbGVtZW50IG9yIGJ5IHJlbGF0aXZlL2Fic29sdXRlIGNvb3JkaW5hdGVzXG4gKlxuICogQHBhcmFtIHtTY3JvbGxPcHRpb25zfSBvcHRzXG4gKi9cbmNvbW1hbmRzLm1hY29zU2Nyb2xsID0gYXN5bmMgZnVuY3Rpb24gbWFjb3NTY3JvbGwgKG9wdHMgPSB7fSkge1xuICBjb25zdCB1dWlkID0gZXh0cmFjdFV1aWQob3B0cyk7XG4gIGNvbnN0IHtcbiAgICB4LCB5LFxuICAgIGRlbHRhWCwgZGVsdGFZLFxuICAgIGtleU1vZGlmaWVyRmxhZ3MsXG4gIH0gPSBvcHRzO1xuICBjb25zdCB1cmwgPSB1dWlkID8gYC93ZGEvZWxlbWVudC8ke3V1aWR9L3Njcm9sbGAgOiAnL3dkYS9zY3JvbGwnO1xuICByZXR1cm4gYXdhaXQgdGhpcy53ZGEucHJveHkuY29tbWFuZCh1cmwsICdQT1NUJywge1xuICAgIGRlbHRhWCwgZGVsdGFZLFxuICAgIHgsIHksXG4gICAga2V5TW9kaWZpZXJGbGFncyxcbiAgfSk7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFN3aXBlT3B0aW9uc1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSBlbGVtZW50SWQgdXVpZCBvZiB0aGUgZWxlbWVudCB0byBiZSBzd2lwZWQuIEVpdGhlciB0aGlzIHByb3BlcnR5XG4gKiBvci9hbmQgeCBhbmQgeSBtdXN0IGJlIHNldC4gSWYgYm90aCBhcmUgc2V0IHRoZW4geCBhbmQgeSBhcmUgY29uc2lkZXJlZCBhcyByZWxhdGl2ZVxuICogZWxlbWVudCBjb29yZGluYXRlcy4gSWYgb25seSB4IGFuZCB5IGFyZSBzZXQgdGhlbiB0aGVzZSBhcmUgcGFyc2VkIGFzXG4gKiBhYnNvbHV0ZSBjb29yZGluYXRlcy5cbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0geCBzd2lwZSBYIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0geSBzd2lwZSBZIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7IXN0cmluZ30gZGlyZWN0aW9uIGVpdGhlciAndXAnLCAnZG93bicsICdsZWZ0JyBvciAncmlnaHQnXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHZlbG9jaXR5IFRoZSB2YWx1ZSBpcyBtZWFzdXJlZCBpbiBwaXhlbHMgcGVyIHNlY29uZCBhbmQgc2FtZVxuICogdmFsdWVzIGNvdWxkIGJlaGF2ZSBkaWZmZXJlbnRseSBvbiBkaWZmZXJlbnQgZGV2aWNlcyBkZXBlbmRpbmcgb24gdGhlaXIgZGlzcGxheVxuICogZGVuc2l0eS4gSGlnaGVyIHZhbHVlcyBtYWtlIHN3aXBlIGdlc3R1cmUgZmFzdGVyICh3aGljaCB1c3VhbGx5IHNjcm9sbHMgbGFyZ2VyXG4gKiBhcmVhcyBpZiB3ZSBhcHBseSBpdCB0byBhIGxpc3QpIGFuZCBsb3dlciB2YWx1ZXMgc2xvdyBpdCBkb3duLlxuICogT25seSB2YWx1ZXMgZ3JlYXRlciB0aGFuIHplcm8gaGF2ZSBlZmZlY3QuXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGtleU1vZGlmaWVyRmxhZ3MgaWYgc2V0IHRoZW4gdGhlIGdpdmVuIGtleSBtb2RpZmllcnMgd2lsbCBiZVxuICogYXBwbGllZCB3aGlsZSBzY3JvbGwgaXMgcGVyZm9ybWVkLiBTZWVcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3Vpa2V5bW9kaWZpZXJmbGFnc1xuICogZm9yIG1vcmUgZGV0YWlsc1xuICovXG5cbi8qKlxuICogUGVyZm9ybSBzd2lwZSBnZXN0dXJlIG9uIGFuIGVsZW1lbnRcbiAqXG4gKiBAcGFyYW0ge1N3aXBlT3B0aW9uc30gb3B0c1xuICovXG5jb21tYW5kcy5tYWNvc1N3aXBlID0gYXN5bmMgZnVuY3Rpb24gbWFjb3NTd2lwZSAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHV1aWQgPSBleHRyYWN0VXVpZChvcHRzKTtcbiAgY29uc3Qge1xuICAgIHgsIHksXG4gICAgZGlyZWN0aW9uLFxuICAgIHZlbG9jaXR5LFxuICAgIGtleU1vZGlmaWVyRmxhZ3MsXG4gIH0gPSBvcHRzO1xuICBjb25zdCB1cmwgPSB1dWlkID8gYC93ZGEvZWxlbWVudC8ke3V1aWR9L3N3aXBlYCA6IGAvd2RhL3N3aXBlYDtcbiAgcmV0dXJuIGF3YWl0IHRoaXMud2RhLnByb3h5LmNvbW1hbmQodXJsLCAnUE9TVCcsIHtcbiAgICB4LCB5LFxuICAgIGRpcmVjdGlvbixcbiAgICB2ZWxvY2l0eSxcbiAgICBrZXlNb2RpZmllckZsYWdzLFxuICB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gUmlnaHRDbGlja09wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gZWxlbWVudElkIHV1aWQgb2YgdGhlIGVsZW1lbnQgdG8gY2xpY2suIEVpdGhlciB0aGlzIHByb3BlcnR5XG4gKiBvci9hbmQgeCBhbmQgeSBtdXN0IGJlIHNldC4gSWYgYm90aCBhcmUgc2V0IHRoZW4geCBhbmQgeSBhcmUgY29uc2lkZXJlZCBhcyByZWxhdGl2ZVxuICogZWxlbWVudCBjb29yZGluYXRlcy4gSWYgb25seSB4IGFuZCB5IGFyZSBzZXQgdGhlbiB0aGVzZSBhcmUgcGFyc2VkIGFzXG4gKiBhYnNvbHV0ZSBjb29yZGluYXRlcy5cbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0geCBjbGljayBYIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0geSBjbGljayBZIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0ga2V5TW9kaWZpZXJGbGFncyBpZiBzZXQgdGhlbiB0aGUgZ2l2ZW4ga2V5IG1vZGlmaWVycyB3aWxsIGJlXG4gKiBhcHBsaWVkIHdoaWxlIGNsaWNrIGlzIHBlcmZvcm1lZC4gU2VlXG4gKiBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vZG9jdW1lbnRhdGlvbi94Y3Rlc3QveGN1aWtleW1vZGlmaWVyZmxhZ3NcbiAqIGZvciBtb3JlIGRldGFpbHNcbiAqL1xuXG4vKipcbiAqIFBlcmZvcm0gcmlnaHQgY2xpY2sgZ2VzdHVyZSBvbiBhbiBlbGVtZW50IG9yIGJ5IHJlbGF0aXZlL2Fic29sdXRlIGNvb3JkaW5hdGVzXG4gKlxuICogQHBhcmFtIHtSaWdodENsaWNrT3B0aW9uc30gb3B0c1xuICovXG5jb21tYW5kcy5tYWNvc1JpZ2h0Q2xpY2sgPSBhc3luYyBmdW5jdGlvbiBtYWNvc1JpZ2h0Q2xpY2sgKG9wdHMgPSB7fSkge1xuICBjb25zdCB1dWlkID0gZXh0cmFjdFV1aWQob3B0cyk7XG4gIGNvbnN0IHsgeCwgeSwga2V5TW9kaWZpZXJGbGFncyB9ID0gb3B0cztcbiAgY29uc3QgdXJsID0gdXVpZCA/IGAvd2RhL2VsZW1lbnQvJHt1dWlkfS9yaWdodENsaWNrYCA6ICcvd2RhL3JpZ2h0Q2xpY2snO1xuICByZXR1cm4gYXdhaXQgdGhpcy53ZGEucHJveHkuY29tbWFuZCh1cmwsICdQT1NUJywge1xuICAgIHgsIHksXG4gICAga2V5TW9kaWZpZXJGbGFncyxcbiAgfSk7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEhvdmVyT3B0aW9uc1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSBlbGVtZW50SWQgdXVpZCBvZiB0aGUgZWxlbWVudCB0byBob3Zlci4gRWl0aGVyIHRoaXMgcHJvcGVydHlcbiAqIG9yL2FuZCB4IGFuZCB5IG11c3QgYmUgc2V0LiBJZiBib3RoIGFyZSBzZXQgdGhlbiB4IGFuZCB5IGFyZSBjb25zaWRlcmVkIGFzIHJlbGF0aXZlXG4gKiBlbGVtZW50IGNvb3JkaW5hdGVzLiBJZiBvbmx5IHggYW5kIHkgYXJlIHNldCB0aGVuIHRoZXNlIGFyZSBwYXJzZWQgYXNcbiAqIGFic29sdXRlIGNvb3JkaW5hdGVzLlxuICogQHByb3BlcnR5IHs/bnVtYmVyfSB4IGNsaWNrIFggY29vcmRpbmF0ZVxuICogQHByb3BlcnR5IHs/bnVtYmVyfSB5IGNsaWNrIFkgY29vcmRpbmF0ZVxuICogQHByb3BlcnR5IHs/bnVtYmVyfSBrZXlNb2RpZmllckZsYWdzIGlmIHNldCB0aGVuIHRoZSBnaXZlbiBrZXkgbW9kaWZpZXJzIHdpbGwgYmVcbiAqIGFwcGxpZWQgd2hpbGUgaG92ZXIgaXMgcGVyZm9ybWVkLiBTZWVcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3Vpa2V5bW9kaWZpZXJmbGFnc1xuICogZm9yIG1vcmUgZGV0YWlsc1xuICovXG5cbi8qKlxuICogUGVyZm9ybSBob3ZlciBnZXN0dXJlIG9uIGFuIGVsZW1lbnQgb3IgYnkgcmVsYXRpdmUvYWJzb2x1dGUgY29vcmRpbmF0ZXNcbiAqXG4gKiBAcGFyYW0ge0hvdmVyT3B0aW9uc30gb3B0c1xuICovXG5jb21tYW5kcy5tYWNvc0hvdmVyID0gYXN5bmMgZnVuY3Rpb24gbWFjb3NIb3ZlciAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHV1aWQgPSBleHRyYWN0VXVpZChvcHRzKTtcbiAgY29uc3QgeyB4LCB5LCBrZXlNb2RpZmllckZsYWdzIH0gPSBvcHRzO1xuICBjb25zdCB1cmwgPSB1dWlkID8gYC93ZGEvZWxlbWVudC8ke3V1aWR9L2hvdmVyYCA6ICcvd2RhL2hvdmVyJztcbiAgcmV0dXJuIGF3YWl0IHRoaXMud2RhLnByb3h5LmNvbW1hbmQodXJsLCAnUE9TVCcsIHtcbiAgICB4LCB5LFxuICAgIGtleU1vZGlmaWVyRmxhZ3MsXG4gIH0pO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBEb3VibGVDbGlja09wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gZWxlbWVudElkIHV1aWQgb2YgdGhlIGVsZW1lbnQgdG8gZG91YmxlIGNsaWNrLiBFaXRoZXIgdGhpcyBwcm9wZXJ0eVxuICogb3IvYW5kIHggYW5kIHkgbXVzdCBiZSBzZXQuIElmIGJvdGggYXJlIHNldCB0aGVuIHggYW5kIHkgYXJlIGNvbnNpZGVyZWQgYXMgcmVsYXRpdmVcbiAqIGVsZW1lbnQgY29vcmRpbmF0ZXMuIElmIG9ubHkgeCBhbmQgeSBhcmUgc2V0IHRoZW4gdGhlc2UgYXJlIHBhcnNlZCBhc1xuICogYWJzb2x1dGUgY29vcmRpbmF0ZXMuXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHggY2xpY2sgWCBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHkgY2xpY2sgWSBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGtleU1vZGlmaWVyRmxhZ3MgaWYgc2V0IHRoZW4gdGhlIGdpdmVuIGtleSBtb2RpZmllcnMgd2lsbCBiZVxuICogYXBwbGllZCB3aGlsZSBkb3VibGUgY2xpY2sgaXMgcGVyZm9ybWVkLiBTZWVcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3Vpa2V5bW9kaWZpZXJmbGFnc1xuICogZm9yIG1vcmUgZGV0YWlsc1xuICovXG5cbi8qKlxuICogUGVyZm9ybSBkb3VibGUgY2xpY2sgZ2VzdHVyZSBvbiBhbiBlbGVtZW50IG9yIGJ5IHJlbGF0aXZlL2Fic29sdXRlIGNvb3JkaW5hdGVzXG4gKlxuICogQHBhcmFtIHtEb3VibGVDbGlja09wdGlvbnN9IG9wdHNcbiAqL1xuY29tbWFuZHMubWFjb3NEb3VibGVDbGljayA9IGFzeW5jIGZ1bmN0aW9uIG1hY29zRG91YmxlQ2xpY2sgKG9wdHMgPSB7fSkge1xuICBjb25zdCB1dWlkID0gZXh0cmFjdFV1aWQob3B0cyk7XG4gIGNvbnN0IHsgeCwgeSwga2V5TW9kaWZpZXJGbGFncyB9ID0gb3B0cztcbiAgY29uc3QgdXJsID0gdXVpZCA/IGAvd2RhL2VsZW1lbnQvJHt1dWlkfS9kb3VibGVDbGlja2AgOiAnL3dkYS9kb3VibGVDbGljayc7XG4gIHJldHVybiBhd2FpdCB0aGlzLndkYS5wcm94eS5jb21tYW5kKHVybCwgJ1BPU1QnLCB7XG4gICAgeCwgeSxcbiAgICBrZXlNb2RpZmllckZsYWdzLFxuICB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQ2xpY2tBbmREcmFnT3B0aW9uc1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSBzb3VyY2VFbGVtZW50SWQgdXVpZCBvZiB0aGUgZWxlbWVudCB0byBzdGFydCB0aGUgZHJhZyBmcm9tLiBFaXRoZXIgdGhpcyBwcm9wZXJ0eVxuICogYW5kIGBkZXN0aW5hdGlvbkVsZW1lbnRgIG11c3QgYmUgcHJvdmlkZWQgb3IgYHN0YXJ0WGAsIGBzdGFydFlgLCBgZW5kWGAsIGBlbmRZYCBjb29yZGluYXRlc1xuICogbXVzdCBiZSBzZXQuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGRlc3RpbmF0aW9uRWxlbWVudElkIHV1aWQgb2YgdGhlIGVsZW1lbnQgdG8gZW5kIHRoZSBkcmFnIG9uLiBFaXRoZXIgdGhpcyBwcm9wZXJ0eVxuICogYW5kIGBzb3VyY2VFbGVtZW50YCBtdXN0IGJlIHByb3ZpZGVkIG9yIGBzdGFydFhgLCBgc3RhcnRZYCwgYGVuZFhgLCBgZW5kWWAgY29vcmRpbmF0ZXNcbiAqIG11c3QgYmUgc2V0LlxuICogQHByb3BlcnR5IHs/bnVtYmVyfSBzdGFydFggc3RhcnRpbmcgWCBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHN0YXJ0WSBzdGFydGluZyBZIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gZW5kWCBlbmRpbmcgWCBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGVuZFkgZW5kaW5nIFkgY29vcmRpbmF0ZVxuICogQHByb3BlcnR5IHshbnVtYmVyfSBkdXJhdGlvbiBsb25nIGNsaWNrIGR1cmF0aW9uIGluIGZsb2F0IHNlY29uZHNcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0ga2V5TW9kaWZpZXJGbGFncyBpZiBzZXQgdGhlbiB0aGUgZ2l2ZW4ga2V5IG1vZGlmaWVycyB3aWxsIGJlXG4gKiBhcHBsaWVkIHdoaWxlIGRyYWcgaXMgcGVyZm9ybWVkLiBTZWVcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3Vpa2V5bW9kaWZpZXJmbGFnc1xuICogZm9yIG1vcmUgZGV0YWlsc1xuICovXG5cbi8qKlxuICogUGVyZm9ybSBsb25nIGNsaWNrIGFuZCBkcmFnIGdlc3R1cmUgb24gYW4gZWxlbWVudCBvciBieSBhYnNvbHV0ZSBjb29yZGluYXRlc1xuICpcbiAqIEBwYXJhbSB7Q2xpY2tBbmREcmFnT3B0aW9uc30gb3B0c1xuICovXG5jb21tYW5kcy5tYWNvc0NsaWNrQW5kRHJhZyA9IGFzeW5jIGZ1bmN0aW9uIG1hY29zQ2xpY2tBbmREcmFnIChvcHRzID0ge30pIHtcbiAgY29uc3Qgc291cmNlVXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMsIFsnc291cmNlRWxlbWVudElkJywgJ3NvdXJjZUVsZW1lbnQnXSk7XG4gIGNvbnN0IGRlc3RVdWlkID0gZXh0cmFjdFV1aWQob3B0cywgWydkZXN0aW5hdGlvbkVsZW1lbnRJZCcsICdkZXN0aW5hdGlvbkVsZW1lbnQnXSk7XG4gIGNvbnN0IHtcbiAgICBzdGFydFgsIHN0YXJ0WSxcbiAgICBlbmRYLCBlbmRZLFxuICAgIGR1cmF0aW9uLFxuICAgIGtleU1vZGlmaWVyRmxhZ3NcbiAgfSA9IG9wdHM7XG4gIGNvbnN0IHVybCA9IHNvdXJjZVV1aWQgJiYgZGVzdFV1aWRcbiAgICA/IGAvd2RhL2VsZW1lbnQvJHtzb3VyY2VVdWlkfS9jbGlja0FuZERyYWdgXG4gICAgOiAnL3dkYS9jbGlja0FuZERyYWcnO1xuICBjb25zdCBkZXN0ID0gZGVzdFV1aWQgJiYgdXRpbC53cmFwRWxlbWVudChkZXN0VXVpZCk7XG4gIHJldHVybiBhd2FpdCB0aGlzLndkYS5wcm94eS5jb21tYW5kKHVybCwgJ1BPU1QnLCB7XG4gICAgc3RhcnRYLCBzdGFydFksXG4gICAgZW5kWCwgZW5kWSxcbiAgICBkdXJhdGlvbixcbiAgICBkZXN0LFxuICAgIGtleU1vZGlmaWVyRmxhZ3MsXG4gIH0pO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBDbGlja0FuZERyYWdBbmRIb2xkT3B0aW9uc1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSBzb3VyY2VFbGVtZW50SWQgdXVpZCBvZiB0aGUgZWxlbWVudCB0byBzdGFydCB0aGUgZHJhZyBmcm9tLiBFaXRoZXIgdGhpcyBwcm9wZXJ0eVxuICogYW5kIGBkZXN0aW5hdGlvbkVsZW1lbnRgIG11c3QgYmUgcHJvdmlkZWQgb3IgYHN0YXJ0WGAsIGBzdGFydFlgLCBgZW5kWGAsIGBlbmRZYCBjb29yZGluYXRlc1xuICogbXVzdCBiZSBzZXQuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGRlc3RpbmF0aW9uRWxlbWVudElkIHV1aWQgb2YgdGhlIGVsZW1lbnQgdG8gZW5kIHRoZSBkcmFnIG9uLiBFaXRoZXIgdGhpcyBwcm9wZXJ0eVxuICogYW5kIGBzb3VyY2VFbGVtZW50YCBtdXN0IGJlIHByb3ZpZGVkIG9yIGBzdGFydFhgLCBgc3RhcnRZYCwgYGVuZFhgLCBgZW5kWWAgY29vcmRpbmF0ZXNcbiAqIG11c3QgYmUgc2V0LlxuICogQHByb3BlcnR5IHs/bnVtYmVyfSBzdGFydFggc3RhcnRpbmcgWCBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHN0YXJ0WSBzdGFydGluZyBZIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gZW5kWCBlbmRpbmcgWCBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGVuZFkgZW5kaW5nIFkgY29vcmRpbmF0ZVxuICogQHByb3BlcnR5IHshbnVtYmVyfSBkdXJhdGlvbiBsb25nIGNsaWNrIGR1cmF0aW9uIGluIGZsb2F0IHNlY29uZHNcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gdmVsb2NpdHkgZHJhZ2dpbmcgdmVsb2NpdHkgaW4gcGl4ZWxzIHBlciBzZWNvbmQuXG4gKiBJZiBub3QgcHJvdmlkZWQgdGhlbiB0aGUgZGVmYXVsdCB2ZWxvY2l0eSBpcyB1c2VkLiBTZWVcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3VpZ2VzdHVyZXZlbG9jaXR5XG4gKiBmb3IgbW9yZSBkZXRhaWxzXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGtleU1vZGlmaWVyRmxhZ3MgaWYgc2V0IHRoZW4gdGhlIGdpdmVuIGtleSBtb2RpZmllcnMgd2lsbCBiZVxuICogYXBwbGllZCB3aGlsZSBkcmFnIGlzIHBlcmZvcm1lZC4gU2VlXG4gKiBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vZG9jdW1lbnRhdGlvbi94Y3Rlc3QveGN1aWtleW1vZGlmaWVyZmxhZ3NcbiAqIGZvciBtb3JlIGRldGFpbHNcbiAqL1xuXG4vKipcbiAqIFBlcmZvcm0gbG9uZyBjbGljaywgZHJhZyBhbmQgaG9sZCBnZXN0dXJlIG9uIGFuIGVsZW1lbnQgb3IgYnkgYWJzb2x1dGUgY29vcmRpbmF0ZXNcbiAqXG4gKiBAcGFyYW0ge0NsaWNrQW5kRHJhZ0FuZEhvbGRPcHRpb25zfSBvcHRzXG4gKi9cbmNvbW1hbmRzLm1hY29zQ2xpY2tBbmREcmFnQW5kSG9sZCA9IGFzeW5jIGZ1bmN0aW9uIG1hY29zQ2xpY2tBbmREcmFnQW5kSG9sZCAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHNvdXJjZVV1aWQgPSBleHRyYWN0VXVpZChvcHRzLCBbJ3NvdXJjZUVsZW1lbnRJZCcsICdzb3VyY2VFbGVtZW50J10pO1xuICBjb25zdCBkZXN0VXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMsIFsnZGVzdGluYXRpb25FbGVtZW50SWQnLCAnZGVzdGluYXRpb25FbGVtZW50J10pO1xuICBjb25zdCB7XG4gICAgc3RhcnRYLCBzdGFydFksXG4gICAgZW5kWCwgZW5kWSxcbiAgICBkdXJhdGlvbiwgaG9sZER1cmF0aW9uLFxuICAgIHZlbG9jaXR5LFxuICAgIGtleU1vZGlmaWVyRmxhZ3NcbiAgfSA9IG9wdHM7XG4gIGNvbnN0IHVybCA9IHNvdXJjZVV1aWQgJiYgZGVzdFV1aWRcbiAgICA/IGAvd2RhL2VsZW1lbnQvJHtzb3VyY2VVdWlkfS9jbGlja0FuZERyYWdBbmRIb2xkYFxuICAgIDogJy93ZGEvY2xpY2tBbmREcmFnQW5kSG9sZCc7XG4gIGNvbnN0IGRlc3QgPSBkZXN0VXVpZCAmJiB1dGlsLndyYXBFbGVtZW50KGRlc3RVdWlkKTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMud2RhLnByb3h5LmNvbW1hbmQodXJsLCAnUE9TVCcsIHtcbiAgICBzdGFydFgsIHN0YXJ0WSxcbiAgICBlbmRYLCBlbmRZLFxuICAgIGR1cmF0aW9uLCBob2xkRHVyYXRpb24sXG4gICAgdmVsb2NpdHksXG4gICAgZGVzdCxcbiAgICBrZXlNb2RpZmllckZsYWdzLFxuICB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gS2V5T3B0aW9uc1xuICogQHByb3BlcnR5IHshc3RyaW5nfSBrZXkgYSBzdHJpbmcsIHRoYXQgcmVwcmVzZW50cyBhIGtleSB0byB0eXBlIChzZWVcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3VpZWxlbWVudC8xNTAwNjA0LXR5cGVrZXk/bGFuZ3VhZ2U9b2JqY1xuICogYW5kIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3Vpa2V5Ym9hcmRrZXk/bGFuZ3VhZ2U9b2JqYylcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gbW9kaWZpZXJGbGFncyBhIHNldCBvZiBtb2RpZmllciBmbGFnc1xuICogKGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3Vpa2V5bW9kaWZpZXJmbGFncz9sYW5ndWFnZT1vYmpjKVxuICogdG8gdXNlIHdoZW4gdHlwaW5nIHRoZSBrZXkuXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBLZXlzT3B0aW9uc1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSBlbGVtZW50SWQgdXVpZCBvZiB0aGUgZWxlbWVudCB0byBzZW5kIGtleXMgdG8uXG4gKiBJZiB0aGUgZWxlbWVudCBpcyBub3QgcHJvdmlkZWQgdGhlbiB0aGUga2V5cyB3aWxsIGJlIHNlbnQgdG8gdGhlIGN1cnJlbnQgYXBwbGljYXRpb24uXG4gKiBAcHJvcGVydHkgeyFBcnJheTxLZXlPcHRpb25zfHN0cmluZz59IGtleXMgQXJyYXkgb2Yga2V5cyB0byB0eXBlLlxuICogRWFjaCBpdGVtIGNvdWxkIGVpdGhlciBiZSBhIHN0cmluZywgdGhhdCByZXByZXNlbnRzIGEga2V5IGl0c2VsZiAoc2VlXG4gKiBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vZG9jdW1lbnRhdGlvbi94Y3Rlc3QveGN1aWVsZW1lbnQvMTUwMDYwNC10eXBla2V5P2xhbmd1YWdlPW9iamNcbiAqIGFuZCBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vZG9jdW1lbnRhdGlvbi94Y3Rlc3QveGN1aWtleWJvYXJka2V5P2xhbmd1YWdlPW9iamMpXG4gKiBvciBhIGRpY3Rpb25hcnksIGlmIHRoZSBrZXkgc2hvdWxkIGFsc28gYmUgZW50ZXJlZCB3aXRoIG1vZGlmaWVycy5cbiAqL1xuXG4vKipcbiAqIFNlbmQga2V5cyB0byB0aGUgZ2l2ZW4gZWxlbWVudCBvciB0byB0aGUgYXBwbGljYXRpb24gdW5kZXIgdGVzdFxuICpcbiAqIEBwYXJhbSB7S2V5c09wdGlvbnN9IG9wdHNcbiAqL1xuY29tbWFuZHMubWFjb3NLZXlzID0gYXN5bmMgZnVuY3Rpb24gbWFjb3NLZXlzIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7IGtleXMgfSA9IG9wdHM7XG4gIGNvbnN0IHVybCA9IHV1aWQgPyBgL3dkYS9lbGVtZW50LyR7dXVpZH0va2V5c2AgOiAnL3dkYS9rZXlzJztcbiAgcmV0dXJuIGF3YWl0IHRoaXMud2RhLnByb3h5LmNvbW1hbmQodXJsLCAnUE9TVCcsIHsga2V5cyB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gUHJlc3NPcHRpb25zXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGVsZW1lbnRJZCB1dWlkIG9mIHRoZSBUb3VjaCBCYXIgZWxlbWVudCB0byBiZSBwcmVzc2VkLiBFaXRoZXIgdGhpcyBwcm9wZXJ0eVxuICogb3IvYW5kIHggYW5kIHkgbXVzdCBiZSBzZXQuIElmIGJvdGggYXJlIHNldCB0aGVuIHggYW5kIHkgYXJlIGNvbnNpZGVyZWQgYXMgcmVsYXRpdmVcbiAqIGVsZW1lbnQgY29vcmRpbmF0ZXMuIElmIG9ubHkgeCBhbmQgeSBhcmUgc2V0IHRoZW4gdGhlc2UgYXJlIHBhcnNlZCBhc1xuICogYWJzb2x1dGUgVG91Y2ggQmFyIGNvb3JkaW5hdGVzLlxuICogQHByb3BlcnR5IHs/bnVtYmVyfSB4IGxvbmcgY2xpY2sgWCBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHkgbG9uZyBjbGljayBZIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7IW51bWJlcn0gZHVyYXRpb24gdGhlIG51bWJlciBvZiBmbG9hdCBzZWNvbmRzIHRvIGhvbGQgdGhlIG1vdXNlIGJ1dHRvblxuICogQHByb3BlcnR5IHs/bnVtYmVyfSBrZXlNb2RpZmllckZsYWdzIGlmIHNldCB0aGVuIHRoZSBnaXZlbiBrZXkgbW9kaWZpZXJzIHdpbGwgYmVcbiAqIGFwcGxpZWQgd2hpbGUgY2xpY2sgaXMgcGVyZm9ybWVkLiBTZWVcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3Vpa2V5bW9kaWZpZXJmbGFnc1xuICogZm9yIG1vcmUgZGV0YWlsc1xuICovXG5cbi8qKlxuICogUGVyZm9ybSBwcmVzcyBnZXN0dXJlIG9uIGEgVG91Y2ggQmFyIGVsZW1lbnQgb3IgYnkgcmVsYXRpdmUvYWJzb2x1dGUgY29vcmRpbmF0ZXNcbiAqXG4gKiBAcGFyYW0ge1ByZXNzT3B0aW9uc30gb3B0c1xuICovXG5jb21tYW5kcy5tYWNvc1ByZXNzQW5kSG9sZCA9IGFzeW5jIGZ1bmN0aW9uIG1hY29zUHJlc3NBbmRIb2xkIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7IHgsIHksIGR1cmF0aW9uLCBrZXlNb2RpZmllckZsYWdzIH0gPSBvcHRzO1xuICBjb25zdCB1cmwgPSB1dWlkID8gYC93ZGEvZWxlbWVudC8ke3V1aWR9L3ByZXNzYCA6ICcvd2RhL3ByZXNzJztcbiAgcmV0dXJuIGF3YWl0IHRoaXMud2RhLnByb3h5LmNvbW1hbmQodXJsLCAnUE9TVCcsIHtcbiAgICB4LCB5LFxuICAgIGR1cmF0aW9uLFxuICAgIGtleU1vZGlmaWVyRmxhZ3MsXG4gIH0pO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBUYXBPcHRpb25zXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGVsZW1lbnRJZCB1dWlkIG9mIHRoZSBUb3VjaCBCYXIgZWxlbWVudCB0byB0YXAuIEVpdGhlciB0aGlzIHByb3BlcnR5XG4gKiBvci9hbmQgeCBhbmQgeSBtdXN0IGJlIHNldC4gSWYgYm90aCBhcmUgc2V0IHRoZW4geCBhbmQgeSBhcmUgY29uc2lkZXJlZCBhcyByZWxhdGl2ZVxuICogZWxlbWVudCBjb29yZGluYXRlcy4gSWYgb25seSB4IGFuZCB5IGFyZSBzZXQgdGhlbiB0aGVzZSBhcmUgcGFyc2VkIGFzXG4gKiBhYnNvbHV0ZSBUb3VjaCBCYXIgY29vcmRpbmF0ZXMuXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHggY2xpY2sgWCBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHkgY2xpY2sgWSBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGtleU1vZGlmaWVyRmxhZ3MgaWYgc2V0IHRoZW4gdGhlIGdpdmVuIGtleSBtb2RpZmllcnMgd2lsbCBiZVxuICogYXBwbGllZCB3aGlsZSBjbGljayBpcyBwZXJmb3JtZWQuIFNlZVxuICogaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24veGN0ZXN0L3hjdWlrZXltb2RpZmllcmZsYWdzXG4gKiBmb3IgbW9yZSBkZXRhaWxzXG4gKi9cblxuLyoqXG4gKiBQZXJmb3JtIHRhcCBnZXN0dXJlIG9uIGEgVG91Y2ggQmFyIGVsZW1lbnQgb3IgYnkgcmVsYXRpdmUvYWJzb2x1dGUgY29vcmRpbmF0ZXNcbiAqXG4gKiBAcGFyYW0ge1RhcE9wdGlvbnN9IG9wdHNcbiAqL1xuY29tbWFuZHMubWFjb3NUYXAgPSBhc3luYyBmdW5jdGlvbiBtYWNvc1RhcCAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHV1aWQgPSBleHRyYWN0VXVpZChvcHRzKTtcbiAgY29uc3QgeyB4LCB5LCBrZXlNb2RpZmllckZsYWdzIH0gPSBvcHRzO1xuICBjb25zdCB1cmwgPSB1dWlkID8gYC93ZGEvZWxlbWVudC8ke3V1aWR9L3RhcGAgOiAnL3dkYS90YXAnO1xuICByZXR1cm4gYXdhaXQgdGhpcy53ZGEucHJveHkuY29tbWFuZCh1cmwsICdQT1NUJywge1xuICAgIHgsIHksXG4gICAga2V5TW9kaWZpZXJGbGFncyxcbiAgfSk7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IERvdWJsZVRhcE9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gZWxlbWVudElkIHV1aWQgb2YgdGhlIFRvdWNoIEJhciBlbGVtZW50IHRvIHRhcC4gRWl0aGVyIHRoaXMgcHJvcGVydHlcbiAqIG9yL2FuZCB4IGFuZCB5IG11c3QgYmUgc2V0LiBJZiBib3RoIGFyZSBzZXQgdGhlbiB4IGFuZCB5IGFyZSBjb25zaWRlcmVkIGFzIHJlbGF0aXZlXG4gKiBlbGVtZW50IGNvb3JkaW5hdGVzLiBJZiBvbmx5IHggYW5kIHkgYXJlIHNldCB0aGVuIHRoZXNlIGFyZSBwYXJzZWQgYXNcbiAqIGFic29sdXRlIFRvdWNoIEJhciBjb29yZGluYXRlcy5cbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0geCBjbGljayBYIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0geSBjbGljayBZIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0ga2V5TW9kaWZpZXJGbGFncyBpZiBzZXQgdGhlbiB0aGUgZ2l2ZW4ga2V5IG1vZGlmaWVycyB3aWxsIGJlXG4gKiBhcHBsaWVkIHdoaWxlIGNsaWNrIGlzIHBlcmZvcm1lZC4gU2VlXG4gKiBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vZG9jdW1lbnRhdGlvbi94Y3Rlc3QveGN1aWtleW1vZGlmaWVyZmxhZ3NcbiAqIGZvciBtb3JlIGRldGFpbHNcbiAqL1xuXG4vKipcbiAqIFBlcmZvcm0gdGFwIGdlc3R1cmUgb24gYSBUb3VjaCBCYXIgZWxlbWVudCBvciBieSByZWxhdGl2ZS9hYnNvbHV0ZSBjb29yZGluYXRlc1xuICpcbiAqIEBwYXJhbSB7RG91YmxlVGFwT3B0aW9uc30gb3B0c1xuICovXG5jb21tYW5kcy5tYWNvc0RvdWJsZVRhcCA9IGFzeW5jIGZ1bmN0aW9uIG1hY29zRG91YmxlVGFwIChvcHRzID0ge30pIHtcbiAgY29uc3QgdXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMpO1xuICBjb25zdCB7IHgsIHksIGtleU1vZGlmaWVyRmxhZ3MgfSA9IG9wdHM7XG4gIGNvbnN0IHVybCA9IHV1aWQgPyBgL3dkYS9lbGVtZW50LyR7dXVpZH0vZG91YmxlVGFwYCA6ICcvd2RhL2RvdWJsZVRhcCc7XG4gIHJldHVybiBhd2FpdCB0aGlzLndkYS5wcm94eS5jb21tYW5kKHVybCwgJ1BPU1QnLCB7XG4gICAgeCwgeSxcbiAgICBrZXlNb2RpZmllckZsYWdzLFxuICB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gUHJlc3NBbmREcmFnT3B0aW9uc1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSBzb3VyY2VFbGVtZW50SWQgdXVpZCBvZiBhIFRvdWNoIEJhciBlbGVtZW50IHRvIHN0YXJ0IHRoZSBkcmFnIGZyb20uIEVpdGhlciB0aGlzIHByb3BlcnR5XG4gKiBhbmQgYGRlc3RpbmF0aW9uRWxlbWVudGAgbXVzdCBiZSBwcm92aWRlZCBvciBgc3RhcnRYYCwgYHN0YXJ0WWAsIGBlbmRYYCwgYGVuZFlgIGNvb3JkaW5hdGVzXG4gKiBtdXN0IGJlIHNldC5cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gZGVzdGluYXRpb25FbGVtZW50SWQgdXVpZCBvZiBhIFRvdWNoIEJhciBlbGVtZW50IHRvIGVuZCB0aGUgZHJhZyBvbi4gRWl0aGVyIHRoaXMgcHJvcGVydHlcbiAqIGFuZCBgc291cmNlRWxlbWVudGAgbXVzdCBiZSBwcm92aWRlZCBvciBgc3RhcnRYYCwgYHN0YXJ0WWAsIGBlbmRYYCwgYGVuZFlgIGNvb3JkaW5hdGVzXG4gKiBtdXN0IGJlIHNldC5cbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gc3RhcnRYIHN0YXJ0aW5nIFggY29vcmRpbmF0ZVxuICogQHByb3BlcnR5IHs/bnVtYmVyfSBzdGFydFkgc3RhcnRpbmcgWSBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGVuZFggZW5kaW5nIFggY29vcmRpbmF0ZVxuICogQHByb3BlcnR5IHs/bnVtYmVyfSBlbmRZIGVuZGluZyBZIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7IW51bWJlcn0gZHVyYXRpb24gbG9uZyBjbGljayBkdXJhdGlvbiBpbiBmbG9hdCBzZWNvbmRzXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IGtleU1vZGlmaWVyRmxhZ3MgaWYgc2V0IHRoZW4gdGhlIGdpdmVuIGtleSBtb2RpZmllcnMgd2lsbCBiZVxuICogYXBwbGllZCB3aGlsZSBkcmFnIGlzIHBlcmZvcm1lZC4gU2VlXG4gKiBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vZG9jdW1lbnRhdGlvbi94Y3Rlc3QveGN1aWtleW1vZGlmaWVyZmxhZ3NcbiAqIGZvciBtb3JlIGRldGFpbHNcbiAqL1xuXG4vKipcbiAqIFBlcmZvcm0gbG9uZyBwcmVzcyBhbmQgZHJhZyBnZXN0dXJlIG9uIGEgVG91Y2ggQmFyIGVsZW1lbnQgb3IgYnkgYWJzb2x1dGUgY29vcmRpbmF0ZXNcbiAqXG4gKiBAcGFyYW0ge1ByZXNzQW5kRHJhZ09wdGlvbnN9IG9wdHNcbiAqL1xuY29tbWFuZHMubWFjb3NQcmVzc0FuZERyYWcgPSBhc3luYyBmdW5jdGlvbiBtYWNvc1ByZXNzQW5kRHJhZyAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHNvdXJjZVV1aWQgPSBleHRyYWN0VXVpZChvcHRzLCBbJ3NvdXJjZUVsZW1lbnRJZCcsICdzb3VyY2VFbGVtZW50J10pO1xuICBjb25zdCBkZXN0VXVpZCA9IGV4dHJhY3RVdWlkKG9wdHMsIFsnZGVzdGluYXRpb25FbGVtZW50SWQnLCAnZGVzdGluYXRpb25FbGVtZW50J10pO1xuICBjb25zdCB7XG4gICAgc3RhcnRYLCBzdGFydFksXG4gICAgZW5kWCwgZW5kWSxcbiAgICBkdXJhdGlvbixcbiAgICBrZXlNb2RpZmllckZsYWdzXG4gIH0gPSBvcHRzO1xuICBjb25zdCB1cmwgPSBzb3VyY2VVdWlkICYmIGRlc3RVdWlkXG4gICAgPyBgL3dkYS9lbGVtZW50LyR7c291cmNlVXVpZH0vcHJlc3NBbmREcmFnYFxuICAgIDogJy93ZGEvcHJlc3NBbmREcmFnJztcbiAgY29uc3QgZGVzdCA9IGRlc3RVdWlkICYmIHV0aWwud3JhcEVsZW1lbnQoZGVzdFV1aWQpO1xuICByZXR1cm4gYXdhaXQgdGhpcy53ZGEucHJveHkuY29tbWFuZCh1cmwsICdQT1NUJywge1xuICAgIHN0YXJ0WCwgc3RhcnRZLFxuICAgIGVuZFgsIGVuZFksXG4gICAgZHVyYXRpb24sXG4gICAgZGVzdCxcbiAgICBrZXlNb2RpZmllckZsYWdzLFxuICB9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gUHJlc3NBbmREcmFnQW5kSG9sZE9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gc291cmNlRWxlbWVudElkIHV1aWQgb2YgYSBUb3VjaCBCYXIgZWxlbWVudCB0byBzdGFydCB0aGUgZHJhZyBmcm9tLiBFaXRoZXIgdGhpcyBwcm9wZXJ0eVxuICogYW5kIGBkZXN0aW5hdGlvbkVsZW1lbnRgIG11c3QgYmUgcHJvdmlkZWQgb3IgYHN0YXJ0WGAsIGBzdGFydFlgLCBgZW5kWGAsIGBlbmRZYCBjb29yZGluYXRlc1xuICogbXVzdCBiZSBzZXQuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IGRlc3RpbmF0aW9uRWxlbWVudElkIHV1aWQgb2YgYSBUb3VjaCBCYXIgZWxlbWVudCB0byBlbmQgdGhlIGRyYWcgb24uIEVpdGhlciB0aGlzIHByb3BlcnR5XG4gKiBhbmQgYHNvdXJjZUVsZW1lbnRgIG11c3QgYmUgcHJvdmlkZWQgb3IgYHN0YXJ0WGAsIGBzdGFydFlgLCBgZW5kWGAsIGBlbmRZYCBjb29yZGluYXRlc1xuICogbXVzdCBiZSBzZXQuXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHN0YXJ0WCBzdGFydGluZyBYIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gc3RhcnRZIHN0YXJ0aW5nIFkgY29vcmRpbmF0ZVxuICogQHByb3BlcnR5IHs/bnVtYmVyfSBlbmRYIGVuZGluZyBYIGNvb3JkaW5hdGVcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gZW5kWSBlbmRpbmcgWSBjb29yZGluYXRlXG4gKiBAcHJvcGVydHkgeyFudW1iZXJ9IGR1cmF0aW9uIGxvbmcgY2xpY2sgZHVyYXRpb24gaW4gZmxvYXQgc2Vjb25kc1xuICogQHByb3BlcnR5IHs/bnVtYmVyfSB2ZWxvY2l0eSBkcmFnZ2luZyB2ZWxvY2l0eSBpbiBwaXhlbHMgcGVyIHNlY29uZC5cbiAqIElmIG5vdCBwcm92aWRlZCB0aGVuIHRoZSBkZWZhdWx0IHZlbG9jaXR5IGlzIHVzZWQuIFNlZVxuICogaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24veGN0ZXN0L3hjdWlnZXN0dXJldmVsb2NpdHlcbiAqIGZvciBtb3JlIGRldGFpbHNcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0ga2V5TW9kaWZpZXJGbGFncyBpZiBzZXQgdGhlbiB0aGUgZ2l2ZW4ga2V5IG1vZGlmaWVycyB3aWxsIGJlXG4gKiBhcHBsaWVkIHdoaWxlIGRyYWcgaXMgcGVyZm9ybWVkLiBTZWVcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3hjdGVzdC94Y3Vpa2V5bW9kaWZpZXJmbGFnc1xuICogZm9yIG1vcmUgZGV0YWlsc1xuICovXG5cbi8qKlxuICogUGVyZm9ybSBwcmVzcywgZHJhZyBhbmQgaG9sZCBnZXN0dXJlIG9uIGEgVG91Y2ggQmFyIGVsZW1lbnQgb3IgYnkgYWJzb2x1dGUgVG91Y2ggQmFyIGNvb3JkaW5hdGVzXG4gKlxuICogQHBhcmFtIHtQcmVzc0FuZERyYWdBbmRIb2xkT3B0aW9uc30gb3B0c1xuICovXG5jb21tYW5kcy5tYWNvc1ByZXNzQW5kRHJhZ0FuZEhvbGQgPSBhc3luYyBmdW5jdGlvbiBtYWNvc1ByZXNzQW5kRHJhZ0FuZEhvbGQgKG9wdHMgPSB7fSkge1xuICBjb25zdCBzb3VyY2VVdWlkID0gZXh0cmFjdFV1aWQob3B0cywgWydzb3VyY2VFbGVtZW50SWQnLCAnc291cmNlRWxlbWVudCddKTtcbiAgY29uc3QgZGVzdFV1aWQgPSBleHRyYWN0VXVpZChvcHRzLCBbJ2Rlc3RpbmF0aW9uRWxlbWVudElkJywgJ2Rlc3RpbmF0aW9uRWxlbWVudCddKTtcbiAgY29uc3Qge1xuICAgIHN0YXJ0WCwgc3RhcnRZLFxuICAgIGVuZFgsIGVuZFksXG4gICAgZHVyYXRpb24sIGhvbGREdXJhdGlvbixcbiAgICB2ZWxvY2l0eSxcbiAgICBrZXlNb2RpZmllckZsYWdzXG4gIH0gPSBvcHRzO1xuICBjb25zdCB1cmwgPSBzb3VyY2VVdWlkICYmIGRlc3RVdWlkXG4gICAgPyBgL3dkYS9lbGVtZW50LyR7c291cmNlVXVpZH0vcHJlc3NBbmREcmFnQW5kSG9sZGBcbiAgICA6ICcvd2RhL3ByZXNzQW5kRHJhZ0FuZEhvbGQnO1xuICBjb25zdCBkZXN0ID0gZGVzdFV1aWQgJiYgdXRpbC53cmFwRWxlbWVudChkZXN0VXVpZCk7XG4gIHJldHVybiBhd2FpdCB0aGlzLndkYS5wcm94eS5jb21tYW5kKHVybCwgJ1BPU1QnLCB7XG4gICAgc3RhcnRYLCBzdGFydFksXG4gICAgZW5kWCwgZW5kWSxcbiAgICBkdXJhdGlvbiwgaG9sZER1cmF0aW9uLFxuICAgIHZlbG9jaXR5LFxuICAgIGRlc3QsXG4gICAga2V5TW9kaWZpZXJGbGFncyxcbiAgfSk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb21tYW5kcztcbiJdLCJmaWxlIjoibGliL2NvbW1hbmRzL2dlc3R1cmVzLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
