"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.helpers = exports.commands = void 0;

require("source-map-support/register");

var _appiumBaseDriver = require("appium-base-driver");

var _lodash = _interopRequireDefault(require("lodash"));

var _bluebird = _interopRequireDefault(require("bluebird"));

var _utils = require("../utils");

var _logger = _interopRequireDefault(require("../logger"));

var _appiumSupport = require("appium-support");

let commands = {},
    helpers = {},
    extensions = {};
exports.helpers = helpers;
exports.commands = commands;
const FLICK_MS = 3000;

commands.nativeTap = async function nativeTap(el) {
  el = (0, _utils.unwrapEl)(el);
  let command = `au.tapById('${el}')`;
  await this.uiAutoClient.sendCommand(command);
};

commands.click = async function click(el) {
  el = (0, _utils.unwrapEl)(el);

  if (this.isWebContext()) {
    if (this.opts.nativeWebTap && !this.isRealDevice()) {
      await this.nativeWebTap(el);
    } else {
      let atomsElement = this.useAtomsElement(el);
      return await this.executeAtom('click', [atomsElement]);
    }
  } else {
    if (this.opts.useRobot) {
      throw new _appiumBaseDriver.errors.NotYetImplementedError();
    } else {
      await this.nativeTap(el);
    }
  }
};

commands.clickCurrent = async function clickCurrent() {
  if (this.isWebContext()) {
    if (_lodash.default.isNull(this.curWebCoords)) {
      throw new _appiumBaseDriver.errors.UnknownError('Cannot call click() before calling moveTo() to set coords');
    }

    await this.clickWebCoords();
  } else {
    if (this.curCoords === null) {
      throw new _appiumBaseDriver.errors.UnknownError('Cannot call click() before calling moveTo() to set coords');
    }

    await this.clickCoords(this.curCoords);
  }
};

helpers.clickCoords = async function clickCoords(coords) {
  if (this.opts.useRobot) {
    throw new _appiumBaseDriver.errors.NotYetImplementedError();
  } else {
    let opts = coords;
    opts.tapCount = 1;
    opts.duration = 0.3;
    opts.touchCount = 1;
    let command = `au.complexTap(${JSON.stringify(opts)})`;
    await this.uiAutoClient.sendCommand(command);
  }
};

commands.mobileRotation = async function mobileRotation(x, y, radius, rotation, touchCount, duration, el) {
  if (this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotYetImplementedError();
  }

  el = (0, _utils.unwrapEl)(el);
  let location = {
    x,
    y
  };
  let options = {
    duration,
    radius,
    rotation,
    touchCount
  };

  if (el) {
    if (this.isWebContext()) {
      throw new _appiumBaseDriver.errors.NotYetImplementedError();
    }

    await this.uiAutoClient.sendCommand(`au.getElement('${el}').rotateWithOptions(${JSON.stringify(options)})`);
  } else {
    await this.uiAutoClient.sendCommand(`target.rotateWithOptions(${JSON.stringify(location)}, ${JSON.stringify(options)})`);
  }
};

helpers.handleTap = async function handleTap(gesture) {
  let options = gesture.options;
  let cmdBase = options.element ? `au.getElement('${options.element}')` : 'UIATarget.localTarget().frontMostApp()';
  let rect = await this.uiAutoClient.sendCommand(`${cmdBase}.rect()`);
  let offsetX = 0.5;
  let offsetY = 0.5;
  let size = {
    w: rect.size.width,
    h: rect.size.height
  };
  options.x = options.x || size.w / 2;
  options.y = options.y || size.h / 2;
  offsetX = options.x / size.w;
  offsetY = options.y / size.h;
  let opts = {
    tapOffset: {
      x: offsetX,
      y: offsetY
    },
    tapCount: options.count || 1,
    touchCount: 1
  };
  let cmd = `${cmdBase}.tapWithOptions(${JSON.stringify(opts)})`;
  return await this.uiAutoClient.sendCommand(cmd);
};

helpers.isDrag = function isDrag(gestures) {
  return gestures.length === 4 && gestures[0].action === 'press' && gestures[1].action === 'wait' && gestures[2].action === 'moveTo' && gestures[3].action === 'release';
};

helpers.isPinchAndZoom = function isPinchAndZoom(gestures) {
  return gestures.length === 3 && gestures[0].action === 'press' && gestures[1].action === 'moveTo' && gestures[2].action === 'release';
};

helpers.getCoordinates = async function getCoordinates(gesture) {
  let el = gesture.options.element;
  let coordinates = {
    x: 0,
    y: 0,
    areOffsets: false
  };

  if (el) {
    let command = `au.getElement('${el}').rect()`;
    let rect = await this.uiAutoClient.sendCommand(command);
    let pos = {
      x: rect.origin.x,
      y: rect.origin.y
    };
    let size = {
      w: rect.size.width,
      h: rect.size.height
    };
    let offsetX = 0;
    let offsetY = 0;

    if (gesture.options.x || gesture.options.y) {
      offsetX = gesture.options.x || 0;
      offsetY = gesture.options.y || 0;
    } else {
      offsetX = size.w / 2;
      offsetY = size.h / 2;
    }

    coordinates.x = pos.x + offsetX;
    coordinates.y = pos.y + offsetY;
  } else {
    coordinates.areOffsets = gesture.action === 'moveTo';
    coordinates.x = gesture.options.x || 0;
    coordinates.y = gesture.options.y || 0;
  }

  return coordinates;
};

helpers.applyMoveToOffset = function applyMoveToOffset(firstCoordinates, secondCoordinates) {
  if (secondCoordinates.areOffsets) {
    return {
      x: firstCoordinates.x + secondCoordinates.x,
      y: firstCoordinates.y + secondCoordinates.y
    };
  } else {
    return secondCoordinates;
  }
};

helpers.handleDrag = async function handleDrag(gestures) {
  let press = gestures[0];
  let wait = gestures[1];
  let moveTo = gestures[2];
  let pressCoordinates = await this.getCoordinates(press);
  let duration = parseInt(wait.options.ms, 10) / 1000;
  let moveToCoordinates = await this.getCoordinates(moveTo);
  moveToCoordinates = this.applyMoveToOffset(pressCoordinates, moveToCoordinates);
  let dragCommand = `au.dragApp(` + `${pressCoordinates.x}, ${pressCoordinates.y}, ` + `${moveToCoordinates.x}, ${moveToCoordinates.y}, ` + `${duration})`;
  return await this.uiAutoClient.sendCommand(dragCommand);
};

helpers.handlePinchAndZoom = async function handlePinchAndZoom(gestures) {
  let press = gestures[0];
  let moveTo = gestures[1];
  let pressCoordinates = await this.getCoordinates(press);
  let moveToCoordinates = await this.getCoordinates(moveTo);
  moveToCoordinates = this.applyMoveToOffset(pressCoordinates, moveToCoordinates);
  let pinchCommand = `au.dragApp(` + `${pressCoordinates.x}, ${pressCoordinates.y}, ` + `${moveToCoordinates.x}, ${moveToCoordinates.y}`;
  return await this.uiAutoClient.sendCommand(pinchCommand);
};

commands.performTouch = async function performTouch(gestures) {
  if (this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotYetImplementedError();
  }

  if (gestures.length === 1 && gestures[0].action === 'tap') {
    return await this.handleTap(gestures[0]);
  } else if (this.isDrag(gestures)) {
    return await this.handleDrag(gestures);
  }

  let touchStateObjects = await this.parseTouch(gestures);
  await this.uiAutoClient.sendCommand(`target.touch(${JSON.stringify(touchStateObjects)})`);
};

commands.parseTouch = async function parseTouch(gestures) {
  if (_lodash.default.last(gestures).action === 'release') {
    gestures.pop();
  }

  let touchStateObjects = [];

  let finishParsing = () => {
    let prevPos = null;
    let time = 0;

    for (let state of touchStateObjects) {
      if (state.touch[0] === false) {
        state.touch[0] = prevPos;
      } else if (state.touch[0].offset && prevPos) {
        state.touch[0].x += prevPos.x;
        state.touch[0].y += prevPos.y;
      }

      if (state.touch[0]) {
        delete state.touch[0].offset;
        prevPos = state.touch[0];
      }

      let timeOffset = state.timeOffset;
      time += timeOffset;
      state.time = time;
      delete state.timeOffset;
    }
  };

  const needsPoint = action => _lodash.default.includes(['press', 'moveTo', 'tap', 'longPress'], action);

  let cycleThroughGestures = async () => {
    let gesture = gestures.shift();

    if (typeof gesture === 'undefined') {
      return finishParsing();
    }

    let tapPoint = false;

    if (needsPoint(gesture.action)) {
      let el = gesture.options.element;

      if (el) {
        let command = `au.getElement('${el}').rect()`;
        let rect = await this.uiAutoClient.sendCommand(command);
        let pos = {
          x: rect.origin.x,
          y: rect.origin.y
        };
        let size = {
          w: rect.size.width,
          h: rect.size.height
        };

        if (gesture.options.x || gesture.options.y) {
          tapPoint = {
            offset: false,
            x: pos.x + (gesture.options.x || 0),
            y: pos.y + (gesture.options.y || 0)
          };
        } else {
          tapPoint = {
            offset: false,
            x: pos.x + size.w / 2,
            y: pos.y + size.h / 2
          };
        }

        let touchStateObject = {
          timeOffset: 0.2,
          touch: [tapPoint]
        };
        touchStateObjects.push(touchStateObject);
        await cycleThroughGestures();
      } else {
        tapPoint = {
          offset: true,
          x: gesture.options.x || 0,
          y: gesture.options.y || 0
        };
        let touchStateObject = {
          timeOffset: 0.2,
          touch: [tapPoint]
        };
        touchStateObjects.push(touchStateObject);
        await cycleThroughGestures();
      }
    } else {
      tapPoint = false;
      let offset = 0.2;

      if (gesture.action === 'wait') {
        if (typeof gesture.options.ms !== 'undefined' || gesture.options.ms !== null) {
          offset = parseInt(gesture.options.ms, 10) / 1000;
        }
      }

      let touchStateObject = {
        timeOffset: offset,
        touch: [tapPoint]
      };
      touchStateObjects.push(touchStateObject);
      await cycleThroughGestures();
    }
  };

  await cycleThroughGestures();
  return touchStateObjects;
};

const mergeStates = function mergeStates(states) {
  let getSlice = function (states, index) {
    let array = [];

    for (let i = 0; i < states.length; i++) {
      array.push(states[i][index]);
    }

    return array;
  };

  const timeSequence = function timeSequence(states) {
    let seq = [];

    _lodash.default.each(states, function eachState(state) {
      let times = _lodash.default.map(state, 'time');

      seq = _lodash.default.union(seq, times);
    });

    return seq.sort();
  };

  let merged = [];

  _lodash.default.each(timeSequence(states), function eachSequence(time, index) {
    let slice = getSlice(states, index);
    let obj = {
      time,
      touch: []
    };

    _lodash.default.each(slice, function eachSlice(action) {
      obj.touch.push(action.touch[0]);
    });

    merged.push(obj);
  });

  return merged;
};

commands.performMultiAction = async function performMultiAction(actions) {
  if (this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotYetImplementedError();
  }

  let states = [];

  let cycleThroughActions = async () => {
    let action = actions.shift();

    if (typeof action === 'undefined') {
      let mergedStates = mergeStates(states);

      if (this.isPinchAndZoom(mergedStates)) {
        await this.handlePinchAndZoom(mergedStates);
        return;
      } else {
        await this.uiAutoClient.sendCommand(`target.touch(${JSON.stringify(mergedStates)})`);
        return;
      }
    }

    let val = await this.parseTouch(action);
    states.push(val);
    await cycleThroughActions();
  };

  await cycleThroughActions();
};

helpers.mobileScroll = async function mobileScroll(opts = {}) {
  let direction = opts.direction;
  let el = opts.element;
  el = (0, _utils.unwrapEl)(el);

  if (this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotYetImplementedError();
  } else {
    if (_appiumSupport.util.hasValue(el) && !_appiumSupport.util.hasValue(direction)) {
      await this.scrollToElement(el);
      return;
    }

    direction = _lodash.default.capitalize(direction);
    let command;

    if (_lodash.default.isNull(el) || _lodash.default.isUndefined(el)) {
      command = `au.scrollFirstView('${direction}')`;
    } else {
      command = `au.getElement('${el}').scroll${direction}()`;
    }

    try {
      await this.uiAutoClient.sendCommand(command);
    } catch (err) {
      if (!_lodash.default.includes(err.message, 'kAXErrorFailure')) throw err;

      _logger.default.warn('Received kAXErrorFailure, generally indicating an attempt ' + 'to scroll past the end of the view. Continuing.');
    }
  }
};

commands.scrollToElement = async function scrollToElement(element) {
  element = (0, _utils.unwrapEl)(element);
  const command = `au.getElement('${element}').scrollToVisible()`;
  await this.uiAutoClient.sendCommand(command);
};

commands.flick = async function flick(el, xspeed, yspeed, xoffset, yoffset, speed) {
  el = (0, _utils.unwrapEl)(el);

  if (_lodash.default.every([el, xoffset, yoffset, speed], p => !_lodash.default.isNull(p) && !_lodash.default.isUndefined(p))) {
    await this.flickElement(el, xoffset, yoffset, speed);
  } else if (_lodash.default.every([xspeed, yspeed], p => !_lodash.default.isNull(p) && !_lodash.default.isUndefined(p))) {
    await this.xySpeedFlick(xspeed, yspeed);
  } else {
    throw new _appiumBaseDriver.errors.UnknownError('Bad flick parameters, pass either (xspeed, yspeed) or (element, xoffset, yoffset, speed)!');
  }
};

helpers.xySpeedFlick = async function xySpeedFlick(xSpeed, ySpeed) {
  let command = `au.touchFlickFromSpeed(${xSpeed},${ySpeed})`;
  await _bluebird.default.all([this.uiAutoClient.sendCommand(command), _bluebird.default.delay(FLICK_MS)]);
};

helpers.flickElement = async function flickElement(el, xoffset, yoffset, speed) {
  el = (0, _utils.unwrapEl)(el);
  let command = '';

  if (this.isWebContext()) {
    await this.webFlickElement(el, xoffset, yoffset);
  } else {
    command = `au.getElement('${el}').touchFlick(${xoffset},${yoffset},${speed})`;
    await _bluebird.default.all([this.uiAutoClient.sendCommand(command), _bluebird.default.delay(FLICK_MS)]);
  }
};

commands.mobileShake = async function mobileShake() {
  await this.uiAutoClient.sendCommand('au.shake()');
};

commands.moveTo = async function moveTo(el, xoffset = 0, yoffset = 0) {
  el = (0, _utils.unwrapEl)(el);

  if (this.isWebContext()) {
    let {
      x,
      y
    } = await this.getLocation(el);
    let coords = {
      x: x + xoffset,
      y: y + yoffset
    };
    this.curWebCoords = coords;
    let atomsElement = this.useAtomsElement(el);
    let relCoords = {
      x: xoffset,
      y: yoffset
    };
    await this.executeAtom('move_mouse', [atomsElement, relCoords]);
  } else {
    if (_lodash.default.isNull(el) || _lodash.default.isUndefined(el)) {
      if (!this.curCoords) {
        throw new _appiumBaseDriver.errors.UnknownException('Current cursor position unknown, please use moveTo with an element the first time.');
      }

      this.curCoords = {
        x: this.curCoords.x + xoffset,
        y: this.curCoords.y + yoffset
      };
    } else {
      let elPos = await this.getLocation(el);
      this.curCoords = {
        x: elPos.x + xoffset,
        y: elPos.y + yoffset
      };
    }
  }
};

Object.assign(extensions, commands, helpers);
var _default = extensions;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9nZXN0dXJlLmpzIl0sIm5hbWVzIjpbImNvbW1hbmRzIiwiaGVscGVycyIsImV4dGVuc2lvbnMiLCJGTElDS19NUyIsIm5hdGl2ZVRhcCIsImVsIiwiY29tbWFuZCIsInVpQXV0b0NsaWVudCIsInNlbmRDb21tYW5kIiwiY2xpY2siLCJpc1dlYkNvbnRleHQiLCJvcHRzIiwibmF0aXZlV2ViVGFwIiwiaXNSZWFsRGV2aWNlIiwiYXRvbXNFbGVtZW50IiwidXNlQXRvbXNFbGVtZW50IiwiZXhlY3V0ZUF0b20iLCJ1c2VSb2JvdCIsImVycm9ycyIsIk5vdFlldEltcGxlbWVudGVkRXJyb3IiLCJjbGlja0N1cnJlbnQiLCJfIiwiaXNOdWxsIiwiY3VyV2ViQ29vcmRzIiwiVW5rbm93bkVycm9yIiwiY2xpY2tXZWJDb29yZHMiLCJjdXJDb29yZHMiLCJjbGlja0Nvb3JkcyIsImNvb3JkcyIsInRhcENvdW50IiwiZHVyYXRpb24iLCJ0b3VjaENvdW50IiwiSlNPTiIsInN0cmluZ2lmeSIsIm1vYmlsZVJvdGF0aW9uIiwieCIsInkiLCJyYWRpdXMiLCJyb3RhdGlvbiIsImxvY2F0aW9uIiwib3B0aW9ucyIsImhhbmRsZVRhcCIsImdlc3R1cmUiLCJjbWRCYXNlIiwiZWxlbWVudCIsInJlY3QiLCJvZmZzZXRYIiwib2Zmc2V0WSIsInNpemUiLCJ3Iiwid2lkdGgiLCJoIiwiaGVpZ2h0IiwidGFwT2Zmc2V0IiwiY291bnQiLCJjbWQiLCJpc0RyYWciLCJnZXN0dXJlcyIsImxlbmd0aCIsImFjdGlvbiIsImlzUGluY2hBbmRab29tIiwiZ2V0Q29vcmRpbmF0ZXMiLCJjb29yZGluYXRlcyIsImFyZU9mZnNldHMiLCJwb3MiLCJvcmlnaW4iLCJhcHBseU1vdmVUb09mZnNldCIsImZpcnN0Q29vcmRpbmF0ZXMiLCJzZWNvbmRDb29yZGluYXRlcyIsImhhbmRsZURyYWciLCJwcmVzcyIsIndhaXQiLCJtb3ZlVG8iLCJwcmVzc0Nvb3JkaW5hdGVzIiwicGFyc2VJbnQiLCJtcyIsIm1vdmVUb0Nvb3JkaW5hdGVzIiwiZHJhZ0NvbW1hbmQiLCJoYW5kbGVQaW5jaEFuZFpvb20iLCJwaW5jaENvbW1hbmQiLCJwZXJmb3JtVG91Y2giLCJ0b3VjaFN0YXRlT2JqZWN0cyIsInBhcnNlVG91Y2giLCJsYXN0IiwicG9wIiwiZmluaXNoUGFyc2luZyIsInByZXZQb3MiLCJ0aW1lIiwic3RhdGUiLCJ0b3VjaCIsIm9mZnNldCIsInRpbWVPZmZzZXQiLCJuZWVkc1BvaW50IiwiaW5jbHVkZXMiLCJjeWNsZVRocm91Z2hHZXN0dXJlcyIsInNoaWZ0IiwidGFwUG9pbnQiLCJ0b3VjaFN0YXRlT2JqZWN0IiwicHVzaCIsIm1lcmdlU3RhdGVzIiwic3RhdGVzIiwiZ2V0U2xpY2UiLCJpbmRleCIsImFycmF5IiwiaSIsInRpbWVTZXF1ZW5jZSIsInNlcSIsImVhY2giLCJlYWNoU3RhdGUiLCJ0aW1lcyIsIm1hcCIsInVuaW9uIiwic29ydCIsIm1lcmdlZCIsImVhY2hTZXF1ZW5jZSIsInNsaWNlIiwib2JqIiwiZWFjaFNsaWNlIiwicGVyZm9ybU11bHRpQWN0aW9uIiwiYWN0aW9ucyIsImN5Y2xlVGhyb3VnaEFjdGlvbnMiLCJtZXJnZWRTdGF0ZXMiLCJ2YWwiLCJtb2JpbGVTY3JvbGwiLCJkaXJlY3Rpb24iLCJ1dGlsIiwiaGFzVmFsdWUiLCJzY3JvbGxUb0VsZW1lbnQiLCJjYXBpdGFsaXplIiwiaXNVbmRlZmluZWQiLCJlcnIiLCJtZXNzYWdlIiwibG9nZ2VyIiwid2FybiIsImZsaWNrIiwieHNwZWVkIiwieXNwZWVkIiwieG9mZnNldCIsInlvZmZzZXQiLCJzcGVlZCIsImV2ZXJ5IiwicCIsImZsaWNrRWxlbWVudCIsInh5U3BlZWRGbGljayIsInhTcGVlZCIsInlTcGVlZCIsIkIiLCJhbGwiLCJkZWxheSIsIndlYkZsaWNrRWxlbWVudCIsIm1vYmlsZVNoYWtlIiwiZ2V0TG9jYXRpb24iLCJyZWxDb29yZHMiLCJVbmtub3duRXhjZXB0aW9uIiwiZWxQb3MiLCJPYmpl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dW0tYmFzZS1kcml2ZXInO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCB7IHVud3JhcEVsIH0gZnJvbSAnLi4vdXRpbHMnO1xuaW1wb3J0IGxvZ2dlciBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHsgdXRpbCB9IGZyb20gJ2FwcGl1bS1zdXBwb3J0JztcblxubGV0IGNvbW1hbmRzID0ge30sIGhlbHBlcnMgPSB7fSwgZXh0ZW5zaW9ucyA9IHt9O1xuY29uc3QgRkxJQ0tfTVMgPSAzMDAwO1xuXG5jb21tYW5kcy5uYXRpdmVUYXAgPSBhc3luYyBmdW5jdGlvbiBuYXRpdmVUYXAgKGVsKSB7XG4gIGVsID0gdW53cmFwRWwoZWwpO1xuICBsZXQgY29tbWFuZCA9IGBhdS50YXBCeUlkKCcke2VsfScpYDtcbiAgYXdhaXQgdGhpcy51aUF1dG9DbGllbnQuc2VuZENvbW1hbmQoY29tbWFuZCk7XG59O1xuXG5jb21tYW5kcy5jbGljayA9IGFzeW5jIGZ1bmN0aW9uIGNsaWNrIChlbCkge1xuICBlbCA9IHVud3JhcEVsKGVsKTtcbiAgaWYgKHRoaXMuaXNXZWJDb250ZXh0KCkpIHtcbiAgICBpZiAodGhpcy5vcHRzLm5hdGl2ZVdlYlRhcCAmJiAhdGhpcy5pc1JlYWxEZXZpY2UoKSkge1xuICAgICAgLy8gYXRvbXMtYmFzZWQgY2xpY2tzIGRvbid0IGFsd2F5cyB3b3JrIGluIHNhZmFyaSA3XG4gICAgICBhd2FpdCB0aGlzLm5hdGl2ZVdlYlRhcChlbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBhdG9tc0VsZW1lbnQgPSB0aGlzLnVzZUF0b21zRWxlbWVudChlbCk7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5leGVjdXRlQXRvbSgnY2xpY2snLCBbYXRvbXNFbGVtZW50XSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmICh0aGlzLm9wdHMudXNlUm9ib3QpIHtcbiAgICAgIC8qIFRPRE8gKi90aHJvdyBuZXcgZXJyb3JzLk5vdFlldEltcGxlbWVudGVkRXJyb3IoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5uYXRpdmVUYXAoZWwpO1xuICAgIH1cbiAgfVxufTtcblxuY29tbWFuZHMuY2xpY2tDdXJyZW50ID0gYXN5bmMgZnVuY3Rpb24gY2xpY2tDdXJyZW50ICgvKmJ1dHRvbiovKSB7XG4gIGlmICh0aGlzLmlzV2ViQ29udGV4dCgpKSB7XG4gICAgaWYgKF8uaXNOdWxsKHRoaXMuY3VyV2ViQ29vcmRzKSkge1xuICAgICAgdGhyb3cgbmV3IGVycm9ycy5Vbmtub3duRXJyb3IoJ0Nhbm5vdCBjYWxsIGNsaWNrKCkgYmVmb3JlIGNhbGxpbmcgbW92ZVRvKCkgdG8gc2V0IGNvb3JkcycpO1xuICAgIH1cbiAgICBhd2FpdCB0aGlzLmNsaWNrV2ViQ29vcmRzKCk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKHRoaXMuY3VyQ29vcmRzID09PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgZXJyb3JzLlVua25vd25FcnJvcignQ2Fubm90IGNhbGwgY2xpY2soKSBiZWZvcmUgY2FsbGluZyBtb3ZlVG8oKSB0byBzZXQgY29vcmRzJyk7XG4gICAgfVxuICAgIGF3YWl0IHRoaXMuY2xpY2tDb29yZHModGhpcy5jdXJDb29yZHMpO1xuICB9XG59O1xuXG5oZWxwZXJzLmNsaWNrQ29vcmRzID0gYXN5bmMgZnVuY3Rpb24gY2xpY2tDb29yZHMgKGNvb3Jkcykge1xuICBpZiAodGhpcy5vcHRzLnVzZVJvYm90KSB7XG4gICAgLyogVE9ETyAqL3Rocm93IG5ldyBlcnJvcnMuTm90WWV0SW1wbGVtZW50ZWRFcnJvcigpO1xuICB9IGVsc2Uge1xuICAgIGxldCBvcHRzID0gY29vcmRzO1xuICAgIG9wdHMudGFwQ291bnQgPSAxO1xuICAgIG9wdHMuZHVyYXRpb24gPSAwLjM7XG4gICAgb3B0cy50b3VjaENvdW50ID0gMTtcbiAgICBsZXQgY29tbWFuZCA9IGBhdS5jb21wbGV4VGFwKCR7SlNPTi5zdHJpbmdpZnkob3B0cyl9KWA7XG4gICAgYXdhaXQgdGhpcy51aUF1dG9DbGllbnQuc2VuZENvbW1hbmQoY29tbWFuZCk7XG4gIH1cbn07XG5cbmNvbW1hbmRzLm1vYmlsZVJvdGF0aW9uID0gYXN5bmMgZnVuY3Rpb24gbW9iaWxlUm90YXRpb24gKHgsIHksIHJhZGl1cywgcm90YXRpb24sIHRvdWNoQ291bnQsIGR1cmF0aW9uLCBlbCkge1xuICBpZiAodGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm90WWV0SW1wbGVtZW50ZWRFcnJvcigpO1xuICB9XG4gIGVsID0gdW53cmFwRWwoZWwpO1xuICBsZXQgbG9jYXRpb24gPSB7eCwgeX07XG4gIGxldCBvcHRpb25zID0ge2R1cmF0aW9uLCByYWRpdXMsIHJvdGF0aW9uLCB0b3VjaENvdW50fTtcbiAgaWYgKGVsKSB7XG4gICAgaWYgKHRoaXMuaXNXZWJDb250ZXh0KCkpIHtcbiAgICAgIC8vIG5vdCBpbXBsZW1lbnRlZCB5ZXQgaW4gdGhlIHdlYlxuICAgICAgdGhyb3cgbmV3IGVycm9ycy5Ob3RZZXRJbXBsZW1lbnRlZEVycm9yKCk7XG4gICAgfVxuICAgIGF3YWl0IHRoaXMudWlBdXRvQ2xpZW50LnNlbmRDb21tYW5kKFxuICAgICAgLy8gVUlBRWxlbWVudC5yb3RhdGVXaXRoT3B0aW9ucyB0YWtlcyBvbmx5IG9uZSBvcHRpb25zIHBhcmFtLlxuICAgICAgYGF1LmdldEVsZW1lbnQoJyR7ZWx9Jykucm90YXRlV2l0aE9wdGlvbnMoJHtKU09OLnN0cmluZ2lmeShvcHRpb25zKX0pYCk7XG4gIH0gZWxzZSB7XG4gICAgYXdhaXQgdGhpcy51aUF1dG9DbGllbnQuc2VuZENvbW1hbmQoXG4gICAgICBgdGFyZ2V0LnJvdGF0ZVdpdGhPcHRpb25zKCR7SlNPTi5zdHJpbmdpZnkobG9jYXRpb24pfSwgJHtKU09OLnN0cmluZ2lmeShvcHRpb25zKX0pYCk7XG4gIH1cbn07XG5cbmhlbHBlcnMuaGFuZGxlVGFwID0gYXN5bmMgZnVuY3Rpb24gaGFuZGxlVGFwIChnZXN0dXJlKSB7XG4gIGxldCBvcHRpb25zID0gZ2VzdHVyZS5vcHRpb25zO1xuICBsZXQgY21kQmFzZSA9IG9wdGlvbnMuZWxlbWVudCA/IGBhdS5nZXRFbGVtZW50KCcke29wdGlvbnMuZWxlbWVudH0nKWAgOlxuICAgICdVSUFUYXJnZXQubG9jYWxUYXJnZXQoKS5mcm9udE1vc3RBcHAoKSc7XG5cbiAgLy8gc3RhcnQgYnkgZ2V0dGluZyB0aGUgc2l6ZSBhbmQgcG9zaXRpb24gb2YgdGhlIGVsZW1lbnQgd2UgYXJlIHRhcHBpbmdcbiAgbGV0IHJlY3QgPSBhd2FpdCB0aGlzLnVpQXV0b0NsaWVudC5zZW5kQ29tbWFuZChgJHtjbWRCYXNlfS5yZWN0KClgKTtcblxuICAvLyBkZWZhdWx0IHRvIGNlbnRlclxuICBsZXQgb2Zmc2V0WCA9IDAuNTtcbiAgbGV0IG9mZnNldFkgPSAwLjU7XG5cbiAgbGV0IHNpemUgPSB7dzogcmVjdC5zaXplLndpZHRoLCBoOiByZWN0LnNpemUuaGVpZ2h0fTtcblxuICAvLyBkZWZhdWx0IG9wdGlvbnMgeC95IHRvIGNlbnRlciwgbm8gbWF0dGVyIHRoZSBjb250YWluZXJcbiAgb3B0aW9ucy54ID0gKG9wdGlvbnMueCB8fCAoc2l6ZS53IC8gMikpO1xuICBvcHRpb25zLnkgPSAob3B0aW9ucy55IHx8IChzaXplLmggLyAyKSk7XG5cbiAgb2Zmc2V0WCA9IG9wdGlvbnMueCAvIHNpemUudztcbiAgb2Zmc2V0WSA9IG9wdGlvbnMueSAvIHNpemUuaDtcblxuICBsZXQgb3B0cyA9IHtcbiAgICB0YXBPZmZzZXQ6IHtcbiAgICAgIHg6IG9mZnNldFgsXG4gICAgICB5OiBvZmZzZXRZXG4gICAgfSxcbiAgICB0YXBDb3VudDogb3B0aW9ucy5jb3VudCB8fCAxLFxuICAgIHRvdWNoQ291bnQ6IDFcbiAgfTtcbiAgbGV0IGNtZCA9IGAke2NtZEJhc2V9LnRhcFdpdGhPcHRpb25zKCR7SlNPTi5zdHJpbmdpZnkob3B0cyl9KWA7XG4gIHJldHVybiBhd2FpdCB0aGlzLnVpQXV0b0NsaWVudC5zZW5kQ29tbWFuZChjbWQpO1xufTtcblxuaGVscGVycy5pc0RyYWcgPSBmdW5jdGlvbiBpc0RyYWcgKGdlc3R1cmVzKSB7XG4gIHJldHVybiAoXG4gICAgZ2VzdHVyZXMubGVuZ3RoID09PSA0ICYmXG4gICAgZ2VzdHVyZXNbMF0uYWN0aW9uID09PSAncHJlc3MnICYmXG4gICAgZ2VzdHVyZXNbMV0uYWN0aW9uID09PSAnd2FpdCcgJiZcbiAgICBnZXN0dXJlc1syXS5hY3Rpb24gPT09ICdtb3ZlVG8nICYmXG4gICAgZ2VzdHVyZXNbM10uYWN0aW9uID09PSAncmVsZWFzZSdcbiAgKTtcbn07XG5cbmhlbHBlcnMuaXNQaW5jaEFuZFpvb20gPSBmdW5jdGlvbiBpc1BpbmNoQW5kWm9vbSAoZ2VzdHVyZXMpIHtcbiAgcmV0dXJuIChcbiAgICBnZXN0dXJlcy5sZW5ndGggPT09IDMgJiZcbiAgICBnZXN0dXJlc1swXS5hY3Rpb24gPT09ICdwcmVzcycgJiZcbiAgICBnZXN0dXJlc1sxXS5hY3Rpb24gPT09ICdtb3ZlVG8nICYmXG4gICAgZ2VzdHVyZXNbMl0uYWN0aW9uID09PSAncmVsZWFzZSdcbiAgKTtcbn07XG5cbmhlbHBlcnMuZ2V0Q29vcmRpbmF0ZXMgPSBhc3luYyBmdW5jdGlvbiBnZXRDb29yZGluYXRlcyAoZ2VzdHVyZSkge1xuICBsZXQgZWwgPSBnZXN0dXJlLm9wdGlvbnMuZWxlbWVudDtcblxuICAvLyBkZWZhdWx0c1xuICBsZXQgY29vcmRpbmF0ZXMgPSB7eDogMCwgeTogMCwgYXJlT2Zmc2V0czogZmFsc2V9O1xuXG4gIC8vIGZpZ3VyZSBvdXQgdGhlIGVsZW1lbnQgY29vcmRpbmF0ZXMuXG4gIGlmIChlbCkge1xuICAgIGxldCBjb21tYW5kID0gYGF1LmdldEVsZW1lbnQoJyR7ZWx9JykucmVjdCgpYDtcbiAgICBsZXQgcmVjdCA9IGF3YWl0IHRoaXMudWlBdXRvQ2xpZW50LnNlbmRDb21tYW5kKGNvbW1hbmQpO1xuICAgIGxldCBwb3MgPSB7eDogcmVjdC5vcmlnaW4ueCwgeTogcmVjdC5vcmlnaW4ueX07XG4gICAgbGV0IHNpemUgPSB7dzogcmVjdC5zaXplLndpZHRoLCBoOiByZWN0LnNpemUuaGVpZ2h0fTtcblxuICAgIC8vIGRlZmF1bHRzXG4gICAgbGV0IG9mZnNldFggPSAwO1xuICAgIGxldCBvZmZzZXRZID0gMDtcblxuICAgIC8vIGdldCB0aGUgcmVhbCBvZmZzZXRzXG4gICAgaWYgKGdlc3R1cmUub3B0aW9ucy54IHx8IGdlc3R1cmUub3B0aW9ucy55KSB7XG4gICAgICBvZmZzZXRYID0gKGdlc3R1cmUub3B0aW9ucy54IHx8IDApO1xuICAgICAgb2Zmc2V0WSA9IChnZXN0dXJlLm9wdGlvbnMueSB8fCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgb2Zmc2V0WCA9IChzaXplLncgLyAyKTtcbiAgICAgIG9mZnNldFkgPSAoc2l6ZS5oIC8gMik7XG4gICAgfVxuXG4gICAgLy8gYXBwbHkgdGhlIG9mZnNldHNcbiAgICBjb29yZGluYXRlcy54ID0gcG9zLnggKyBvZmZzZXRYO1xuICAgIGNvb3JkaW5hdGVzLnkgPSBwb3MueSArIG9mZnNldFk7XG4gIH0gZWxzZSB7XG4gICAgLy8gbW92ZVRvIGNvb3JkaW5hdGVzIGFyZSBwYXNzZWQgaW4gYXMgb2Zmc2V0c1xuICAgIGNvb3JkaW5hdGVzLmFyZU9mZnNldHMgPSAoZ2VzdHVyZS5hY3Rpb24gPT09ICdtb3ZlVG8nKTtcbiAgICBjb29yZGluYXRlcy54ID0gKGdlc3R1cmUub3B0aW9ucy54IHx8IDApO1xuICAgIGNvb3JkaW5hdGVzLnkgPSAoZ2VzdHVyZS5vcHRpb25zLnkgfHwgMCk7XG4gIH1cbiAgcmV0dXJuIGNvb3JkaW5hdGVzO1xufTtcblxuaGVscGVycy5hcHBseU1vdmVUb09mZnNldCA9IGZ1bmN0aW9uIGFwcGx5TW92ZVRvT2Zmc2V0IChmaXJzdENvb3JkaW5hdGVzLCBzZWNvbmRDb29yZGluYXRlcykge1xuICBpZiAoc2Vjb25kQ29vcmRpbmF0ZXMuYXJlT2Zmc2V0cykge1xuICAgIHJldHVybiB7XG4gICAgICB4OiBmaXJzdENvb3JkaW5hdGVzLnggKyBzZWNvbmRDb29yZGluYXRlcy54LFxuICAgICAgeTogZmlyc3RDb29yZGluYXRlcy55ICsgc2Vjb25kQ29vcmRpbmF0ZXMueSxcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBzZWNvbmRDb29yZGluYXRlcztcbiAgfVxufTtcblxuaGVscGVycy5oYW5kbGVEcmFnID0gYXN5bmMgZnVuY3Rpb24gaGFuZGxlRHJhZyAoZ2VzdHVyZXMpIHtcbiAgLy8gZ2V0IGdlc3R1cmVzXG4gIGxldCBwcmVzcyA9IGdlc3R1cmVzWzBdO1xuICBsZXQgd2FpdCA9IGdlc3R1cmVzWzFdO1xuICBsZXQgbW92ZVRvID0gZ2VzdHVyZXNbMl07XG5cbiAgLy8gZ2V0IGRyYWcgZGF0YVxuICBsZXQgcHJlc3NDb29yZGluYXRlcyA9IGF3YWl0IHRoaXMuZ2V0Q29vcmRpbmF0ZXMocHJlc3MpO1xuICBsZXQgZHVyYXRpb24gPSAocGFyc2VJbnQod2FpdC5vcHRpb25zLm1zLCAxMCkgLyAxMDAwKTtcbiAgbGV0IG1vdmVUb0Nvb3JkaW5hdGVzID0gYXdhaXQgdGhpcy5nZXRDb29yZGluYXRlcyhtb3ZlVG8pO1xuXG4gIC8vIHVwZGF0ZSBtb3ZlVG8gY29vcmRpbmF0ZXMgd2l0aCBvZmZzZXRcbiAgbW92ZVRvQ29vcmRpbmF0ZXMgPSB0aGlzLmFwcGx5TW92ZVRvT2Zmc2V0KHByZXNzQ29vcmRpbmF0ZXMsIG1vdmVUb0Nvb3JkaW5hdGVzKTtcblxuICAvLyBidWlsZCBkcmFnIGNvbW1hbmRcbiAgbGV0IGRyYWdDb21tYW5kID0gKGBhdS5kcmFnQXBwKGAgK1xuICAgIGAke3ByZXNzQ29vcmRpbmF0ZXMueH0sICR7cHJlc3NDb29yZGluYXRlcy55fSwgYCArXG4gICAgYCR7bW92ZVRvQ29vcmRpbmF0ZXMueH0sICR7bW92ZVRvQ29vcmRpbmF0ZXMueX0sIGAgK1xuICAgIGAke2R1cmF0aW9ufSlgKTtcblxuICAvLyBleGVjdXRlIGRyYWcgY29tbWFuZFxuICByZXR1cm4gYXdhaXQgdGhpcy51aUF1dG9DbGllbnQuc2VuZENvbW1hbmQoZHJhZ0NvbW1hbmQpO1xufTtcblxuaGVscGVycy5oYW5kbGVQaW5jaEFuZFpvb20gPSBhc3luYyBmdW5jdGlvbiBoYW5kbGVQaW5jaEFuZFpvb20gKGdlc3R1cmVzKSB7XG4gIC8vIGdldCBnZXN0dXJlc1xuICBsZXQgcHJlc3MgPSBnZXN0dXJlc1swXTtcbiAgbGV0IG1vdmVUbyA9IGdlc3R1cmVzWzFdO1xuXG4gIC8vIGdldCBwaW5jaCBkYXRhXG4gIGxldCBwcmVzc0Nvb3JkaW5hdGVzID0gYXdhaXQgdGhpcy5nZXRDb29yZGluYXRlcyhwcmVzcyk7XG4gIGxldCBtb3ZlVG9Db29yZGluYXRlcyA9IGF3YWl0IHRoaXMuZ2V0Q29vcmRpbmF0ZXMobW92ZVRvKTtcblxuICAvLyB1cGRhdGUgbW92ZVRvIGNvb3JkaW5hdGVzIHdpdGggb2Zmc2V0XG4gIG1vdmVUb0Nvb3JkaW5hdGVzID0gdGhpcy5hcHBseU1vdmVUb09mZnNldChwcmVzc0Nvb3JkaW5hdGVzLCBtb3ZlVG9Db29yZGluYXRlcyk7XG5cbiAgLy8gYnVpbGQgcGluY2ggY29tbWFuZFxuICBsZXQgcGluY2hDb21tYW5kID0gKGBhdS5kcmFnQXBwKGAgK1xuICAgIGAke3ByZXNzQ29vcmRpbmF0ZXMueH0sICR7cHJlc3NDb29yZGluYXRlcy55fSwgYCArXG4gICAgYCR7bW92ZVRvQ29vcmRpbmF0ZXMueH0sICR7bW92ZVRvQ29vcmRpbmF0ZXMueX1gKTtcblxuICByZXR1cm4gYXdhaXQgdGhpcy51aUF1dG9DbGllbnQuc2VuZENvbW1hbmQocGluY2hDb21tYW5kKTtcbn07XG5cbmNvbW1hbmRzLnBlcmZvcm1Ub3VjaCA9IGFzeW5jIGZ1bmN0aW9uIHBlcmZvcm1Ub3VjaCAoZ2VzdHVyZXMpIHtcbiAgaWYgKHRoaXMuaXNXZWJDb250ZXh0KCkpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLk5vdFlldEltcGxlbWVudGVkRXJyb3IoKTtcbiAgfVxuXG4gIGlmIChnZXN0dXJlcy5sZW5ndGggPT09IDEgJiYgZ2VzdHVyZXNbMF0uYWN0aW9uID09PSAndGFwJykge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmhhbmRsZVRhcChnZXN0dXJlc1swXSk7XG4gIH0gZWxzZSBpZiAodGhpcy5pc0RyYWcoZ2VzdHVyZXMpKSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlRHJhZyhnZXN0dXJlcyk7XG4gIH1cbiAgbGV0IHRvdWNoU3RhdGVPYmplY3RzID0gYXdhaXQgdGhpcy5wYXJzZVRvdWNoKGdlc3R1cmVzKTtcbiAgYXdhaXQgdGhpcy51aUF1dG9DbGllbnQuc2VuZENvbW1hbmQoYHRhcmdldC50b3VjaCgke0pTT04uc3RyaW5naWZ5KHRvdWNoU3RhdGVPYmplY3RzKX0pYCk7XG59O1xuXG5jb21tYW5kcy5wYXJzZVRvdWNoID0gYXN5bmMgZnVuY3Rpb24gcGFyc2VUb3VjaCAoZ2VzdHVyZXMpIHtcbiAgLy8gYHJlbGVhc2VgIGlzIGF1dG9tYXRpYyBpbiBpT1NcbiAgaWYgKF8ubGFzdChnZXN0dXJlcykuYWN0aW9uID09PSAncmVsZWFzZScpIHtcbiAgICBnZXN0dXJlcy5wb3AoKTtcbiAgfVxuXG4gIGxldCB0b3VjaFN0YXRlT2JqZWN0cyA9IFtdO1xuICBsZXQgZmluaXNoUGFyc2luZyA9ICgpID0+IHtcbiAgICBsZXQgcHJldlBvcyA9IG51bGw7XG5cbiAgICAvLyB3ZSBuZWVkIHRvIGNoYW5nZSB0aGUgdGltZSAod2hpY2ggaXMgbm93IGFuIG9mZnNldClcbiAgICAvLyBhbmQgdGhlIHBvc2l0aW9uICh3aGljaCBtYXkgYmUgYW4gb2Zmc2V0KVxuICAgIGxldCB0aW1lID0gMDtcbiAgICBmb3IgKGxldCBzdGF0ZSBvZiB0b3VjaFN0YXRlT2JqZWN0cykge1xuICAgICAgaWYgKHN0YXRlLnRvdWNoWzBdID09PSBmYWxzZSkge1xuICAgICAgICAvLyBpZiB3ZSBoYXZlIG5vIHBvc2l0aW9uICh0aGlzIGhhcHBlbnMgd2l0aCBgd2FpdGApIHdlIG5lZWQgdGhlIHByZXZpb3VzIG9uZVxuICAgICAgICBzdGF0ZS50b3VjaFswXSA9IHByZXZQb3M7XG4gICAgICB9IGVsc2UgaWYgKHN0YXRlLnRvdWNoWzBdLm9mZnNldCAmJiBwcmV2UG9zKSB7XG4gICAgICAgIC8vIHRoZSBjdXJyZW50IHBvc2l0aW9uIGlzIGFuIG9mZnNldFxuICAgICAgICBzdGF0ZS50b3VjaFswXS54ICs9IHByZXZQb3MueDtcbiAgICAgICAgc3RhdGUudG91Y2hbMF0ueSArPSBwcmV2UG9zLnk7XG4gICAgICB9XG4gICAgICAvLyBwcmV2ZW50IHdhaXQgPT4gcHJlc3MgPT4gbW92ZXRvIGNyYXNoXG4gICAgICBpZiAoc3RhdGUudG91Y2hbMF0pIHtcbiAgICAgICAgZGVsZXRlIHN0YXRlLnRvdWNoWzBdLm9mZnNldDtcbiAgICAgICAgcHJldlBvcyA9IHN0YXRlLnRvdWNoWzBdO1xuICAgICAgfVxuXG5cbiAgICAgIGxldCB0aW1lT2Zmc2V0ID0gc3RhdGUudGltZU9mZnNldDtcbiAgICAgIHRpbWUgKz0gdGltZU9mZnNldDtcbiAgICAgIHN0YXRlLnRpbWUgPSB0aW1lO1xuXG4gICAgICBkZWxldGUgc3RhdGUudGltZU9mZnNldDtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgbmVlZHNQb2ludCA9IChhY3Rpb24pID0+IF8uaW5jbHVkZXMoWydwcmVzcycsICdtb3ZlVG8nLCAndGFwJywgJ2xvbmdQcmVzcyddLCBhY3Rpb24pO1xuXG4gIGxldCBjeWNsZVRocm91Z2hHZXN0dXJlcyA9IGFzeW5jICgpID0+IHtcbiAgICBsZXQgZ2VzdHVyZSA9IGdlc3R1cmVzLnNoaWZ0KCk7XG4gICAgaWYgKHR5cGVvZiBnZXN0dXJlID09PSAndW5kZWZpbmVkJykge1xuICAgICAgcmV0dXJuIGZpbmlzaFBhcnNpbmcoKTtcbiAgICB9XG4gICAgbGV0IHRhcFBvaW50ID0gZmFsc2U7XG5cbiAgICBpZiAobmVlZHNQb2ludChnZXN0dXJlLmFjdGlvbikpIHsgLy8gcHJlc3MsIGxvbmdQcmVzcywgbW92ZVRvIGFuZCB0YXAgYWxsIG5lZWQgYSBwb3NpdGlvblxuICAgICAgbGV0IGVsID0gZ2VzdHVyZS5vcHRpb25zLmVsZW1lbnQ7XG4gICAgICBpZiAoZWwpIHtcbiAgICAgICAgbGV0IGNvbW1hbmQgPSBgYXUuZ2V0RWxlbWVudCgnJHtlbH0nKS5yZWN0KClgO1xuICAgICAgICBsZXQgcmVjdCA9IGF3YWl0IHRoaXMudWlBdXRvQ2xpZW50LnNlbmRDb21tYW5kKGNvbW1hbmQpO1xuICAgICAgICBsZXQgcG9zID0ge3g6IHJlY3Qub3JpZ2luLngsIHk6IHJlY3Qub3JpZ2luLnl9O1xuICAgICAgICBsZXQgc2l6ZSA9IHt3OiByZWN0LnNpemUud2lkdGgsIGg6IHJlY3Quc2l6ZS5oZWlnaHR9O1xuXG4gICAgICAgIGlmIChnZXN0dXJlLm9wdGlvbnMueCB8fCBnZXN0dXJlLm9wdGlvbnMueSkge1xuICAgICAgICAgIHRhcFBvaW50ID0ge1xuICAgICAgICAgICAgb2Zmc2V0OiBmYWxzZSxcbiAgICAgICAgICAgIHg6IHBvcy54ICsgKGdlc3R1cmUub3B0aW9ucy54IHx8IDApLFxuICAgICAgICAgICAgeTogcG9zLnkgKyAoZ2VzdHVyZS5vcHRpb25zLnkgfHwgMClcbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRhcFBvaW50ID0ge1xuICAgICAgICAgICAgb2Zmc2V0OiBmYWxzZSxcbiAgICAgICAgICAgIHg6IHBvcy54ICsgKHNpemUudyAvIDIpLFxuICAgICAgICAgICAgeTogcG9zLnkgKyAoc2l6ZS5oIC8gMilcbiAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHRvdWNoU3RhdGVPYmplY3QgPSB7XG4gICAgICAgICAgdGltZU9mZnNldDogMC4yLFxuICAgICAgICAgIHRvdWNoOiBbXG4gICAgICAgICAgICB0YXBQb2ludFxuICAgICAgICAgIF1cbiAgICAgICAgfTtcbiAgICAgICAgdG91Y2hTdGF0ZU9iamVjdHMucHVzaCh0b3VjaFN0YXRlT2JqZWN0KTtcbiAgICAgICAgYXdhaXQgY3ljbGVUaHJvdWdoR2VzdHVyZXMoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGlPUyBleHBlY3RzIGFic29sdXRlIGNvb3JkaW5hdGVzLCBzbyB3ZSBuZWVkIHRvIHNhdmUgdGhlc2UgYXMgb2Zmc2V0c1xuICAgICAgICAvLyBhbmQgdGhlbiB0cmFuc2xhdGUgd2hlbiBldmVyeXRoaW5nIGlzIGRvbmVcbiAgICAgICAgdGFwUG9pbnQgPSB7XG4gICAgICAgICAgb2Zmc2V0OiB0cnVlLFxuICAgICAgICAgIHg6IChnZXN0dXJlLm9wdGlvbnMueCB8fCAwKSxcbiAgICAgICAgICB5OiAoZ2VzdHVyZS5vcHRpb25zLnkgfHwgMClcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IHRvdWNoU3RhdGVPYmplY3QgPSB7XG4gICAgICAgICAgdGltZU9mZnNldDogMC4yLFxuICAgICAgICAgIHRvdWNoOiBbXG4gICAgICAgICAgICB0YXBQb2ludFxuICAgICAgICAgIF1cbiAgICAgICAgfTtcbiAgICAgICAgdG91Y2hTdGF0ZU9iamVjdHMucHVzaCh0b3VjaFN0YXRlT2JqZWN0KTtcbiAgICAgICAgYXdhaXQgY3ljbGVUaHJvdWdoR2VzdHVyZXMoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gaW4gdGhpcyBjYXNlIHdlIG5lZWQgdGhlIHByZXZpb3VzIGVudHJ5J3MgdGFwIHBvaW50XG4gICAgICB0YXBQb2ludCA9IGZhbHNlOyAvLyB0ZW1wb3JhcnkgbWFya2VyXG4gICAgICBsZXQgb2Zmc2V0ID0gMC4yO1xuICAgICAgaWYgKGdlc3R1cmUuYWN0aW9uID09PSAnd2FpdCcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBnZXN0dXJlLm9wdGlvbnMubXMgIT09ICd1bmRlZmluZWQnIHx8IGdlc3R1cmUub3B0aW9ucy5tcyAhPT0gbnVsbCkge1xuICAgICAgICAgIG9mZnNldCA9IChwYXJzZUludChnZXN0dXJlLm9wdGlvbnMubXMsIDEwKSAvIDEwMDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsZXQgdG91Y2hTdGF0ZU9iamVjdCA9IHtcbiAgICAgICAgdGltZU9mZnNldDogb2Zmc2V0LFxuICAgICAgICB0b3VjaDogW1xuICAgICAgICAgIHRhcFBvaW50XG4gICAgICAgIF1cbiAgICAgIH07XG4gICAgICB0b3VjaFN0YXRlT2JqZWN0cy5wdXNoKHRvdWNoU3RhdGVPYmplY3QpO1xuICAgICAgYXdhaXQgY3ljbGVUaHJvdWdoR2VzdHVyZXMoKTtcbiAgICB9XG4gIH07XG5cbiAgYXdhaXQgY3ljbGVUaHJvdWdoR2VzdHVyZXMoKTtcbiAgcmV0dXJuIHRvdWNoU3RhdGVPYmplY3RzO1xufTtcblxuY29uc3QgbWVyZ2VTdGF0ZXMgPSBmdW5jdGlvbiBtZXJnZVN0YXRlcyAoc3RhdGVzKSB7XG4gIGxldCBnZXRTbGljZSA9IGZ1bmN0aW9uIChzdGF0ZXMsIGluZGV4KSB7XG4gICAgbGV0IGFycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGFycmF5LnB1c2goc3RhdGVzW2ldW2luZGV4XSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFycmF5O1xuICB9O1xuXG4gIGNvbnN0IHRpbWVTZXF1ZW5jZSA9IGZ1bmN0aW9uIHRpbWVTZXF1ZW5jZSAoc3RhdGVzKSB7XG4gICAgbGV0IHNlcSA9IFtdO1xuICAgIF8uZWFjaChzdGF0ZXMsIGZ1bmN0aW9uIGVhY2hTdGF0ZSAoc3RhdGUpIHtcbiAgICAgIGxldCB0aW1lcyA9IF8ubWFwKHN0YXRlLCAndGltZScpO1xuICAgICAgc2VxID0gXy51bmlvbihzZXEsIHRpbWVzKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzZXEuc29ydCgpO1xuICB9O1xuXG4gIC8vIGZvciBub3cgd2Ugd2lsbCBqdXN0IGFzc3VtZSB0aGF0IHRoZSB0aW1lcyBsaW5lIHVwXG4gIGxldCBtZXJnZWQgPSBbXTtcbiAgXy5lYWNoKHRpbWVTZXF1ZW5jZShzdGF0ZXMpLCBmdW5jdGlvbiBlYWNoU2VxdWVuY2UgKHRpbWUsIGluZGV4KSB7XG4gICAgbGV0IHNsaWNlID0gZ2V0U2xpY2Uoc3RhdGVzLCBpbmRleCk7XG4gICAgbGV0IG9iaiA9IHtcbiAgICAgIHRpbWUsXG4gICAgICB0b3VjaDogW11cbiAgICB9O1xuICAgIF8uZWFjaChzbGljZSwgZnVuY3Rpb24gZWFjaFNsaWNlIChhY3Rpb24pIHtcbiAgICAgIG9iai50b3VjaC5wdXNoKGFjdGlvbi50b3VjaFswXSk7XG4gICAgfSk7XG4gICAgbWVyZ2VkLnB1c2gob2JqKTtcbiAgfSk7XG4gIHJldHVybiBtZXJnZWQ7XG59O1xuXG5jb21tYW5kcy5wZXJmb3JtTXVsdGlBY3Rpb24gPSBhc3luYyBmdW5jdGlvbiBwZXJmb3JtTXVsdGlBY3Rpb24gKGFjdGlvbnMsIC8qZWwqLykge1xuICBpZiAodGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm90WWV0SW1wbGVtZW50ZWRFcnJvcigpO1xuICB9XG5cbiAgLy8gZWwgPSB1bndyYXBFbChlbCk7XG4gIC8vIFRPRE86IHdoeSBlbGVtZW50SWQgaXMgbm90IHVzZWRcbiAgbGV0IHN0YXRlcyA9IFtdO1xuICBsZXQgY3ljbGVUaHJvdWdoQWN0aW9ucyA9IGFzeW5jICgpID0+IHtcbiAgICBsZXQgYWN0aW9uID0gYWN0aW9ucy5zaGlmdCgpO1xuXG4gICAgaWYgKHR5cGVvZiBhY3Rpb24gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBsZXQgbWVyZ2VkU3RhdGVzID0gbWVyZ2VTdGF0ZXMoc3RhdGVzKTtcbiAgICAgIGlmICh0aGlzLmlzUGluY2hBbmRab29tKG1lcmdlZFN0YXRlcykpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVQaW5jaEFuZFpvb20obWVyZ2VkU3RhdGVzKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgdGhpcy51aUF1dG9DbGllbnQuc2VuZENvbW1hbmQgKGB0YXJnZXQudG91Y2goJHtKU09OLnN0cmluZ2lmeShtZXJnZWRTdGF0ZXMpfSlgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIGxldCB2YWwgPSBhd2FpdCB0aGlzLnBhcnNlVG91Y2goYWN0aW9uKTtcbiAgICBzdGF0ZXMucHVzaCh2YWwpO1xuICAgIGF3YWl0IGN5Y2xlVGhyb3VnaEFjdGlvbnMoKTtcbiAgfTtcbiAgYXdhaXQgY3ljbGVUaHJvdWdoQWN0aW9ucygpO1xufTtcblxuaGVscGVycy5tb2JpbGVTY3JvbGwgPSBhc3luYyBmdW5jdGlvbiBtb2JpbGVTY3JvbGwgKG9wdHMgPSB7fSkge1xuICBsZXQgZGlyZWN0aW9uID0gb3B0cy5kaXJlY3Rpb247XG4gIGxldCBlbCA9IG9wdHMuZWxlbWVudDtcbiAgZWwgPSB1bndyYXBFbChlbCk7XG4gIGlmICh0aGlzLmlzV2ViQ29udGV4dCgpKSB7XG4gICAgLy8gbm90IGltcGxlbWVudGVkIHlldCBpbiB3ZWJcbiAgICB0aHJvdyBuZXcgZXJyb3JzLk5vdFlldEltcGxlbWVudGVkRXJyb3IoKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAodXRpbC5oYXNWYWx1ZShlbCkgJiYgIXV0aWwuaGFzVmFsdWUoZGlyZWN0aW9uKSkge1xuICAgICAgYXdhaXQgdGhpcy5zY3JvbGxUb0VsZW1lbnQoZWwpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkaXJlY3Rpb24gPSBfLmNhcGl0YWxpemUoZGlyZWN0aW9uKTtcbiAgICBsZXQgY29tbWFuZDtcbiAgICBpZiAoXy5pc051bGwoZWwpIHx8IF8uaXNVbmRlZmluZWQoZWwpKSB7XG4gICAgICAvLyBCeSBkZWZhdWx0LCBzY3JvbGwgdGhlIGZpcnN0IHNjcm9sbHZpZXcuXG4gICAgICBjb21tYW5kID0gYGF1LnNjcm9sbEZpcnN0VmlldygnJHtkaXJlY3Rpb259JylgO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBpZiBlbGVtZW50IGlzIGRlZmluZWQsIGNhbGwgc2Nyb2xsTGVmdCwgc2Nyb2xsUmlnaHQsIHNjcm9sbFVwLCBhbmQgc2Nyb2xsRG93biBvbiB0aGUgZWxlbWVudC5cbiAgICAgIGNvbW1hbmQgPSBgYXUuZ2V0RWxlbWVudCgnJHtlbH0nKS5zY3JvbGwke2RpcmVjdGlvbn0oKWA7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnVpQXV0b0NsaWVudC5zZW5kQ29tbWFuZChjb21tYW5kKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGlmICghXy5pbmNsdWRlcyhlcnIubWVzc2FnZSwgJ2tBWEVycm9yRmFpbHVyZScpKSB0aHJvdyBlcnI7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY3VybHlcblxuICAgICAgbG9nZ2VyLndhcm4oJ1JlY2VpdmVkIGtBWEVycm9yRmFpbHVyZSwgZ2VuZXJhbGx5IGluZGljYXRpbmcgYW4gYXR0ZW1wdCAnICtcbiAgICAgICAgICAgICAgICAgICd0byBzY3JvbGwgcGFzdCB0aGUgZW5kIG9mIHRoZSB2aWV3LiBDb250aW51aW5nLicpO1xuICAgIH1cbiAgfVxufTtcblxuY29tbWFuZHMuc2Nyb2xsVG9FbGVtZW50ID0gYXN5bmMgZnVuY3Rpb24gc2Nyb2xsVG9FbGVtZW50IChlbGVtZW50KSB7XG4gIGVsZW1lbnQgPSB1bndyYXBFbChlbGVtZW50KTtcbiAgY29uc3QgY29tbWFuZCA9IGBhdS5nZXRFbGVtZW50KCcke2VsZW1lbnR9Jykuc2Nyb2xsVG9WaXNpYmxlKClgO1xuICBhd2FpdCB0aGlzLnVpQXV0b0NsaWVudC5zZW5kQ29tbWFuZChjb21tYW5kKTtcbn07XG5cbmNvbW1hbmRzLmZsaWNrID0gYXN5bmMgZnVuY3Rpb24gZmxpY2sgKGVsLCB4c3BlZWQsIHlzcGVlZCwgeG9mZnNldCwgeW9mZnNldCwgc3BlZWQpIHtcbiAgZWwgPSB1bndyYXBFbChlbCk7XG4gIGlmIChfLmV2ZXJ5KFtlbCwgeG9mZnNldCwgeW9mZnNldCwgc3BlZWRdLCAocCkgPT4gIV8uaXNOdWxsKHApICYmICFfLmlzVW5kZWZpbmVkKHApKSkge1xuICAgIGF3YWl0IHRoaXMuZmxpY2tFbGVtZW50KGVsLCB4b2Zmc2V0LCB5b2Zmc2V0LCBzcGVlZCk7XG4gIH0gZWxzZSBpZiAoXy5ldmVyeShbeHNwZWVkLCB5c3BlZWRdLCAocCkgPT4gIV8uaXNOdWxsKHApICYmICFfLmlzVW5kZWZpbmVkKHApKSkge1xuICAgIGF3YWl0IHRoaXMueHlTcGVlZEZsaWNrKHhzcGVlZCwgeXNwZWVkKTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlVua25vd25FcnJvcihcbiAgICAgICdCYWQgZmxpY2sgcGFyYW1ldGVycywgcGFzcyBlaXRoZXIgKHhzcGVlZCwgeXNwZWVkKSBvciAoZWxlbWVudCwgeG9mZnNldCwgeW9mZnNldCwgc3BlZWQpIScpO1xuICB9XG59O1xuXG5oZWxwZXJzLnh5U3BlZWRGbGljayA9IGFzeW5jIGZ1bmN0aW9uIHh5U3BlZWRGbGljayAoeFNwZWVkLCB5U3BlZWQpIHtcbiAgbGV0IGNvbW1hbmQgPSBgYXUudG91Y2hGbGlja0Zyb21TcGVlZCgke3hTcGVlZH0sJHt5U3BlZWR9KWA7XG4gIGF3YWl0IEIuYWxsKFtcbiAgICB0aGlzLnVpQXV0b0NsaWVudC5zZW5kQ29tbWFuZChjb21tYW5kKSxcbiAgICBCLmRlbGF5KEZMSUNLX01TKVxuICBdKTtcbn07XG5cbmhlbHBlcnMuZmxpY2tFbGVtZW50ID0gYXN5bmMgZnVuY3Rpb24gZmxpY2tFbGVtZW50IChlbCwgeG9mZnNldCwgeW9mZnNldCwgc3BlZWQpIHtcbiAgZWwgPSB1bndyYXBFbChlbCk7XG4gIGxldCBjb21tYW5kID0gJyc7XG4gIGlmICh0aGlzLmlzV2ViQ29udGV4dCgpKSB7XG4gICAgLy8gc3BlZWQgaXMgbm90IHVzZWQgYmVjYXVzZSB1bmRlcmx5aW5nIFVJQVRhcmdldC5mbGlja0Zyb21UbyBkb2Vzbid0IHN1cHBvcnQgaXRcbiAgICBhd2FpdCB0aGlzLndlYkZsaWNrRWxlbWVudChlbCwgeG9mZnNldCwgeW9mZnNldCk7XG4gIH0gZWxzZSB7XG4gICAgY29tbWFuZCA9IGBhdS5nZXRFbGVtZW50KCcke2VsfScpLnRvdWNoRmxpY2soJHt4b2Zmc2V0fSwke3lvZmZzZXR9LCR7c3BlZWR9KWA7XG4gICAgYXdhaXQgQi5hbGwoW1xuICAgICAgdGhpcy51aUF1dG9DbGllbnQuc2VuZENvbW1hbmQoY29tbWFuZCksXG4gICAgICBCLmRlbGF5KEZMSUNLX01TKVxuICAgIF0pO1xuICB9XG59O1xuXG4vLyBUT0RPOiBtYXliZSByZW5hbWUgdGhpcyBpbiBtanNvbndwXG5jb21tYW5kcy5tb2JpbGVTaGFrZSA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZVNoYWtlICgpIHtcbiAgYXdhaXQgdGhpcy51aUF1dG9DbGllbnQuc2VuZENvbW1hbmQoJ2F1LnNoYWtlKCknKTtcbn07XG5cbmNvbW1hbmRzLm1vdmVUbyA9IGFzeW5jIGZ1bmN0aW9uIG1vdmVUbyAoZWwsIHhvZmZzZXQgPSAwLCB5b2Zmc2V0ID0gMCkge1xuICBlbCA9IHVud3JhcEVsKGVsKTtcblxuICBpZiAodGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgIGxldCB7eCwgeX0gPSBhd2FpdCB0aGlzLmdldExvY2F0aW9uKGVsKTtcbiAgICBsZXQgY29vcmRzID0ge1xuICAgICAgeDogeCArIHhvZmZzZXQsXG4gICAgICB5OiB5ICsgeW9mZnNldFxuICAgIH07XG4gICAgdGhpcy5jdXJXZWJDb29yZHMgPSBjb29yZHM7XG4gICAgbGV0IGF0b21zRWxlbWVudCA9IHRoaXMudXNlQXRvbXNFbGVtZW50KGVsKTtcbiAgICBsZXQgcmVsQ29vcmRzID0ge3g6IHhvZmZzZXQsIHk6IHlvZmZzZXR9O1xuICAgIGF3YWl0IHRoaXMuZXhlY3V0ZUF0b20oJ21vdmVfbW91c2UnLCBbYXRvbXNFbGVtZW50LCByZWxDb29yZHNdKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoXy5pc051bGwoZWwpIHx8IF8uaXNVbmRlZmluZWQoZWwpKSB7XG4gICAgICBpZiAoIXRoaXMuY3VyQ29vcmRzKSB7XG4gICAgICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkV4Y2VwdGlvbihcbiAgICAgICAgICAnQ3VycmVudCBjdXJzb3IgcG9zaXRpb24gdW5rbm93biwgcGxlYXNlIHVzZSBtb3ZlVG8gd2l0aCBhbiBlbGVtZW50IHRoZSBmaXJzdCB0aW1lLicpO1xuICAgICAgfVxuICAgICAgdGhpcy5jdXJDb29yZHMgPSB7XG4gICAgICAgIHg6IHRoaXMuY3VyQ29vcmRzLnggKyB4b2Zmc2V0LFxuICAgICAgICB5OiB0aGlzLmN1ckNvb3Jkcy55ICsgeW9mZnNldFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGVsUG9zID0gYXdhaXQgdGhpcy5nZXRMb2NhdGlvbihlbCk7XG4gICAgICB0aGlzLmN1ckNvb3JkcyA9IHtcbiAgICAgICAgeDogZWxQb3MueCArIHhvZmZzZXQsXG4gICAgICAgIHk6IGVsUG9zLnkgKyB5b2Zmc2V0XG4gICAgICB9O1xuICAgIH1cbiAgfVxufTtcblxuT2JqZWN0LmFzc2lnbihleHRlbnNpb25zLCBjb21tYW5kcywgaGVscGVycyk7XG5leHBvcnQgeyBjb21tYW5kcywgaGVscGVycyB9O1xuZXhwb3J0IGRlZmF1bHQgZXh0ZW5zaW9ucztcbiJdLCJmaWxlIjoibGliL2NvbW1hbmRzL2dlc3R1cmUuanMiLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
