"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SYSLOG_SERVICE_NAME = exports.SyslogService = void 0;

require("source-map-support/register");

var _syslogDecoder = _interopRequireDefault(require("./transformer/syslog-decoder"));

var _constants = require("../constants");

const SYSLOG_SERVICE_NAME = 'com.apple.syslog_relay';
exports.SYSLOG_SERVICE_NAME = SYSLOG_SERVICE_NAME;
const START_MESSAGE = 'start';

class SyslogService {
  constructor(socketClient) {
    this._socketClient = socketClient;
    this._decoder = new _syslogDecoder.default(5 * _constants.KB);

    this._socketClient.pipe(this._decoder);
  }

  start(callback) {
    this._decoder.on('data', callback);

    this._socketClient.write(START_MESSAGE);
  }

  close() {
    this._socketClient.destroy();
  }

}

exports.SyslogService = SyslogService;
var _default = SyslogService;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zeXNsb2cvaW5kZXguanMiXSwibmFtZXMiOlsiU1lTTE9HX1NFUlZJQ0VfTkFNRSIsIlNUQVJUX01FU1NBR0UiLCJTeXNsb2dTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJzb2NrZXRDbGllbnQiLCJfc29ja2V0Q2xpZW50IiwiX2RlY29kZXIiLCJTeXNsb2dEZWNvZGVyIiwiS0IiLCJwaXBlIiwic3RhcnQiLCJjYWxsYmFjayIsIm9uIiwid3JpdGUiLCJjbG9zZSIsImRlc3Ryb3kiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQ0E7O0FBQ0E7O0FBR0EsTUFBTUEsbUJBQW1CLEdBQUcsd0JBQTVCOztBQUNBLE1BQU1DLGFBQWEsR0FBRyxPQUF0Qjs7QUFFQSxNQUFNQyxhQUFOLENBQW9CO0FBRWxCQyxFQUFBQSxXQUFXLENBQUVDLFlBQUYsRUFBZ0I7QUFDekIsU0FBS0MsYUFBTCxHQUFxQkQsWUFBckI7QUFDQSxTQUFLRSxRQUFMLEdBQWdCLElBQUlDLHNCQUFKLENBQWtCLElBQUlDLGFBQXRCLENBQWhCOztBQUNBLFNBQUtILGFBQUwsQ0FBbUJJLElBQW5CLENBQXdCLEtBQUtILFFBQTdCO0FBRUQ7O0FBV0RJLEVBQUFBLEtBQUssQ0FBRUMsUUFBRixFQUFZO0FBQ2YsU0FBS0wsUUFBTCxDQUFjTSxFQUFkLENBQWlCLE1BQWpCLEVBQXlCRCxRQUF6Qjs7QUFDQSxTQUFLTixhQUFMLENBQW1CUSxLQUFuQixDQUF5QlosYUFBekI7QUFDRDs7QUFLRGEsRUFBQUEsS0FBSyxHQUFJO0FBQ1AsU0FBS1QsYUFBTCxDQUFtQlUsT0FBbkI7QUFDRDs7QUE1QmlCOzs7ZUFpQ0xiLGEiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBwcm9taXNlL3ByZWZlci1hd2FpdC10by1jYWxsYmFja3MgKi9cbmltcG9ydCBTeXNsb2dEZWNvZGVyIGZyb20gJy4vdHJhbnNmb3JtZXIvc3lzbG9nLWRlY29kZXInO1xuaW1wb3J0IHsgS0IgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuXG4vL1dlIGp1c3QgbmVlZCB0byB3cml0ZSBhbnkgZGF0YSB0byB0aGUgY2xpZW50LiBJdCBkb2Vzbid0IG1hdHRlciB3aGF0IHdlIHNlbmRcbmNvbnN0IFNZU0xPR19TRVJWSUNFX05BTUUgPSAnY29tLmFwcGxlLnN5c2xvZ19yZWxheSc7XG5jb25zdCBTVEFSVF9NRVNTQUdFID0gJ3N0YXJ0JztcblxuY2xhc3MgU3lzbG9nU2VydmljZSB7XG5cbiAgY29uc3RydWN0b3IgKHNvY2tldENsaWVudCkge1xuICAgIHRoaXMuX3NvY2tldENsaWVudCA9IHNvY2tldENsaWVudDtcbiAgICB0aGlzLl9kZWNvZGVyID0gbmV3IFN5c2xvZ0RlY29kZXIoNSAqIEtCKTtcbiAgICB0aGlzLl9zb2NrZXRDbGllbnQucGlwZSh0aGlzLl9kZWNvZGVyKTtcblxuICB9XG4gIC8qKiBUaGUgY2FsbGJhY2sgZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSBjYWxsZWQgZHVyaW5nIGxvZyBsaXN0ZW5pbmdcbiAgICogQG5hbWUgTG9nQ2FsbGJhY2tcbiAgICogQGZ1bmN0aW9uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBsb2cgVGhlIGxvZyB0aGF0IGlzIHNlbnQgZnJvbSB0aGUgcGhvbmVcbiAgKi9cblxuICAvKipcbiAgICogU3RhcnQgcmVjaWV2aW5nIGxvZ3MgZnJvbSB0aGUgcGhvbmUuIFRoZSBjYWxsYmFjayB3aGVuIGEgbG9nIGlzIHJlY2lldmVkXG4gICAqIEBwYXJhbSB7TG9nQ2FsbGJhY2t9IGNhbGxiYWNrXG4gICAqL1xuICBzdGFydCAoY2FsbGJhY2spIHtcbiAgICB0aGlzLl9kZWNvZGVyLm9uKCdkYXRhJywgY2FsbGJhY2spO1xuICAgIHRoaXMuX3NvY2tldENsaWVudC53cml0ZShTVEFSVF9NRVNTQUdFKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9zZXMgdGhlIHVuZGVybHlpbmcgc29ja2V0IGNvbW11bmljYXRpbmcgd2l0aCB0aGUgcGhvbmVcbiAgICovXG4gIGNsb3NlICgpIHtcbiAgICB0aGlzLl9zb2NrZXRDbGllbnQuZGVzdHJveSgpO1xuICB9XG5cbn1cblxuZXhwb3J0IHsgU3lzbG9nU2VydmljZSwgU1lTTE9HX1NFUlZJQ0VfTkFNRSB9O1xuZXhwb3J0IGRlZmF1bHQgU3lzbG9nU2VydmljZTsiXSwiZmlsZSI6ImxpYi9zeXNsb2cvaW5kZXguanMiLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
